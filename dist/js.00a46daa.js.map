{"version":3,"sources":["js/html5-qrcode/qrcode.js","js/html5-qrcode/html5-qrcode.js","js/html5-qrcode/html5-qrcode-scanner.js","js/install.js","js/index.js","../node_modules/parcel-bundler/src/builtins/bundle-url.js","../node_modules/parcel-bundler/src/builtins/css-loader.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["getLazarSoftScanner","GridSampler","checkAndNudgePoints","image","points","width","qrcode","height","nudged","offset","length","x","Math","floor","y","sampleGrid3","dimension","transform","bits","BitMatrix","Array","max","iValue","transformPoints1","bit","set_Renamed","aioobe","sampleGridx","p1ToX","p1ToY","p2ToX","p2ToY","p3ToX","p3ToY","p4ToX","p4ToY","p1FromX","p1FromY","p2FromX","p2FromY","p3FromX","p3FromY","p4FromX","p4FromY","PerspectiveTransform","quadrilateralToQuadrilateral","ECB","count","dataCodewords","__defineGetter__","ECBlocks","ecCodewordsPerBlock","ecBlocks1","ecBlocks2","ecBlocks","NumBlocks","total","i","getECBlocks","Version","versionNumber","alignmentPatternCenters","ecBlocks3","ecBlocks4","ecCodewords","ECCodewordsPerBlock","ecbArray","ecBlock","Count","DataCodewords","totalCodewords","buildFunctionPattern","DimensionForVersion","bitMatrix","setRegion","getECBlocksForLevel","ecLevel","ordinal","VERSION_DECODE_INFO","VERSIONS","buildVersions","getVersionForNumber","getProvisionalVersionForDimension","iae","decodeVersionInformation","versionBits","bestDifference","bestVersion","targetVersion","bitsDifference","FormatInformation","numBitsDiffering","a11","a21","a31","a12","a22","a32","a13","a23","a33","denominator","transformPoints2","xValues","yValues","n","buildAdjoint","times","other","x0","y0","x1","y1","x2","y2","x3","y3","x0p","y0p","x1p","y1p","x2p","y2p","x3p","y3p","qToS","quadrilateralToSquare","sToQ","squareToQuadrilateral","dy2","dy3","dx1","dx2","dx3","dy1","DetectorResult","Detector","resultPointCallback","sizeOfBlackWhiteBlackRun","fromX","fromY","toX","toY","steep","abs","temp","dx","dy","error","ystep","xstep","state","realX","realY","diffX","diffY","sqrt","diffX2","diffY2","sizeOfBlackWhiteBlackRunBothWays","result","scale","otherToX","otherToY","calculateModuleSizeOneWay","pattern","otherPattern","moduleSizeEst1","X","Y","moduleSizeEst2","isNaN","calculateModuleSize","topLeft","topRight","bottomLeft","distance","pattern1","pattern2","xDiff","yDiff","computeDimension","moduleSize","tltrCentersDimension","round","tlblCentersDimension","findAlignmentInRegion","overallEstModuleSize","estAlignmentX","estAlignmentY","allowanceFactor","allowance","alignmentAreaLeftX","alignmentAreaRightX","min","alignmentAreaTopY","alignmentAreaBottomY","alignmentFinder","AlignmentPatternFinder","find","createTransform","alignmentPattern","dimMinusThree","bottomRightX","bottomRightY","sourceBottomRightX","sourceBottomRightY","sampleGrid","sampler","processFinderPatternInfo","info","TopLeft","TopRight","BottomLeft","provisionalVersion","modulesBetweenFPCenters","AlignmentPatternCenters","correctionToTopLeft","detect","FinderPatternFinder","findFinderPattern","FORMAT_INFO_MASK_QR","FORMAT_INFO_DECODE_LOOKUP","BITS_SET_IN_HALF_BYTE","formatInfo","errorCorrectionLevel","ErrorCorrectionLevel","forBits","dataMask","GetHashCode","Equals","o","a","b","URShift","decodeFormatInformation","maskedFormatInfo","doDecodeFormatInformation","bestFormatInfo","decodeInfo","targetInfo","name","ordinal_Renamed_Field","FOR_BITS","L","M","Q","H","rowSize","get_Renamed","flip","clear","left","top","right","bottom","DataBlock","numDataCodewords","codewords","getDataBlocks","rawCodewords","version","TotalCodewords","totalBlocks","ecBlockArray","numResultBlocks","j","numBlockCodewords","shorterBlocksTotalCodewords","longerBlocksStartAt","numCodewords","shorterBlocksNumDataCodewords","rawCodewordsOffset","iOffset","BitMatrixParser","Dimension","parsedVersion","parsedFormatInfo","copyBit","readFormatInformation","formatInfoBits","iMin","readVersion","ijMin","readCodewords","DataMask","forReference","unmaskBitMatrix","functionPattern","readingUp","resultOffset","currentByte","bitsRead","col","reference","DATA_MASKS","DataMask000","isMasked","DataMask001","DataMask010","DataMask011","DataMask100","DataMask101","DataMask110","DataMask111","ReedSolomonDecoder","field","decode","received","twoS","poly","GF256Poly","syndromeCoefficients","dataMatrix","noError","evalu","evaluateAt","exp","syndrome","sigmaOmega","runEuclideanAlgorithm","buildMonomial","sigma","omega","errorLocations","findErrorLocations","errorMagnitudes","findErrorMagnitudes","position","log","GF256","addOrSubtract","R","Degree","rLast","r","sLast","One","s","Zero","tLast","t","rLastLast","sLastLast","tLastLast","q","denominatorLeadingTerm","getCoefficient","dltInverse","inverse","degreeDiff","multiply","multiplyByMonomial","multiply1","sigmaTildeAtZero","multiply2","errorLocator","numErrors","e","errorEvaluator","xiInverse","coefficients","coefficientsLength","firstNonZero","ci","degree","size","result2","smallerCoefficients","largerCoefficients","sumDiff","lengthDiff","aCoefficients","aLength","bCoefficients","bLength","product","aCoeff","scalar","coefficient","divide","quotient","remainder","inverseDenominatorLeadingTerm","degreeDifference","term","iterationQuotient","primitive","expTable","logTable","at0","zero","at1","one","QR_CODE_FIELD","DATA_MATRIX_FIELD","Decoder","rsDecoder","correctErrors","codewordBytes","codewordsInts","numECCodewords","rse","parser","dataBlocks","totalBytes","NumDataCodewords","resultBytes","dataBlock","Codewords","reader","QRCodeDataBlockReader","VersionNumber","Bits","imagedata","qrCodeSymbol","debug","maxImgSize","sizeOfDataLengthInfo","callback","vidSuccess","stream","localstream","webkit","video","src","window","webkitURL","createObjectURL","moz","mozSrcObject","play","gUM","canvas_qr2","document","createElement","id","qrcontext2","getContext","videoWidth","videoHeight","setTimeout","captureToCanvas","vidError","drawImage","console","setWebcam","videoId","navigator","getElementById","options","mediaDevices","enumerateDevices","then","devices","forEach","device","kind","label","toLowerCase","search","deviceId","getUserMedia","audio","webkitGetUserMedia","mozGetUserMedia","arguments","canvas_qr","context","getImageData","process","Image","crossOrigin","onload","canvas_out","outctx","clearRect","nheight","nwidth","ir","onerror","isUrl","regexp","test","decode_url","escaped","escape","ret","decodeURIComponent","decode_utf8","ctx","start","Date","getTime","grayScaleToBitmap","grayscale","point","data","putImageData","detector","qRCodeMatrix","Height","Width","DataByte","str","String","fromCharCode","end","time","getPixel","p","binarize","th","gray","getMiddleBrightnessPerArea","numSqrtArea","areaWidth","areaHeight","minmax","i2","ay","ax","target","middle","i3","grayScale","sqrtNumArea","buff","ArrayBuffer","bitmap","Uint8Array","number","MIN_SKIP","MAX_MODULES","INTEGER_MATH_SHIFT","CENTER_QUORUM","orderBestPatterns","patterns","crossProductZ","pointA","pointB","pointC","bX","bY","zeroOneDistance","oneTwoDistance","zeroTwoDistance","FinderPattern","posX","posY","estimatedModuleSize","incrementCount","aboutEquals","moduleSizeDiff","FinderPatternInfo","patternCenters","possibleCenters","hasSkipped","crossCheckStateCount","foundPatternCross","stateCount","totalModuleSize","maxVariance","centerFromEnd","crossCheckVertical","startI","centerJ","maxCount","originalStateCountTotal","maxI","CrossCheckStateCount","NaN","stateCountTotal","crossCheckHorizontal","startJ","centerI","maxJ","handlePossibleCenter","found","index","center","push","foundPossibleResultPoint","selectBestPatterns","startSize","square","centerValue","EstimatedModuleSize","average","sort","center1","center2","dA","dB","stdDev","limit","splice","findRowSkip","firstConfirmedCenter","haveMultiplyConfirmedCenters","confirmedCount","totalDeviation","tryHarder","iSkip","done","currentState","confirmed","rowSkip","patternInfo","AlignmentPattern","startX","startY","middleI","iGen","blocks","numErrorCorrectionCode","blockPointer","bitPointer","dataLength","dataLengthMode","getNextBits","numBits","mask","mask1","mask3","bitsFirstBlock","bitsSecondBlock","bitsThirdBlock","NextMode","getDataLength","modeIndicator","getRomanAndFigureString","intData","strData","tableRomanAndFigure","firstLetter","secondLetter","getFigureString","get8bitByteArray","output","getKanjiString","unicodeString","lowerByte","higherByte","tempWord","shiftjisWord","parseECIValue","firstByte","secondByte","secondThirdBytes","MODE_NUMBER","MODE_ROMAN_AND_NUMBER","MODE_8BIT_BYTE","MODE_ECI","MODE_KANJI","mode","temp_sbyteArray3","temp_str","ta","charCodeAt","Html5Qrcode","elementId","verbose","_elementId","_foreverScanTimeout","_localMediaStream","_shouldScan","_url","URL","mozURL","msURL","_userMedia","msGetUserMedia","_isScanning","VERBOSE","cameraIdOrConfig","configuration","qrCodeSuccessCallback","qrCodeErrorCallback","_clearElement","$this","config","fps","SCAN_DEFAULT_FPS","isShadedBoxEnabled","qrbox","undefined","element","clientWidth","DEFAULT_WIDTH","style","_element","qrboxSize","MIN_QR_BOX_SIZE","setupUi","warn","shouldShadingBeApplied","defaultQrRegion","qrRegion","_getShadedRegionBounds","canvasElement","_createCanvasElement","canvas","append","_possiblyInsertShadingElement","_qrRegion","_context","_canvasElement","scanContext","_possiblyUpdateShaders","exception","foreverScan","videoElement","_videoElement","widthRatio","heightRatio","clientHeight","sWidthOffset","sHeightOffset","sxOffset","syOffset","disableFlip","translate","_getTimeoutFps","onMediaStreamReceived","mediaStream","Promise","resolve","reject","setupVideo","_createVideoElement","onabort","onplaying","srcObject","aspectRatio","constraints","track","getVideoTracks","applyConstraints","_","catch","videoConstraints","_createVideoConstraints","err","getCameraConfig","optional","sourceId","clearTimeout","tracksToClose","tracksClosed","removeQrRegion","getElementsByClassName","SHADED_REGION_CLASSNAME","shadedChild","removeChild","onAllTracksClosed","videoTrack","stop","imageFile","showImage","File","computeCanvasDrawConfig","imageWidth","imageHeight","containerWidth","containerHeight","xoffset","yoffset","formerImageWidth","formerImageHeight","_log","_possiblyCloseLastScanImageFile","_lastScanImageFile","inputImage","FILE_SCAN_MIN_HEIGHT","visibleCanvas","display","appendChild","hiddenCanvas","onstalled","onsuspend","innerHTML","customId","canvasWidth","canvasHeight","muted","playsInline","shaders","SHADED_LEFT","_createShadedElement","SHADED_RIGHT","SHADED_TOP","SHADED_BOTTOM","Object","keys","key","hasBorderShaders","_insertShaderBorders","shadingPosition","elem","className","background","shaderElem","parseInt","borderOffset","smallSize","largeSize","createBorder","backgroundColor","BORDER_SHADER_DEFAULT_COLOR","insertBorder","borderElem","borderShaders","firstTop","firstLeft","secondTop","secondLeft","qrMatch","shader","BORDER_SHADER_MATCH_COLOR","revokeObjectURL","exact","facingModeKey","deviceIdKey","allowedFacingModeValues","exactKey","isValidFacingModeValue","value","facingMode","type","oninactive","closeActiveStreams","tracks","enabled","removeTrack","results","message","MediaStreamTrack","getSources","sourceInfos","sourceInfo","Html5QrcodeScanner","currentScanType","SCAN_TYPE_CAMERA","sectionSwapAllowed","section","html5Qrcode","lastMatchFound","__setStatus","STATUS_SUCCESS","__setHeaderMessage","container","__createBasicLayout","__getScanRegionId","emptyHtmlContainer","mainContainer","__resetBasicLayout","parent","padding","border","__createHeader","qrCodeScanRegion","scanRegionId","minHeight","textAlign","__insertCameraScanImageToScanRegion","qrCodeDashboard","dashboardId","__getDashboardId","__setupInitialDashboard","dashboard","__createSection","__createSectionControlPanel","__createSectionSwap","header","margin","fontSize","borderBottom","titleSpan","statusSpan","__getStatusSpanId","float","color","headerMessageContainer","__getHeaderMessageContainerId","marginTop","borderTop","__getDashboardSectionId","sectionControlPanel","scpCameraScanRegion","__getDashboardSectionCameraScanRegionId","requestPermissionContainer","requestPermissionButton","addEventListener","disabled","getCameras","cameras","__resetHeaderMessage","STATUS_WARNING","__renderCameraSelection","fileBasedScanRegion","__getDashboardSectionFileScanRegionId","fileScanInput","__getFileScanInputId","accept","fileScanLabel","SCAN_TYPE_FILE","files","file","scanFile","qrCode","cameraSelectionContainer","marginRight","cameraSelectionSelect","__getCameraSelectionId","camera","option","cameraActionContainer","cameraActionStartButton","cameraActionStopButton","_showHideScanTypeSwapLink","cameraId","TEXT_IF_CAMERA_SCAN_SELECTED","TEXT_IF_FILE_SCAN_SELECTED","switchContainer","swithToFileBasedLink","textDecoration","__getDashboardSectionSwapLinkId","href","__getFileScanInput","__clearScanRegion","__getCameraScanRegion","__getFileScanRegion","__insertFileScanImageToScanRegion","statusText","statusClass","STATUS_DEFAULT","messageDiv","messageText","shouldDisplay","__getDashboardSectionSwapLink","cameraScanImage","opacity","ASSET_CAMERA_SCAN","fileScanImage","ASSET_FILE_SCAN","deferredInstallPrompt","installButton","installPWA","saveBeforeInstallPromptEvent","evt","removeAttribute","prompt","srcElement","setAttribute","userChoice","choice","outcome","logAppInstalled","App","html5QrCode","$scanBtn","querySelector","$stopBtn","$select","$output","cameraSettings","cameraConfig","init","initEvents","text","messsage","makeRequest","ignore","alert","url","fetch","method","response","json","msg","app","bundleURL","getBundleURLCached","getBundleURL","Error","matches","stack","match","getBaseURL","replace","exports","bundle","require","updateLink","link","newLink","cloneNode","remove","split","now","parentNode","insertBefore","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","module","OVERLAY_ID","OldModule","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","fn","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","overlay","createErrorOverlay","body","stackTrace","innerText","getParents","modules","parents","k","d","dep","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"js.00a46daa.js","sourceRoot":"..\\src","sourcesContent":["/*\r\n  Ported to JavaScript by Lazar Laszlo 2011 \r\n  \r\n  lazarsoft@gmail.com, www.lazarsoft.info\r\n  \r\n*/\r\n\r\n/*\r\n*\r\n* Copyright 2007 ZXing authors\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n*      http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing, software\r\n* distributed under the License is distributed on an \"AS IS\" BASIS,\r\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n* See the License for the specific language governing permissions and\r\n* limitations under the License.\r\n*/\r\n\r\nexport default function getLazarSoftScanner() {\r\n\r\n\tvar GridSampler = {};\r\n\r\n\tGridSampler.checkAndNudgePoints = function (image, points) {\r\n\t\tvar width = qrcode.width;\r\n\t\tvar height = qrcode.height;\r\n\t\t// Check and nudge points from start until we see some that are OK:\r\n\t\tvar nudged = true;\r\n\t\tfor (var offset = 0; offset < points.length && nudged; offset += 2) {\r\n\t\t\tvar x = Math.floor(points[offset]);\r\n\t\t\tvar y = Math.floor(points[offset + 1]);\r\n\t\t\tif (x < - 1 || x > width || y < - 1 || y > height) {\r\n\t\t\t\tthrow \"Error.checkAndNudgePoints \";\r\n\t\t\t}\r\n\t\t\tnudged = false;\r\n\t\t\tif (x == - 1) {\r\n\t\t\t\tpoints[offset] = 0.0;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t\telse if (x == width) {\r\n\t\t\t\tpoints[offset] = width - 1;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t\tif (y == - 1) {\r\n\t\t\t\tpoints[offset + 1] = 0.0;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t\telse if (y == height) {\r\n\t\t\t\tpoints[offset + 1] = height - 1;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Check and nudge points from end:\r\n\t\tnudged = true;\r\n\t\tfor (var offset = points.length - 2; offset >= 0 && nudged; offset -= 2) {\r\n\t\t\tvar x = Math.floor(points[offset]);\r\n\t\t\tvar y = Math.floor(points[offset + 1]);\r\n\t\t\tif (x < - 1 || x > width || y < - 1 || y > height) {\r\n\t\t\t\tthrow \"Error.checkAndNudgePoints \";\r\n\t\t\t}\r\n\t\t\tnudged = false;\r\n\t\t\tif (x == - 1) {\r\n\t\t\t\tpoints[offset] = 0.0;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t\telse if (x == width) {\r\n\t\t\t\tpoints[offset] = width - 1;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t\tif (y == - 1) {\r\n\t\t\t\tpoints[offset + 1] = 0.0;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t\telse if (y == height) {\r\n\t\t\t\tpoints[offset + 1] = height - 1;\r\n\t\t\t\tnudged = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\tGridSampler.sampleGrid3 = function (image, dimension, transform) {\r\n\t\tvar bits = new BitMatrix(dimension);\r\n\t\tvar points = new Array(dimension << 1);\r\n\t\tfor (var y = 0; y < dimension; y++) {\r\n\t\t\tvar max = points.length;\r\n\t\t\tvar iValue = y + 0.5;\r\n\t\t\tfor (var x = 0; x < max; x += 2) {\r\n\t\t\t\tpoints[x] = (x >> 1) + 0.5;\r\n\t\t\t\tpoints[x + 1] = iValue;\r\n\t\t\t}\r\n\t\t\ttransform.transformPoints1(points);\r\n\t\t\t// Quick check to see if points transformed to something inside the image;\r\n\t\t\t// sufficient to check the endpoints\r\n\t\t\tGridSampler.checkAndNudgePoints(image, points);\r\n\t\t\ttry {\r\n\t\t\t\tfor (var x = 0; x < max; x += 2) {\r\n\t\t\t\t\t//var xpoint = (Math.floor( points[x]) * 4) + (Math.floor( points[x + 1]) * qrcode.width * 4);\r\n\t\t\t\t\tvar bit = image[Math.floor(points[x]) + qrcode.width * Math.floor(points[x + 1])];\r\n\t\t\t\t\t//qrcode.imagedata.data[xpoint] = bit?255:0;\r\n\t\t\t\t\t//qrcode.imagedata.data[xpoint+1] = bit?255:0;\r\n\t\t\t\t\t//qrcode.imagedata.data[xpoint+2] = 0;\r\n\t\t\t\t\t//qrcode.imagedata.data[xpoint+3] = 255;\r\n\t\t\t\t\t//bits[x >> 1][ y]=bit;\r\n\t\t\t\t\tif (bit)\r\n\t\t\t\t\t\tbits.set_Renamed(x >> 1, y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch (aioobe) {\r\n\t\t\t\t// This feels wrong, but, sometimes if the finder patterns are misidentified, the resulting\r\n\t\t\t\t// transform gets \"twisted\" such that it maps a straight line of points to a set of points\r\n\t\t\t\t// whose endpoints are in bounds, but others are not. There is probably some mathematical\r\n\t\t\t\t// way to detect this about the transformation that I don't know yet.\r\n\t\t\t\t// This results in an ugly runtime exception despite our clever checks above -- can't have\r\n\t\t\t\t// that. We could check each point's coordinates but that feels duplicative. We settle for\r\n\t\t\t\t// catching and wrapping ArrayIndexOutOfBoundsException.\r\n\t\t\t\tthrow \"Error.checkAndNudgePoints\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn bits;\r\n\t}\r\n\r\n\tGridSampler.sampleGridx = function (image, dimension, p1ToX, p1ToY, p2ToX, p2ToY, p3ToX, p3ToY, p4ToX, p4ToY, p1FromX, p1FromY, p2FromX, p2FromY, p3FromX, p3FromY, p4FromX, p4FromY) {\r\n\t\tvar transform = PerspectiveTransform.quadrilateralToQuadrilateral(p1ToX, p1ToY, p2ToX, p2ToY, p3ToX, p3ToY, p4ToX, p4ToY, p1FromX, p1FromY, p2FromX, p2FromY, p3FromX, p3FromY, p4FromX, p4FromY);\r\n\r\n\t\treturn GridSampler.sampleGrid3(image, dimension, transform);\r\n\t}\r\n\r\n\r\n\r\n\tfunction ECB(count, dataCodewords) {\r\n\t\tthis.count = count;\r\n\t\tthis.dataCodewords = dataCodewords;\r\n\r\n\t\tthis.__defineGetter__(\"Count\", function () {\r\n\t\t\treturn this.count;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"DataCodewords\", function () {\r\n\t\t\treturn this.dataCodewords;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction ECBlocks(ecCodewordsPerBlock, ecBlocks1, ecBlocks2) {\r\n\t\tthis.ecCodewordsPerBlock = ecCodewordsPerBlock;\r\n\t\tif (ecBlocks2)\r\n\t\t\tthis.ecBlocks = new Array(ecBlocks1, ecBlocks2);\r\n\t\telse\r\n\t\t\tthis.ecBlocks = new Array(ecBlocks1);\r\n\r\n\t\tthis.__defineGetter__(\"ECCodewordsPerBlock\", function () {\r\n\t\t\treturn this.ecCodewordsPerBlock;\r\n\t\t});\r\n\r\n\t\tthis.__defineGetter__(\"TotalECCodewords\", function () {\r\n\t\t\treturn this.ecCodewordsPerBlock * this.NumBlocks;\r\n\t\t});\r\n\r\n\t\tthis.__defineGetter__(\"NumBlocks\", function () {\r\n\t\t\tvar total = 0;\r\n\t\t\tfor (var i = 0; i < this.ecBlocks.length; i++) {\r\n\t\t\t\ttotal += this.ecBlocks[i].length;\r\n\t\t\t}\r\n\t\t\treturn total;\r\n\t\t});\r\n\r\n\t\tthis.getECBlocks = function () {\r\n\t\t\treturn this.ecBlocks;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction Version(versionNumber, alignmentPatternCenters, ecBlocks1, ecBlocks2, ecBlocks3, ecBlocks4) {\r\n\t\tthis.versionNumber = versionNumber;\r\n\t\tthis.alignmentPatternCenters = alignmentPatternCenters;\r\n\t\tthis.ecBlocks = new Array(ecBlocks1, ecBlocks2, ecBlocks3, ecBlocks4);\r\n\r\n\t\tvar total = 0;\r\n\t\tvar ecCodewords = ecBlocks1.ECCodewordsPerBlock;\r\n\t\tvar ecbArray = ecBlocks1.getECBlocks();\r\n\t\tfor (var i = 0; i < ecbArray.length; i++) {\r\n\t\t\tvar ecBlock = ecbArray[i];\r\n\t\t\ttotal += ecBlock.Count * (ecBlock.DataCodewords + ecCodewords);\r\n\t\t}\r\n\t\tthis.totalCodewords = total;\r\n\r\n\t\tthis.__defineGetter__(\"VersionNumber\", function () {\r\n\t\t\treturn this.versionNumber;\r\n\t\t});\r\n\r\n\t\tthis.__defineGetter__(\"AlignmentPatternCenters\", function () {\r\n\t\t\treturn this.alignmentPatternCenters;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"TotalCodewords\", function () {\r\n\t\t\treturn this.totalCodewords;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"DimensionForVersion\", function () {\r\n\t\t\treturn 17 + 4 * this.versionNumber;\r\n\t\t});\r\n\r\n\t\tthis.buildFunctionPattern = function () {\r\n\t\t\tvar dimension = this.DimensionForVersion;\r\n\t\t\tvar bitMatrix = new BitMatrix(dimension);\r\n\r\n\t\t\t// Top left finder pattern + separator + format\r\n\t\t\tbitMatrix.setRegion(0, 0, 9, 9);\r\n\t\t\t// Top right finder pattern + separator + format\r\n\t\t\tbitMatrix.setRegion(dimension - 8, 0, 8, 9);\r\n\t\t\t// Bottom left finder pattern + separator + format\r\n\t\t\tbitMatrix.setRegion(0, dimension - 8, 9, 8);\r\n\r\n\t\t\t// Alignment patterns\r\n\t\t\tvar max = this.alignmentPatternCenters.length;\r\n\t\t\tfor (var x = 0; x < max; x++) {\r\n\t\t\t\tvar i = this.alignmentPatternCenters[x] - 2;\r\n\t\t\t\tfor (var y = 0; y < max; y++) {\r\n\t\t\t\t\tif ((x == 0 && (y == 0 || y == max - 1)) || (x == max - 1 && y == 0)) {\r\n\t\t\t\t\t\t// No alignment patterns near the three finder paterns\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbitMatrix.setRegion(this.alignmentPatternCenters[y] - 2, i, 5, 5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Vertical timing pattern\r\n\t\t\tbitMatrix.setRegion(6, 9, 1, dimension - 17);\r\n\t\t\t// Horizontal timing pattern\r\n\t\t\tbitMatrix.setRegion(9, 6, dimension - 17, 1);\r\n\r\n\t\t\tif (this.versionNumber > 6) {\r\n\t\t\t\t// Version info, top right\r\n\t\t\t\tbitMatrix.setRegion(dimension - 11, 0, 3, 6);\r\n\t\t\t\t// Version info, bottom left\r\n\t\t\t\tbitMatrix.setRegion(0, dimension - 11, 6, 3);\r\n\t\t\t}\r\n\r\n\t\t\treturn bitMatrix;\r\n\t\t}\r\n\t\tthis.getECBlocksForLevel = function (ecLevel) {\r\n\t\t\treturn this.ecBlocks[ecLevel.ordinal()];\r\n\t\t}\r\n\t}\r\n\r\n\tVersion.VERSION_DECODE_INFO = new Array(0x07C94, 0x085BC, 0x09A99, 0x0A4D3, 0x0BBF6, 0x0C762, 0x0D847, 0x0E60D, 0x0F928, 0x10B78, 0x1145D, 0x12A17, 0x13532, 0x149A6, 0x15683, 0x168C9, 0x177EC, 0x18EC4, 0x191E1, 0x1AFAB, 0x1B08E, 0x1CC1A, 0x1D33F, 0x1ED75, 0x1F250, 0x209D5, 0x216F0, 0x228BA, 0x2379F, 0x24B0B, 0x2542E, 0x26A64, 0x27541, 0x28C69);\r\n\r\n\tVersion.VERSIONS = buildVersions();\r\n\r\n\tVersion.getVersionForNumber = function (versionNumber) {\r\n\t\tif (versionNumber < 1 || versionNumber > 40) {\r\n\t\t\tthrow \"ArgumentException\";\r\n\t\t}\r\n\t\treturn Version.VERSIONS[versionNumber - 1];\r\n\t}\r\n\r\n\tVersion.getProvisionalVersionForDimension = function (dimension) {\r\n\t\tif (dimension % 4 != 1) {\r\n\t\t\tthrow \"Error getProvisionalVersionForDimension\";\r\n\t\t}\r\n\t\ttry {\r\n\t\t\treturn Version.getVersionForNumber((dimension - 17) >> 2);\r\n\t\t}\r\n\t\tcatch (iae) {\r\n\t\t\tthrow \"Error getVersionForNumber\";\r\n\t\t}\r\n\t}\r\n\r\n\tVersion.decodeVersionInformation = function (versionBits) {\r\n\t\tvar bestDifference = 0xffffffff;\r\n\t\tvar bestVersion = 0;\r\n\t\tfor (var i = 0; i < Version.VERSION_DECODE_INFO.length; i++) {\r\n\t\t\tvar targetVersion = Version.VERSION_DECODE_INFO[i];\r\n\t\t\t// Do the version info bits match exactly? done.\r\n\t\t\tif (targetVersion == versionBits) {\r\n\t\t\t\treturn this.getVersionForNumber(i + 7);\r\n\t\t\t}\r\n\t\t\t// Otherwise see if this is the closest to a real version info bit string\r\n\t\t\t// we have seen so far\r\n\t\t\tvar bitsDifference = FormatInformation.numBitsDiffering(versionBits, targetVersion);\r\n\t\t\tif (bitsDifference < bestDifference) {\r\n\t\t\t\tbestVersion = i + 7;\r\n\t\t\t\tbestDifference = bitsDifference;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// We can tolerate up to 3 bits of error since no two version info codewords will\r\n\t\t// differ in less than 4 bits.\r\n\t\tif (bestDifference <= 3) {\r\n\t\t\treturn this.getVersionForNumber(bestVersion);\r\n\t\t}\r\n\t\t// If we didn't find a close enough match, fail\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction buildVersions() {\r\n\t\treturn new Array(new Version(1, new Array(), new ECBlocks(7, new ECB(1, 19)), new ECBlocks(10, new ECB(1, 16)), new ECBlocks(13, new ECB(1, 13)), new ECBlocks(17, new ECB(1, 9))),\r\n\t\t\tnew Version(2, new Array(6, 18), new ECBlocks(10, new ECB(1, 34)), new ECBlocks(16, new ECB(1, 28)), new ECBlocks(22, new ECB(1, 22)), new ECBlocks(28, new ECB(1, 16))),\r\n\t\t\tnew Version(3, new Array(6, 22), new ECBlocks(15, new ECB(1, 55)), new ECBlocks(26, new ECB(1, 44)), new ECBlocks(18, new ECB(2, 17)), new ECBlocks(22, new ECB(2, 13))),\r\n\t\t\tnew Version(4, new Array(6, 26), new ECBlocks(20, new ECB(1, 80)), new ECBlocks(18, new ECB(2, 32)), new ECBlocks(26, new ECB(2, 24)), new ECBlocks(16, new ECB(4, 9))),\r\n\t\t\tnew Version(5, new Array(6, 30), new ECBlocks(26, new ECB(1, 108)), new ECBlocks(24, new ECB(2, 43)), new ECBlocks(18, new ECB(2, 15), new ECB(2, 16)), new ECBlocks(22, new ECB(2, 11), new ECB(2, 12))),\r\n\t\t\tnew Version(6, new Array(6, 34), new ECBlocks(18, new ECB(2, 68)), new ECBlocks(16, new ECB(4, 27)), new ECBlocks(24, new ECB(4, 19)), new ECBlocks(28, new ECB(4, 15))),\r\n\t\t\tnew Version(7, new Array(6, 22, 38), new ECBlocks(20, new ECB(2, 78)), new ECBlocks(18, new ECB(4, 31)), new ECBlocks(18, new ECB(2, 14), new ECB(4, 15)), new ECBlocks(26, new ECB(4, 13), new ECB(1, 14))),\r\n\t\t\tnew Version(8, new Array(6, 24, 42), new ECBlocks(24, new ECB(2, 97)), new ECBlocks(22, new ECB(2, 38), new ECB(2, 39)), new ECBlocks(22, new ECB(4, 18), new ECB(2, 19)), new ECBlocks(26, new ECB(4, 14), new ECB(2, 15))),\r\n\t\t\tnew Version(9, new Array(6, 26, 46), new ECBlocks(30, new ECB(2, 116)), new ECBlocks(22, new ECB(3, 36), new ECB(2, 37)), new ECBlocks(20, new ECB(4, 16), new ECB(4, 17)), new ECBlocks(24, new ECB(4, 12), new ECB(4, 13))),\r\n\t\t\tnew Version(10, new Array(6, 28, 50), new ECBlocks(18, new ECB(2, 68), new ECB(2, 69)), new ECBlocks(26, new ECB(4, 43), new ECB(1, 44)), new ECBlocks(24, new ECB(6, 19), new ECB(2, 20)), new ECBlocks(28, new ECB(6, 15), new ECB(2, 16))),\r\n\t\t\tnew Version(11, new Array(6, 30, 54), new ECBlocks(20, new ECB(4, 81)), new ECBlocks(30, new ECB(1, 50), new ECB(4, 51)), new ECBlocks(28, new ECB(4, 22), new ECB(4, 23)), new ECBlocks(24, new ECB(3, 12), new ECB(8, 13))),\r\n\t\t\tnew Version(12, new Array(6, 32, 58), new ECBlocks(24, new ECB(2, 92), new ECB(2, 93)), new ECBlocks(22, new ECB(6, 36), new ECB(2, 37)), new ECBlocks(26, new ECB(4, 20), new ECB(6, 21)), new ECBlocks(28, new ECB(7, 14), new ECB(4, 15))),\r\n\t\t\tnew Version(13, new Array(6, 34, 62), new ECBlocks(26, new ECB(4, 107)), new ECBlocks(22, new ECB(8, 37), new ECB(1, 38)), new ECBlocks(24, new ECB(8, 20), new ECB(4, 21)), new ECBlocks(22, new ECB(12, 11), new ECB(4, 12))),\r\n\t\t\tnew Version(14, new Array(6, 26, 46, 66), new ECBlocks(30, new ECB(3, 115), new ECB(1, 116)), new ECBlocks(24, new ECB(4, 40), new ECB(5, 41)), new ECBlocks(20, new ECB(11, 16), new ECB(5, 17)), new ECBlocks(24, new ECB(11, 12), new ECB(5, 13))),\r\n\t\t\tnew Version(15, new Array(6, 26, 48, 70), new ECBlocks(22, new ECB(5, 87), new ECB(1, 88)), new ECBlocks(24, new ECB(5, 41), new ECB(5, 42)), new ECBlocks(30, new ECB(5, 24), new ECB(7, 25)), new ECBlocks(24, new ECB(11, 12), new ECB(7, 13))),\r\n\t\t\tnew Version(16, new Array(6, 26, 50, 74), new ECBlocks(24, new ECB(5, 98), new ECB(1, 99)), new ECBlocks(28, new ECB(7, 45), new ECB(3, 46)), new ECBlocks(24, new ECB(15, 19), new ECB(2, 20)), new ECBlocks(30, new ECB(3, 15), new ECB(13, 16))),\r\n\t\t\tnew Version(17, new Array(6, 30, 54, 78), new ECBlocks(28, new ECB(1, 107), new ECB(5, 108)), new ECBlocks(28, new ECB(10, 46), new ECB(1, 47)), new ECBlocks(28, new ECB(1, 22), new ECB(15, 23)), new ECBlocks(28, new ECB(2, 14), new ECB(17, 15))),\r\n\t\t\tnew Version(18, new Array(6, 30, 56, 82), new ECBlocks(30, new ECB(5, 120), new ECB(1, 121)), new ECBlocks(26, new ECB(9, 43), new ECB(4, 44)), new ECBlocks(28, new ECB(17, 22), new ECB(1, 23)), new ECBlocks(28, new ECB(2, 14), new ECB(19, 15))),\r\n\t\t\tnew Version(19, new Array(6, 30, 58, 86), new ECBlocks(28, new ECB(3, 113), new ECB(4, 114)), new ECBlocks(26, new ECB(3, 44), new ECB(11, 45)), new ECBlocks(26, new ECB(17, 21), new ECB(4, 22)), new ECBlocks(26, new ECB(9, 13), new ECB(16, 14))),\r\n\t\t\tnew Version(20, new Array(6, 34, 62, 90), new ECBlocks(28, new ECB(3, 107), new ECB(5, 108)), new ECBlocks(26, new ECB(3, 41), new ECB(13, 42)), new ECBlocks(30, new ECB(15, 24), new ECB(5, 25)), new ECBlocks(28, new ECB(15, 15), new ECB(10, 16))),\r\n\t\t\tnew Version(21, new Array(6, 28, 50, 72, 94), new ECBlocks(28, new ECB(4, 116), new ECB(4, 117)), new ECBlocks(26, new ECB(17, 42)), new ECBlocks(28, new ECB(17, 22), new ECB(6, 23)), new ECBlocks(30, new ECB(19, 16), new ECB(6, 17))),\r\n\t\t\tnew Version(22, new Array(6, 26, 50, 74, 98), new ECBlocks(28, new ECB(2, 111), new ECB(7, 112)), new ECBlocks(28, new ECB(17, 46)), new ECBlocks(30, new ECB(7, 24), new ECB(16, 25)), new ECBlocks(24, new ECB(34, 13))),\r\n\t\t\tnew Version(23, new Array(6, 30, 54, 74, 102), new ECBlocks(30, new ECB(4, 121), new ECB(5, 122)), new ECBlocks(28, new ECB(4, 47), new ECB(14, 48)), new ECBlocks(30, new ECB(11, 24), new ECB(14, 25)), new ECBlocks(30, new ECB(16, 15), new ECB(14, 16))),\r\n\t\t\tnew Version(24, new Array(6, 28, 54, 80, 106), new ECBlocks(30, new ECB(6, 117), new ECB(4, 118)), new ECBlocks(28, new ECB(6, 45), new ECB(14, 46)), new ECBlocks(30, new ECB(11, 24), new ECB(16, 25)), new ECBlocks(30, new ECB(30, 16), new ECB(2, 17))),\r\n\t\t\tnew Version(25, new Array(6, 32, 58, 84, 110), new ECBlocks(26, new ECB(8, 106), new ECB(4, 107)), new ECBlocks(28, new ECB(8, 47), new ECB(13, 48)), new ECBlocks(30, new ECB(7, 24), new ECB(22, 25)), new ECBlocks(30, new ECB(22, 15), new ECB(13, 16))),\r\n\t\t\tnew Version(26, new Array(6, 30, 58, 86, 114), new ECBlocks(28, new ECB(10, 114), new ECB(2, 115)), new ECBlocks(28, new ECB(19, 46), new ECB(4, 47)), new ECBlocks(28, new ECB(28, 22), new ECB(6, 23)), new ECBlocks(30, new ECB(33, 16), new ECB(4, 17))),\r\n\t\t\tnew Version(27, new Array(6, 34, 62, 90, 118), new ECBlocks(30, new ECB(8, 122), new ECB(4, 123)), new ECBlocks(28, new ECB(22, 45), new ECB(3, 46)), new ECBlocks(30, new ECB(8, 23), new ECB(26, 24)), new ECBlocks(30, new ECB(12, 15), new ECB(28, 16))),\r\n\t\t\tnew Version(28, new Array(6, 26, 50, 74, 98, 122), new ECBlocks(30, new ECB(3, 117), new ECB(10, 118)), new ECBlocks(28, new ECB(3, 45), new ECB(23, 46)), new ECBlocks(30, new ECB(4, 24), new ECB(31, 25)), new ECBlocks(30, new ECB(11, 15), new ECB(31, 16))),\r\n\t\t\tnew Version(29, new Array(6, 30, 54, 78, 102, 126), new ECBlocks(30, new ECB(7, 116), new ECB(7, 117)), new ECBlocks(28, new ECB(21, 45), new ECB(7, 46)), new ECBlocks(30, new ECB(1, 23), new ECB(37, 24)), new ECBlocks(30, new ECB(19, 15), new ECB(26, 16))),\r\n\t\t\tnew Version(30, new Array(6, 26, 52, 78, 104, 130), new ECBlocks(30, new ECB(5, 115), new ECB(10, 116)), new ECBlocks(28, new ECB(19, 47), new ECB(10, 48)), new ECBlocks(30, new ECB(15, 24), new ECB(25, 25)), new ECBlocks(30, new ECB(23, 15), new ECB(25, 16))),\r\n\t\t\tnew Version(31, new Array(6, 30, 56, 82, 108, 134), new ECBlocks(30, new ECB(13, 115), new ECB(3, 116)), new ECBlocks(28, new ECB(2, 46), new ECB(29, 47)), new ECBlocks(30, new ECB(42, 24), new ECB(1, 25)), new ECBlocks(30, new ECB(23, 15), new ECB(28, 16))),\r\n\t\t\tnew Version(32, new Array(6, 34, 60, 86, 112, 138), new ECBlocks(30, new ECB(17, 115)), new ECBlocks(28, new ECB(10, 46), new ECB(23, 47)), new ECBlocks(30, new ECB(10, 24), new ECB(35, 25)), new ECBlocks(30, new ECB(19, 15), new ECB(35, 16))),\r\n\t\t\tnew Version(33, new Array(6, 30, 58, 86, 114, 142), new ECBlocks(30, new ECB(17, 115), new ECB(1, 116)), new ECBlocks(28, new ECB(14, 46), new ECB(21, 47)), new ECBlocks(30, new ECB(29, 24), new ECB(19, 25)), new ECBlocks(30, new ECB(11, 15), new ECB(46, 16))),\r\n\t\t\tnew Version(34, new Array(6, 34, 62, 90, 118, 146), new ECBlocks(30, new ECB(13, 115), new ECB(6, 116)), new ECBlocks(28, new ECB(14, 46), new ECB(23, 47)), new ECBlocks(30, new ECB(44, 24), new ECB(7, 25)), new ECBlocks(30, new ECB(59, 16), new ECB(1, 17))),\r\n\t\t\tnew Version(35, new Array(6, 30, 54, 78, 102, 126, 150), new ECBlocks(30, new ECB(12, 121), new ECB(7, 122)), new ECBlocks(28, new ECB(12, 47), new ECB(26, 48)), new ECBlocks(30, new ECB(39, 24), new ECB(14, 25)), new ECBlocks(30, new ECB(22, 15), new ECB(41, 16))),\r\n\t\t\tnew Version(36, new Array(6, 24, 50, 76, 102, 128, 154), new ECBlocks(30, new ECB(6, 121), new ECB(14, 122)), new ECBlocks(28, new ECB(6, 47), new ECB(34, 48)), new ECBlocks(30, new ECB(46, 24), new ECB(10, 25)), new ECBlocks(30, new ECB(2, 15), new ECB(64, 16))),\r\n\t\t\tnew Version(37, new Array(6, 28, 54, 80, 106, 132, 158), new ECBlocks(30, new ECB(17, 122), new ECB(4, 123)), new ECBlocks(28, new ECB(29, 46), new ECB(14, 47)), new ECBlocks(30, new ECB(49, 24), new ECB(10, 25)), new ECBlocks(30, new ECB(24, 15), new ECB(46, 16))),\r\n\t\t\tnew Version(38, new Array(6, 32, 58, 84, 110, 136, 162), new ECBlocks(30, new ECB(4, 122), new ECB(18, 123)), new ECBlocks(28, new ECB(13, 46), new ECB(32, 47)), new ECBlocks(30, new ECB(48, 24), new ECB(14, 25)), new ECBlocks(30, new ECB(42, 15), new ECB(32, 16))),\r\n\t\t\tnew Version(39, new Array(6, 26, 54, 82, 110, 138, 166), new ECBlocks(30, new ECB(20, 117), new ECB(4, 118)), new ECBlocks(28, new ECB(40, 47), new ECB(7, 48)), new ECBlocks(30, new ECB(43, 24), new ECB(22, 25)), new ECBlocks(30, new ECB(10, 15), new ECB(67, 16))),\r\n\t\t\tnew Version(40, new Array(6, 30, 58, 86, 114, 142, 170), new ECBlocks(30, new ECB(19, 118), new ECB(6, 119)), new ECBlocks(28, new ECB(18, 47), new ECB(31, 48)), new ECBlocks(30, new ECB(34, 24), new ECB(34, 25)), new ECBlocks(30, new ECB(20, 15), new ECB(61, 16))));\r\n\t}\r\n\r\n\r\n\r\n\tfunction PerspectiveTransform(a11, a21, a31, a12, a22, a32, a13, a23, a33) {\r\n\t\tthis.a11 = a11;\r\n\t\tthis.a12 = a12;\r\n\t\tthis.a13 = a13;\r\n\t\tthis.a21 = a21;\r\n\t\tthis.a22 = a22;\r\n\t\tthis.a23 = a23;\r\n\t\tthis.a31 = a31;\r\n\t\tthis.a32 = a32;\r\n\t\tthis.a33 = a33;\r\n\t\tthis.transformPoints1 = function (points) {\r\n\t\t\tvar max = points.length;\r\n\t\t\tvar a11 = this.a11;\r\n\t\t\tvar a12 = this.a12;\r\n\t\t\tvar a13 = this.a13;\r\n\t\t\tvar a21 = this.a21;\r\n\t\t\tvar a22 = this.a22;\r\n\t\t\tvar a23 = this.a23;\r\n\t\t\tvar a31 = this.a31;\r\n\t\t\tvar a32 = this.a32;\r\n\t\t\tvar a33 = this.a33;\r\n\t\t\tfor (var i = 0; i < max; i += 2) {\r\n\t\t\t\tvar x = points[i];\r\n\t\t\t\tvar y = points[i + 1];\r\n\t\t\t\tvar denominator = a13 * x + a23 * y + a33;\r\n\t\t\t\tpoints[i] = (a11 * x + a21 * y + a31) / denominator;\r\n\t\t\t\tpoints[i + 1] = (a12 * x + a22 * y + a32) / denominator;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.transformPoints2 = function (xValues, yValues) {\r\n\t\t\tvar n = xValues.length;\r\n\t\t\tfor (var i = 0; i < n; i++) {\r\n\t\t\t\tvar x = xValues[i];\r\n\t\t\t\tvar y = yValues[i];\r\n\t\t\t\tvar denominator = this.a13 * x + this.a23 * y + this.a33;\r\n\t\t\t\txValues[i] = (this.a11 * x + this.a21 * y + this.a31) / denominator;\r\n\t\t\t\tyValues[i] = (this.a12 * x + this.a22 * y + this.a32) / denominator;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.buildAdjoint = function () {\r\n\t\t\t// Adjoint is the transpose of the cofactor matrix:\r\n\t\t\treturn new PerspectiveTransform(this.a22 * this.a33 - this.a23 * this.a32, this.a23 * this.a31 - this.a21 * this.a33, this.a21 * this.a32 - this.a22 * this.a31, this.a13 * this.a32 - this.a12 * this.a33, this.a11 * this.a33 - this.a13 * this.a31, this.a12 * this.a31 - this.a11 * this.a32, this.a12 * this.a23 - this.a13 * this.a22, this.a13 * this.a21 - this.a11 * this.a23, this.a11 * this.a22 - this.a12 * this.a21);\r\n\t\t}\r\n\t\tthis.times = function (other) {\r\n\t\t\treturn new PerspectiveTransform(this.a11 * other.a11 + this.a21 * other.a12 + this.a31 * other.a13, this.a11 * other.a21 + this.a21 * other.a22 + this.a31 * other.a23, this.a11 * other.a31 + this.a21 * other.a32 + this.a31 * other.a33, this.a12 * other.a11 + this.a22 * other.a12 + this.a32 * other.a13, this.a12 * other.a21 + this.a22 * other.a22 + this.a32 * other.a23, this.a12 * other.a31 + this.a22 * other.a32 + this.a32 * other.a33, this.a13 * other.a11 + this.a23 * other.a12 + this.a33 * other.a13, this.a13 * other.a21 + this.a23 * other.a22 + this.a33 * other.a23, this.a13 * other.a31 + this.a23 * other.a32 + this.a33 * other.a33);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tPerspectiveTransform.quadrilateralToQuadrilateral = function (x0, y0, x1, y1, x2, y2, x3, y3, x0p, y0p, x1p, y1p, x2p, y2p, x3p, y3p) {\r\n\r\n\t\tvar qToS = this.quadrilateralToSquare(x0, y0, x1, y1, x2, y2, x3, y3);\r\n\t\tvar sToQ = this.squareToQuadrilateral(x0p, y0p, x1p, y1p, x2p, y2p, x3p, y3p);\r\n\t\treturn sToQ.times(qToS);\r\n\t}\r\n\r\n\tPerspectiveTransform.squareToQuadrilateral = function (x0, y0, x1, y1, x2, y2, x3, y3) {\r\n\t\tvar dy2 = y3 - y2;\r\n\t\tvar dy3 = y0 - y1 + y2 - y3;\r\n\t\tif (dy2 == 0.0 && dy3 == 0.0) {\r\n\t\t\treturn new PerspectiveTransform(x1 - x0, x2 - x1, x0, y1 - y0, y2 - y1, y0, 0.0, 0.0, 1.0);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar dx1 = x1 - x2;\r\n\t\t\tvar dx2 = x3 - x2;\r\n\t\t\tvar dx3 = x0 - x1 + x2 - x3;\r\n\t\t\tvar dy1 = y1 - y2;\r\n\t\t\tvar denominator = dx1 * dy2 - dx2 * dy1;\r\n\t\t\tvar a13 = (dx3 * dy2 - dx2 * dy3) / denominator;\r\n\t\t\tvar a23 = (dx1 * dy3 - dx3 * dy1) / denominator;\r\n\t\t\treturn new PerspectiveTransform(x1 - x0 + a13 * x1, x3 - x0 + a23 * x3, x0, y1 - y0 + a13 * y1, y3 - y0 + a23 * y3, y0, a13, a23, 1.0);\r\n\t\t}\r\n\t}\r\n\r\n\tPerspectiveTransform.quadrilateralToSquare = function (x0, y0, x1, y1, x2, y2, x3, y3) {\r\n\t\t// Here, the adjoint serves as the inverse:\r\n\t\treturn this.squareToQuadrilateral(x0, y0, x1, y1, x2, y2, x3, y3).buildAdjoint();\r\n\t}\r\n\r\n\tfunction DetectorResult(bits, points) {\r\n\t\tthis.bits = bits;\r\n\t\tthis.points = points;\r\n\t}\r\n\r\n\r\n\tfunction Detector(image) {\r\n\t\tthis.image = image;\r\n\t\tthis.resultPointCallback = null;\r\n\r\n\t\tthis.sizeOfBlackWhiteBlackRun = function (fromX, fromY, toX, toY) {\r\n\t\t\t// Mild variant of Bresenham's algorithm;\r\n\t\t\t// see http://en.wikipedia.org/wiki/Bresenham's_line_algorithm\r\n\t\t\tvar steep = Math.abs(toY - fromY) > Math.abs(toX - fromX);\r\n\t\t\tif (steep) {\r\n\t\t\t\tvar temp = fromX;\r\n\t\t\t\tfromX = fromY;\r\n\t\t\t\tfromY = temp;\r\n\t\t\t\ttemp = toX;\r\n\t\t\t\ttoX = toY;\r\n\t\t\t\ttoY = temp;\r\n\t\t\t}\r\n\r\n\t\t\tvar dx = Math.abs(toX - fromX);\r\n\t\t\tvar dy = Math.abs(toY - fromY);\r\n\t\t\tvar error = - dx >> 1;\r\n\t\t\tvar ystep = fromY < toY ? 1 : - 1;\r\n\t\t\tvar xstep = fromX < toX ? 1 : - 1;\r\n\t\t\tvar state = 0; // In black pixels, looking for white, first or second time\r\n\t\t\tfor (var x = fromX, y = fromY; x != toX; x += xstep) {\r\n\r\n\t\t\t\tvar realX = steep ? y : x;\r\n\t\t\t\tvar realY = steep ? x : y;\r\n\t\t\t\tif (state == 1) {\r\n\t\t\t\t\t// In white pixels, looking for black\r\n\t\t\t\t\tif (this.image[realX + realY * qrcode.width]) {\r\n\t\t\t\t\t\tstate++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (!this.image[realX + realY * qrcode.width]) {\r\n\t\t\t\t\t\tstate++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (state == 3) {\r\n\t\t\t\t\t// Found black, white, black, and stumbled back onto white; done\r\n\t\t\t\t\tvar diffX = x - fromX;\r\n\t\t\t\t\tvar diffY = y - fromY;\r\n\t\t\t\t\treturn Math.sqrt((diffX * diffX + diffY * diffY));\r\n\t\t\t\t}\r\n\t\t\t\terror += dy;\r\n\t\t\t\tif (error > 0) {\r\n\t\t\t\t\tif (y == toY) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ty += ystep;\r\n\t\t\t\t\terror -= dx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar diffX2 = toX - fromX;\r\n\t\t\tvar diffY2 = toY - fromY;\r\n\t\t\treturn Math.sqrt((diffX2 * diffX2 + diffY2 * diffY2));\r\n\t\t}\r\n\r\n\r\n\t\tthis.sizeOfBlackWhiteBlackRunBothWays = function (fromX, fromY, toX, toY) {\r\n\r\n\t\t\tvar result = this.sizeOfBlackWhiteBlackRun(fromX, fromY, toX, toY);\r\n\r\n\t\t\t// Now count other way -- don't run off image though of course\r\n\t\t\tvar scale = 1.0;\r\n\t\t\tvar otherToX = fromX - (toX - fromX);\r\n\t\t\tif (otherToX < 0) {\r\n\t\t\t\tscale = fromX / (fromX - otherToX);\r\n\t\t\t\totherToX = 0;\r\n\t\t\t}\r\n\t\t\telse if (otherToX >= qrcode.width) {\r\n\t\t\t\tscale = (qrcode.width - 1 - fromX) / (otherToX - fromX);\r\n\t\t\t\totherToX = qrcode.width - 1;\r\n\t\t\t}\r\n\t\t\tvar otherToY = Math.floor(fromY - (toY - fromY) * scale);\r\n\r\n\t\t\tscale = 1.0;\r\n\t\t\tif (otherToY < 0) {\r\n\t\t\t\tscale = fromY / (fromY - otherToY);\r\n\t\t\t\totherToY = 0;\r\n\t\t\t}\r\n\t\t\telse if (otherToY >= qrcode.height) {\r\n\t\t\t\tscale = (qrcode.height - 1 - fromY) / (otherToY - fromY);\r\n\t\t\t\totherToY = qrcode.height - 1;\r\n\t\t\t}\r\n\t\t\totherToX = Math.floor(fromX + (otherToX - fromX) * scale);\r\n\r\n\t\t\tresult += this.sizeOfBlackWhiteBlackRun(fromX, fromY, otherToX, otherToY);\r\n\t\t\treturn result - 1.0; // -1 because we counted the middle pixel twice\r\n\t\t}\r\n\r\n\r\n\r\n\t\tthis.calculateModuleSizeOneWay = function (pattern, otherPattern) {\r\n\t\t\tvar moduleSizeEst1 = this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(pattern.X), Math.floor(pattern.Y), Math.floor(otherPattern.X), Math.floor(otherPattern.Y));\r\n\t\t\tvar moduleSizeEst2 = this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(otherPattern.X), Math.floor(otherPattern.Y), Math.floor(pattern.X), Math.floor(pattern.Y));\r\n\t\t\tif (isNaN(moduleSizeEst1)) {\r\n\t\t\t\treturn moduleSizeEst2 / 7.0;\r\n\t\t\t}\r\n\t\t\tif (isNaN(moduleSizeEst2)) {\r\n\t\t\t\treturn moduleSizeEst1 / 7.0;\r\n\t\t\t}\r\n\t\t\t// Average them, and divide by 7 since we've counted the width of 3 black modules,\r\n\t\t\t// and 1 white and 1 black module on either side. Ergo, divide sum by 14.\r\n\t\t\treturn (moduleSizeEst1 + moduleSizeEst2) / 14.0;\r\n\t\t}\r\n\r\n\r\n\t\tthis.calculateModuleSize = function (topLeft, topRight, bottomLeft) {\r\n\t\t\t// Take the average\r\n\t\t\treturn (this.calculateModuleSizeOneWay(topLeft, topRight) + this.calculateModuleSizeOneWay(topLeft, bottomLeft)) / 2.0;\r\n\t\t}\r\n\r\n\t\tthis.distance = function (pattern1, pattern2) {\r\n\t\t\tvar xDiff = pattern1.X - pattern2.X;\r\n\t\t\tvar yDiff = pattern1.Y - pattern2.Y;\r\n\t\t\treturn Math.sqrt((xDiff * xDiff + yDiff * yDiff));\r\n\t\t}\r\n\t\tthis.computeDimension = function (topLeft, topRight, bottomLeft, moduleSize) {\r\n\r\n\t\t\tvar tltrCentersDimension = Math.round(this.distance(topLeft, topRight) / moduleSize);\r\n\t\t\tvar tlblCentersDimension = Math.round(this.distance(topLeft, bottomLeft) / moduleSize);\r\n\t\t\tvar dimension = ((tltrCentersDimension + tlblCentersDimension) >> 1) + 7;\r\n\t\t\tswitch (dimension & 0x03) {\r\n\r\n\t\t\t\t// mod 4\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tdimension++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// 1? do nothing\r\n\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tdimension--;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tthrow \"Error\";\r\n\t\t\t}\r\n\t\t\treturn dimension;\r\n\t\t}\r\n\r\n\t\tthis.findAlignmentInRegion = function (overallEstModuleSize, estAlignmentX, estAlignmentY, allowanceFactor) {\r\n\t\t\t// Look for an alignment pattern (3 modules in size) around where it\r\n\t\t\t// should be\r\n\t\t\tvar allowance = Math.floor(allowanceFactor * overallEstModuleSize);\r\n\t\t\tvar alignmentAreaLeftX = Math.max(0, estAlignmentX - allowance);\r\n\t\t\tvar alignmentAreaRightX = Math.min(qrcode.width - 1, estAlignmentX + allowance);\r\n\t\t\tif (alignmentAreaRightX - alignmentAreaLeftX < overallEstModuleSize * 3) {\r\n\t\t\t\tthrow \"Error\";\r\n\t\t\t}\r\n\r\n\t\t\tvar alignmentAreaTopY = Math.max(0, estAlignmentY - allowance);\r\n\t\t\tvar alignmentAreaBottomY = Math.min(qrcode.height - 1, estAlignmentY + allowance);\r\n\r\n\t\t\tvar alignmentFinder = new AlignmentPatternFinder(this.image, alignmentAreaLeftX, alignmentAreaTopY, alignmentAreaRightX - alignmentAreaLeftX, alignmentAreaBottomY - alignmentAreaTopY, overallEstModuleSize, this.resultPointCallback);\r\n\t\t\treturn alignmentFinder.find();\r\n\t\t}\r\n\r\n\t\tthis.createTransform = function (topLeft, topRight, bottomLeft, alignmentPattern, dimension) {\r\n\t\t\tvar dimMinusThree = dimension - 3.5;\r\n\t\t\tvar bottomRightX;\r\n\t\t\tvar bottomRightY;\r\n\t\t\tvar sourceBottomRightX;\r\n\t\t\tvar sourceBottomRightY;\r\n\t\t\tif (alignmentPattern != null) {\r\n\t\t\t\tbottomRightX = alignmentPattern.X;\r\n\t\t\t\tbottomRightY = alignmentPattern.Y;\r\n\t\t\t\tsourceBottomRightX = sourceBottomRightY = dimMinusThree - 3.0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Don't have an alignment pattern, just make up the bottom-right point\r\n\t\t\t\tbottomRightX = (topRight.X - topLeft.X) + bottomLeft.X;\r\n\t\t\t\tbottomRightY = (topRight.Y - topLeft.Y) + bottomLeft.Y;\r\n\t\t\t\tsourceBottomRightX = sourceBottomRightY = dimMinusThree;\r\n\t\t\t}\r\n\r\n\t\t\tvar transform = PerspectiveTransform.quadrilateralToQuadrilateral(3.5, 3.5, dimMinusThree, 3.5, sourceBottomRightX, sourceBottomRightY, 3.5, dimMinusThree, topLeft.X, topLeft.Y, topRight.X, topRight.Y, bottomRightX, bottomRightY, bottomLeft.X, bottomLeft.Y);\r\n\r\n\t\t\treturn transform;\r\n\t\t}\r\n\r\n\t\tthis.sampleGrid = function (image, transform, dimension) {\r\n\r\n\t\t\tvar sampler = GridSampler;\r\n\t\t\treturn sampler.sampleGrid3(image, dimension, transform);\r\n\t\t}\r\n\r\n\t\tthis.processFinderPatternInfo = function (info) {\r\n\r\n\t\t\tvar topLeft = info.TopLeft;\r\n\t\t\tvar topRight = info.TopRight;\r\n\t\t\tvar bottomLeft = info.BottomLeft;\r\n\r\n\t\t\tvar moduleSize = this.calculateModuleSize(topLeft, topRight, bottomLeft);\r\n\t\t\tif (moduleSize < 1.0) {\r\n\t\t\t\tthrow \"Error\";\r\n\t\t\t}\r\n\t\t\tvar dimension = this.computeDimension(topLeft, topRight, bottomLeft, moduleSize);\r\n\t\t\tvar provisionalVersion = Version.getProvisionalVersionForDimension(dimension);\r\n\t\t\tvar modulesBetweenFPCenters = provisionalVersion.DimensionForVersion - 7;\r\n\r\n\t\t\tvar alignmentPattern = null;\r\n\t\t\t// Anything above version 1 has an alignment pattern\r\n\t\t\tif (provisionalVersion.AlignmentPatternCenters.length > 0) {\r\n\r\n\t\t\t\t// Guess where a \"bottom right\" finder pattern would have been\r\n\t\t\t\tvar bottomRightX = topRight.X - topLeft.X + bottomLeft.X;\r\n\t\t\t\tvar bottomRightY = topRight.Y - topLeft.Y + bottomLeft.Y;\r\n\r\n\t\t\t\t// Estimate that alignment pattern is closer by 3 modules\r\n\t\t\t\t// from \"bottom right\" to known top left location\r\n\t\t\t\tvar correctionToTopLeft = 1.0 - 3.0 / modulesBetweenFPCenters;\r\n\t\t\t\tvar estAlignmentX = Math.floor(topLeft.X + correctionToTopLeft * (bottomRightX - topLeft.X));\r\n\t\t\t\tvar estAlignmentY = Math.floor(topLeft.Y + correctionToTopLeft * (bottomRightY - topLeft.Y));\r\n\r\n\t\t\t\t// Kind of arbitrary -- expand search radius before giving up\r\n\t\t\t\tfor (var i = 4; i <= 16; i <<= 1) {\r\n\t\t\t\t\t//try\r\n\t\t\t\t\t//{\r\n\t\t\t\t\talignmentPattern = this.findAlignmentInRegion(moduleSize, estAlignmentX, estAlignmentY, i);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t//catch (re)\r\n\t\t\t\t\t//{\r\n\t\t\t\t\t// try next round\r\n\t\t\t\t\t//}\r\n\t\t\t\t}\r\n\t\t\t\t// If we didn't find alignment pattern... well try anyway without it\r\n\t\t\t}\r\n\r\n\t\t\tvar transform = this.createTransform(topLeft, topRight, bottomLeft, alignmentPattern, dimension);\r\n\r\n\t\t\tvar bits = this.sampleGrid(this.image, transform, dimension);\r\n\r\n\t\t\tvar points;\r\n\t\t\tif (alignmentPattern == null) {\r\n\t\t\t\tpoints = new Array(bottomLeft, topLeft, topRight);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tpoints = new Array(bottomLeft, topLeft, topRight, alignmentPattern);\r\n\t\t\t}\r\n\t\t\treturn new DetectorResult(bits, points);\r\n\t\t}\r\n\r\n\r\n\r\n\t\tthis.detect = function () {\r\n\t\t\tvar info = new FinderPatternFinder().findFinderPattern(this.image);\r\n\r\n\t\t\treturn this.processFinderPatternInfo(info);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\tvar FORMAT_INFO_MASK_QR = 0x5412;\r\n\tvar FORMAT_INFO_DECODE_LOOKUP = new Array(new Array(0x5412, 0x00), new Array(0x5125, 0x01), new Array(0x5E7C, 0x02), new Array(0x5B4B, 0x03), new Array(0x45F9, 0x04), new Array(0x40CE, 0x05), new Array(0x4F97, 0x06), new Array(0x4AA0, 0x07), new Array(0x77C4, 0x08), new Array(0x72F3, 0x09), new Array(0x7DAA, 0x0A), new Array(0x789D, 0x0B), new Array(0x662F, 0x0C), new Array(0x6318, 0x0D), new Array(0x6C41, 0x0E), new Array(0x6976, 0x0F), new Array(0x1689, 0x10), new Array(0x13BE, 0x11), new Array(0x1CE7, 0x12), new Array(0x19D0, 0x13), new Array(0x0762, 0x14), new Array(0x0255, 0x15), new Array(0x0D0C, 0x16), new Array(0x083B, 0x17), new Array(0x355F, 0x18), new Array(0x3068, 0x19), new Array(0x3F31, 0x1A), new Array(0x3A06, 0x1B), new Array(0x24B4, 0x1C), new Array(0x2183, 0x1D), new Array(0x2EDA, 0x1E), new Array(0x2BED, 0x1F));\r\n\tvar BITS_SET_IN_HALF_BYTE = new Array(0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4);\r\n\r\n\r\n\tfunction FormatInformation(formatInfo) {\r\n\t\tthis.errorCorrectionLevel = ErrorCorrectionLevel.forBits((formatInfo >> 3) & 0x03);\r\n\t\tthis.dataMask = (formatInfo & 0x07);\r\n\r\n\t\tthis.__defineGetter__(\"ErrorCorrectionLevel\", function () {\r\n\t\t\treturn this.errorCorrectionLevel;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"DataMask\", function () {\r\n\t\t\treturn this.dataMask;\r\n\t\t});\r\n\t\tthis.GetHashCode = function () {\r\n\t\t\treturn (this.errorCorrectionLevel.ordinal() << 3) | this.dataMask;\r\n\t\t}\r\n\t\tthis.Equals = function (o) {\r\n\t\t\tvar other = o;\r\n\t\t\treturn this.errorCorrectionLevel == other.errorCorrectionLevel && this.dataMask == other.dataMask;\r\n\t\t}\r\n\t}\r\n\r\n\tFormatInformation.numBitsDiffering = function (a, b) {\r\n\t\ta ^= b; // a now has a 1 bit exactly where its bit differs with b's\r\n\t\t// Count bits set quickly with a series of lookups:\r\n\t\treturn BITS_SET_IN_HALF_BYTE[a & 0x0F] + BITS_SET_IN_HALF_BYTE[(URShift(a, 4) & 0x0F)] + BITS_SET_IN_HALF_BYTE[(URShift(a, 8) & 0x0F)] + BITS_SET_IN_HALF_BYTE[(URShift(a, 12) & 0x0F)] + BITS_SET_IN_HALF_BYTE[(URShift(a, 16) & 0x0F)] + BITS_SET_IN_HALF_BYTE[(URShift(a, 20) & 0x0F)] + BITS_SET_IN_HALF_BYTE[(URShift(a, 24) & 0x0F)] + BITS_SET_IN_HALF_BYTE[(URShift(a, 28) & 0x0F)];\r\n\t}\r\n\r\n\tFormatInformation.decodeFormatInformation = function (maskedFormatInfo) {\r\n\t\tvar formatInfo = FormatInformation.doDecodeFormatInformation(maskedFormatInfo);\r\n\t\tif (formatInfo != null) {\r\n\t\t\treturn formatInfo;\r\n\t\t}\r\n\t\t// Should return null, but, some QR codes apparently\r\n\t\t// do not mask this info. Try again by actually masking the pattern\r\n\t\t// first\r\n\t\treturn FormatInformation.doDecodeFormatInformation(maskedFormatInfo ^ FORMAT_INFO_MASK_QR);\r\n\t}\r\n\tFormatInformation.doDecodeFormatInformation = function (maskedFormatInfo) {\r\n\t\t// Find the int in FORMAT_INFO_DECODE_LOOKUP with fewest bits differing\r\n\t\tvar bestDifference = 0xffffffff;\r\n\t\tvar bestFormatInfo = 0;\r\n\t\tfor (var i = 0; i < FORMAT_INFO_DECODE_LOOKUP.length; i++) {\r\n\t\t\tvar decodeInfo = FORMAT_INFO_DECODE_LOOKUP[i];\r\n\t\t\tvar targetInfo = decodeInfo[0];\r\n\t\t\tif (targetInfo == maskedFormatInfo) {\r\n\t\t\t\t// Found an exact match\r\n\t\t\t\treturn new FormatInformation(decodeInfo[1]);\r\n\t\t\t}\r\n\t\t\tvar bitsDifference = this.numBitsDiffering(maskedFormatInfo, targetInfo);\r\n\t\t\tif (bitsDifference < bestDifference) {\r\n\t\t\t\tbestFormatInfo = decodeInfo[1];\r\n\t\t\t\tbestDifference = bitsDifference;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Hamming distance of the 32 masked codes is 7, by construction, so <= 3 bits\r\n\t\t// differing means we found a match\r\n\t\tif (bestDifference <= 3) {\r\n\t\t\treturn new FormatInformation(bestFormatInfo);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\r\n\r\n\tfunction ErrorCorrectionLevel(ordinal, bits, name) {\r\n\t\tthis.ordinal_Renamed_Field = ordinal;\r\n\t\tthis.bits = bits;\r\n\t\tthis.name = name;\r\n\t\tthis.__defineGetter__(\"Bits\", function () {\r\n\t\t\treturn this.bits;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Name\", function () {\r\n\t\t\treturn this.name;\r\n\t\t});\r\n\t\tthis.ordinal = function () {\r\n\t\t\treturn this.ordinal_Renamed_Field;\r\n\t\t}\r\n\t}\r\n\r\n\tErrorCorrectionLevel.forBits = function (bits) {\r\n\t\tif (bits < 0 || bits >= FOR_BITS.length) {\r\n\t\t\tthrow \"ArgumentException\";\r\n\t\t}\r\n\t\treturn FOR_BITS[bits];\r\n\t}\r\n\r\n\tvar L = new ErrorCorrectionLevel(0, 0x01, \"L\");\r\n\tvar M = new ErrorCorrectionLevel(1, 0x00, \"M\");\r\n\tvar Q = new ErrorCorrectionLevel(2, 0x03, \"Q\");\r\n\tvar H = new ErrorCorrectionLevel(3, 0x02, \"H\");\r\n\tvar FOR_BITS = new Array(M, L, H, Q);\r\n\r\n\r\n\r\n\tfunction BitMatrix(width, height) {\r\n\t\tif (!height)\r\n\t\t\theight = width;\r\n\t\tif (width < 1 || height < 1) {\r\n\t\t\tthrow \"Both dimensions must be greater than 0\";\r\n\t\t}\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tvar rowSize = width >> 5;\r\n\t\tif ((width & 0x1f) != 0) {\r\n\t\t\trowSize++;\r\n\t\t}\r\n\t\tthis.rowSize = rowSize;\r\n\t\tthis.bits = new Array(rowSize * height);\r\n\t\tfor (var i = 0; i < this.bits.length; i++)\r\n\t\t\tthis.bits[i] = 0;\r\n\r\n\t\tthis.__defineGetter__(\"Width\", function () {\r\n\t\t\treturn this.width;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Height\", function () {\r\n\t\t\treturn this.height;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Dimension\", function () {\r\n\t\t\tif (this.width != this.height) {\r\n\t\t\t\tthrow \"Can't call getDimension() on a non-square matrix\";\r\n\t\t\t}\r\n\t\t\treturn this.width;\r\n\t\t});\r\n\r\n\t\tthis.get_Renamed = function (x, y) {\r\n\t\t\tvar offset = y * this.rowSize + (x >> 5);\r\n\t\t\treturn ((URShift(this.bits[offset], (x & 0x1f))) & 1) != 0;\r\n\t\t}\r\n\t\tthis.set_Renamed = function (x, y) {\r\n\t\t\tvar offset = y * this.rowSize + (x >> 5);\r\n\t\t\tthis.bits[offset] |= 1 << (x & 0x1f);\r\n\t\t}\r\n\t\tthis.flip = function (x, y) {\r\n\t\t\tvar offset = y * this.rowSize + (x >> 5);\r\n\t\t\tthis.bits[offset] ^= 1 << (x & 0x1f);\r\n\t\t}\r\n\t\tthis.clear = function () {\r\n\t\t\tvar max = this.bits.length;\r\n\t\t\tfor (var i = 0; i < max; i++) {\r\n\t\t\t\tthis.bits[i] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setRegion = function (left, top, width, height) {\r\n\t\t\tif (top < 0 || left < 0) {\r\n\t\t\t\tthrow \"Left and top must be nonnegative\";\r\n\t\t\t}\r\n\t\t\tif (height < 1 || width < 1) {\r\n\t\t\t\tthrow \"Height and width must be at least 1\";\r\n\t\t\t}\r\n\t\t\tvar right = left + width;\r\n\t\t\tvar bottom = top + height;\r\n\t\t\tif (bottom > this.height || right > this.width) {\r\n\t\t\t\tthrow \"The region must fit inside the matrix\";\r\n\t\t\t}\r\n\t\t\tfor (var y = top; y < bottom; y++) {\r\n\t\t\t\tvar offset = y * this.rowSize;\r\n\t\t\t\tfor (var x = left; x < right; x++) {\r\n\t\t\t\t\tthis.bits[offset + (x >> 5)] |= 1 << (x & 0x1f);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tfunction DataBlock(numDataCodewords, codewords) {\r\n\t\tthis.numDataCodewords = numDataCodewords;\r\n\t\tthis.codewords = codewords;\r\n\r\n\t\tthis.__defineGetter__(\"NumDataCodewords\", function () {\r\n\t\t\treturn this.numDataCodewords;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Codewords\", function () {\r\n\t\t\treturn this.codewords;\r\n\t\t});\r\n\t}\r\n\r\n\tDataBlock.getDataBlocks = function (rawCodewords, version, ecLevel) {\r\n\r\n\t\tif (rawCodewords.length != version.TotalCodewords) {\r\n\t\t\tthrow \"ArgumentException\";\r\n\t\t}\r\n\r\n\t\t// Figure out the number and size of data blocks used by this version and\r\n\t\t// error correction level\r\n\t\tvar ecBlocks = version.getECBlocksForLevel(ecLevel);\r\n\r\n\t\t// First count the total number of data blocks\r\n\t\tvar totalBlocks = 0;\r\n\t\tvar ecBlockArray = ecBlocks.getECBlocks();\r\n\t\tfor (var i = 0; i < ecBlockArray.length; i++) {\r\n\t\t\ttotalBlocks += ecBlockArray[i].Count;\r\n\t\t}\r\n\r\n\t\t// Now establish DataBlocks of the appropriate size and number of data codewords\r\n\t\tvar result = new Array(totalBlocks);\r\n\t\tvar numResultBlocks = 0;\r\n\t\tfor (var j = 0; j < ecBlockArray.length; j++) {\r\n\t\t\tvar ecBlock = ecBlockArray[j];\r\n\t\t\tfor (var i = 0; i < ecBlock.Count; i++) {\r\n\t\t\t\tvar numDataCodewords = ecBlock.DataCodewords;\r\n\t\t\t\tvar numBlockCodewords = ecBlocks.ECCodewordsPerBlock + numDataCodewords;\r\n\t\t\t\tresult[numResultBlocks++] = new DataBlock(numDataCodewords, new Array(numBlockCodewords));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// All blocks have the same amount of data, except that the last n\r\n\t\t// (where n may be 0) have 1 more byte. Figure out where these start.\r\n\t\tvar shorterBlocksTotalCodewords = result[0].codewords.length;\r\n\t\tvar longerBlocksStartAt = result.length - 1;\r\n\t\twhile (longerBlocksStartAt >= 0) {\r\n\t\t\tvar numCodewords = result[longerBlocksStartAt].codewords.length;\r\n\t\t\tif (numCodewords == shorterBlocksTotalCodewords) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tlongerBlocksStartAt--;\r\n\t\t}\r\n\t\tlongerBlocksStartAt++;\r\n\r\n\t\tvar shorterBlocksNumDataCodewords = shorterBlocksTotalCodewords - ecBlocks.ECCodewordsPerBlock;\r\n\t\t// The last elements of result may be 1 element longer;\r\n\t\t// first fill out as many elements as all of them have\r\n\t\tvar rawCodewordsOffset = 0;\r\n\t\tfor (var i = 0; i < shorterBlocksNumDataCodewords; i++) {\r\n\t\t\tfor (var j = 0; j < numResultBlocks; j++) {\r\n\t\t\t\tresult[j].codewords[i] = rawCodewords[rawCodewordsOffset++];\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Fill out the last data block in the longer ones\r\n\t\tfor (var j = longerBlocksStartAt; j < numResultBlocks; j++) {\r\n\t\t\tresult[j].codewords[shorterBlocksNumDataCodewords] = rawCodewords[rawCodewordsOffset++];\r\n\t\t}\r\n\t\t// Now add in error correction blocks\r\n\t\tvar max = result[0].codewords.length;\r\n\t\tfor (var i = shorterBlocksNumDataCodewords; i < max; i++) {\r\n\t\t\tfor (var j = 0; j < numResultBlocks; j++) {\r\n\t\t\t\tvar iOffset = j < longerBlocksStartAt ? i : i + 1;\r\n\t\t\t\tresult[j].codewords[iOffset] = rawCodewords[rawCodewordsOffset++];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\r\n\tfunction BitMatrixParser(bitMatrix) {\r\n\t\tvar dimension = bitMatrix.Dimension;\r\n\t\tif (dimension < 21 || (dimension & 0x03) != 1) {\r\n\t\t\tthrow \"Error BitMatrixParser\";\r\n\t\t}\r\n\t\tthis.bitMatrix = bitMatrix;\r\n\t\tthis.parsedVersion = null;\r\n\t\tthis.parsedFormatInfo = null;\r\n\r\n\t\tthis.copyBit = function (i, j, versionBits) {\r\n\t\t\treturn this.bitMatrix.get_Renamed(i, j) ? (versionBits << 1) | 0x1 : versionBits << 1;\r\n\t\t}\r\n\r\n\t\tthis.readFormatInformation = function () {\r\n\t\t\tif (this.parsedFormatInfo != null) {\r\n\t\t\t\treturn this.parsedFormatInfo;\r\n\t\t\t}\r\n\r\n\t\t\t// Read top-left format info bits\r\n\t\t\tvar formatInfoBits = 0;\r\n\t\t\tfor (var i = 0; i < 6; i++) {\r\n\t\t\t\tformatInfoBits = this.copyBit(i, 8, formatInfoBits);\r\n\t\t\t}\r\n\t\t\t// .. and skip a bit in the timing pattern ...\r\n\t\t\tformatInfoBits = this.copyBit(7, 8, formatInfoBits);\r\n\t\t\tformatInfoBits = this.copyBit(8, 8, formatInfoBits);\r\n\t\t\tformatInfoBits = this.copyBit(8, 7, formatInfoBits);\r\n\t\t\t// .. and skip a bit in the timing pattern ...\r\n\t\t\tfor (var j = 5; j >= 0; j--) {\r\n\t\t\t\tformatInfoBits = this.copyBit(8, j, formatInfoBits);\r\n\t\t\t}\r\n\r\n\t\t\tthis.parsedFormatInfo = FormatInformation.decodeFormatInformation(formatInfoBits);\r\n\t\t\tif (this.parsedFormatInfo != null) {\r\n\t\t\t\treturn this.parsedFormatInfo;\r\n\t\t\t}\r\n\r\n\t\t\t// Hmm, failed. Try the top-right/bottom-left pattern\r\n\t\t\tvar dimension = this.bitMatrix.Dimension;\r\n\t\t\tformatInfoBits = 0;\r\n\t\t\tvar iMin = dimension - 8;\r\n\t\t\tfor (var i = dimension - 1; i >= iMin; i--) {\r\n\t\t\t\tformatInfoBits = this.copyBit(i, 8, formatInfoBits);\r\n\t\t\t}\r\n\t\t\tfor (var j = dimension - 7; j < dimension; j++) {\r\n\t\t\t\tformatInfoBits = this.copyBit(8, j, formatInfoBits);\r\n\t\t\t}\r\n\r\n\t\t\tthis.parsedFormatInfo = FormatInformation.decodeFormatInformation(formatInfoBits);\r\n\t\t\tif (this.parsedFormatInfo != null) {\r\n\t\t\t\treturn this.parsedFormatInfo;\r\n\t\t\t}\r\n\t\t\tthrow \"Error readFormatInformation\";\r\n\t\t}\r\n\t\tthis.readVersion = function () {\r\n\r\n\t\t\tif (this.parsedVersion != null) {\r\n\t\t\t\treturn this.parsedVersion;\r\n\t\t\t}\r\n\r\n\t\t\tvar dimension = this.bitMatrix.Dimension;\r\n\r\n\t\t\tvar provisionalVersion = (dimension - 17) >> 2;\r\n\t\t\tif (provisionalVersion <= 6) {\r\n\t\t\t\treturn Version.getVersionForNumber(provisionalVersion);\r\n\t\t\t}\r\n\r\n\t\t\t// Read top-right version info: 3 wide by 6 tall\r\n\t\t\tvar versionBits = 0;\r\n\t\t\tvar ijMin = dimension - 11;\r\n\t\t\tfor (var j = 5; j >= 0; j--) {\r\n\t\t\t\tfor (var i = dimension - 9; i >= ijMin; i--) {\r\n\t\t\t\t\tversionBits = this.copyBit(i, j, versionBits);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.parsedVersion = Version.decodeVersionInformation(versionBits);\r\n\t\t\tif (this.parsedVersion != null && this.parsedVersion.DimensionForVersion == dimension) {\r\n\t\t\t\treturn this.parsedVersion;\r\n\t\t\t}\r\n\r\n\t\t\t// Hmm, failed. Try bottom left: 6 wide by 3 tall\r\n\t\t\tversionBits = 0;\r\n\t\t\tfor (var i = 5; i >= 0; i--) {\r\n\t\t\t\tfor (var j = dimension - 9; j >= ijMin; j--) {\r\n\t\t\t\t\tversionBits = this.copyBit(i, j, versionBits);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.parsedVersion = Version.decodeVersionInformation(versionBits);\r\n\t\t\tif (this.parsedVersion != null && this.parsedVersion.DimensionForVersion == dimension) {\r\n\t\t\t\treturn this.parsedVersion;\r\n\t\t\t}\r\n\t\t\tthrow \"Error readVersion\";\r\n\t\t}\r\n\t\tthis.readCodewords = function () {\r\n\r\n\t\t\tvar formatInfo = this.readFormatInformation();\r\n\t\t\tvar version = this.readVersion();\r\n\r\n\t\t\t// Get the data mask for the format used in this QR Code. This will exclude\r\n\t\t\t// some bits from reading as we wind through the bit matrix.\r\n\t\t\tvar dataMask = DataMask.forReference(formatInfo.DataMask);\r\n\t\t\tvar dimension = this.bitMatrix.Dimension;\r\n\t\t\tdataMask.unmaskBitMatrix(this.bitMatrix, dimension);\r\n\r\n\t\t\tvar functionPattern = version.buildFunctionPattern();\r\n\r\n\t\t\tvar readingUp = true;\r\n\t\t\tvar result = new Array(version.TotalCodewords);\r\n\t\t\tvar resultOffset = 0;\r\n\t\t\tvar currentByte = 0;\r\n\t\t\tvar bitsRead = 0;\r\n\t\t\t// Read columns in pairs, from right to left\r\n\t\t\tfor (var j = dimension - 1; j > 0; j -= 2) {\r\n\t\t\t\tif (j == 6) {\r\n\t\t\t\t\t// Skip whole column with vertical alignment pattern;\r\n\t\t\t\t\t// saves time and makes the other code proceed more cleanly\r\n\t\t\t\t\tj--;\r\n\t\t\t\t}\r\n\t\t\t\t// Read alternatingly from bottom to top then top to bottom\r\n\t\t\t\tfor (var count = 0; count < dimension; count++) {\r\n\t\t\t\t\tvar i = readingUp ? dimension - 1 - count : count;\r\n\t\t\t\t\tfor (var col = 0; col < 2; col++) {\r\n\t\t\t\t\t\t// Ignore bits covered by the function pattern\r\n\t\t\t\t\t\tif (!functionPattern.get_Renamed(j - col, i)) {\r\n\t\t\t\t\t\t\t// Read a bit\r\n\t\t\t\t\t\t\tbitsRead++;\r\n\t\t\t\t\t\t\tcurrentByte <<= 1;\r\n\t\t\t\t\t\t\tif (this.bitMatrix.get_Renamed(j - col, i)) {\r\n\t\t\t\t\t\t\t\tcurrentByte |= 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// If we've made a whole byte, save it off\r\n\t\t\t\t\t\t\tif (bitsRead == 8) {\r\n\t\t\t\t\t\t\t\tresult[resultOffset++] = currentByte;\r\n\t\t\t\t\t\t\t\tbitsRead = 0;\r\n\t\t\t\t\t\t\t\tcurrentByte = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treadingUp ^= true; // readingUp = !readingUp; // switch directions\r\n\t\t\t}\r\n\t\t\tif (resultOffset != version.TotalCodewords) {\r\n\t\t\t\tthrow \"Error readCodewords\";\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\tvar DataMask = {};\r\n\r\n\tDataMask.forReference = function (reference) {\r\n\t\tif (reference < 0 || reference > 7) {\r\n\t\t\tthrow \"System.ArgumentException\";\r\n\t\t}\r\n\t\treturn DataMask.DATA_MASKS[reference];\r\n\t}\r\n\r\n\tfunction DataMask000() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\treturn ((i + j) & 0x01) == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DataMask001() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\treturn (i & 0x01) == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DataMask010() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\treturn j % 3 == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DataMask011() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\treturn (i + j) % 3 == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DataMask100() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\treturn (((URShift(i, 1)) + (j / 3)) & 0x01) == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DataMask101() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\tvar temp = i * j;\r\n\t\t\treturn (temp & 0x01) + (temp % 3) == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DataMask110() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\tvar temp = i * j;\r\n\t\t\treturn (((temp & 0x01) + (temp % 3)) & 0x01) == 0;\r\n\t\t}\r\n\t}\r\n\tfunction DataMask111() {\r\n\t\tthis.unmaskBitMatrix = function (bits, dimension) {\r\n\t\t\tfor (var i = 0; i < dimension; i++) {\r\n\t\t\t\tfor (var j = 0; j < dimension; j++) {\r\n\t\t\t\t\tif (this.isMasked(i, j)) {\r\n\t\t\t\t\t\tbits.flip(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.isMasked = function (i, j) {\r\n\t\t\treturn ((((i + j) & 0x01) + ((i * j) % 3)) & 0x01) == 0;\r\n\t\t}\r\n\t}\r\n\r\n\tDataMask.DATA_MASKS = new Array(new DataMask000(), new DataMask001(), new DataMask010(), new DataMask011(), new DataMask100(), new DataMask101(), new DataMask110(), new DataMask111());\r\n\r\n\r\n\r\n\tfunction ReedSolomonDecoder(field) {\r\n\t\tthis.field = field;\r\n\t\tthis.decode = function (received, twoS) {\r\n\t\t\tvar poly = new GF256Poly(this.field, received);\r\n\t\t\tvar syndromeCoefficients = new Array(twoS);\r\n\t\t\tfor (var i = 0; i < syndromeCoefficients.length; i++)syndromeCoefficients[i] = 0;\r\n\t\t\tvar dataMatrix = false;//this.field.Equals(GF256.DATA_MATRIX_FIELD);\r\n\t\t\tvar noError = true;\r\n\t\t\tfor (var i = 0; i < twoS; i++) {\r\n\t\t\t\t// Thanks to sanfordsquires for this fix:\r\n\t\t\t\tvar evalu = poly.evaluateAt(this.field.exp(dataMatrix ? i + 1 : i));\r\n\t\t\t\tsyndromeCoefficients[syndromeCoefficients.length - 1 - i] = evalu;\r\n\t\t\t\tif (evalu != 0) {\r\n\t\t\t\t\tnoError = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (noError) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar syndrome = new GF256Poly(this.field, syndromeCoefficients);\r\n\t\t\tvar sigmaOmega = this.runEuclideanAlgorithm(this.field.buildMonomial(twoS, 1), syndrome, twoS);\r\n\t\t\tvar sigma = sigmaOmega[0];\r\n\t\t\tvar omega = sigmaOmega[1];\r\n\t\t\tvar errorLocations = this.findErrorLocations(sigma);\r\n\t\t\tvar errorMagnitudes = this.findErrorMagnitudes(omega, errorLocations, dataMatrix);\r\n\t\t\tfor (var i = 0; i < errorLocations.length; i++) {\r\n\t\t\t\tvar position = received.length - 1 - this.field.log(errorLocations[i]);\r\n\t\t\t\tif (position < 0) {\r\n\t\t\t\t\tthrow \"ReedSolomonException Bad error location\";\r\n\t\t\t\t}\r\n\t\t\t\treceived[position] = GF256.addOrSubtract(received[position], errorMagnitudes[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.runEuclideanAlgorithm = function (a, b, R) {\r\n\t\t\t// Assume a's degree is >= b's\r\n\t\t\tif (a.Degree < b.Degree) {\r\n\t\t\t\tvar temp = a;\r\n\t\t\t\ta = b;\r\n\t\t\t\tb = temp;\r\n\t\t\t}\r\n\r\n\t\t\tvar rLast = a;\r\n\t\t\tvar r = b;\r\n\t\t\tvar sLast = this.field.One;\r\n\t\t\tvar s = this.field.Zero;\r\n\t\t\tvar tLast = this.field.Zero;\r\n\t\t\tvar t = this.field.One;\r\n\r\n\t\t\t// Run Euclidean algorithm until r's degree is less than R/2\r\n\t\t\twhile (r.Degree >= Math.floor(R / 2)) {\r\n\t\t\t\tvar rLastLast = rLast;\r\n\t\t\t\tvar sLastLast = sLast;\r\n\t\t\t\tvar tLastLast = tLast;\r\n\t\t\t\trLast = r;\r\n\t\t\t\tsLast = s;\r\n\t\t\t\ttLast = t;\r\n\r\n\t\t\t\t// Divide rLastLast by rLast, with quotient in q and remainder in r\r\n\t\t\t\tif (rLast.Zero) {\r\n\t\t\t\t\t// Oops, Euclidean algorithm already terminated?\r\n\t\t\t\t\tthrow \"r_{i-1} was zero\";\r\n\t\t\t\t}\r\n\t\t\t\tr = rLastLast;\r\n\t\t\t\tvar q = this.field.Zero;\r\n\t\t\t\tvar denominatorLeadingTerm = rLast.getCoefficient(rLast.Degree);\r\n\t\t\t\tvar dltInverse = this.field.inverse(denominatorLeadingTerm);\r\n\t\t\t\twhile (r.Degree >= rLast.Degree && !r.Zero) {\r\n\t\t\t\t\tvar degreeDiff = r.Degree - rLast.Degree;\r\n\t\t\t\t\tvar scale = this.field.multiply(r.getCoefficient(r.Degree), dltInverse);\r\n\t\t\t\t\tq = q.addOrSubtract(this.field.buildMonomial(degreeDiff, scale));\r\n\t\t\t\t\tr = r.addOrSubtract(rLast.multiplyByMonomial(degreeDiff, scale));\r\n\t\t\t\t\t//r.EXE();\r\n\t\t\t\t}\r\n\r\n\t\t\t\ts = q.multiply1(sLast).addOrSubtract(sLastLast);\r\n\t\t\t\tt = q.multiply1(tLast).addOrSubtract(tLastLast);\r\n\t\t\t}\r\n\r\n\t\t\tvar sigmaTildeAtZero = t.getCoefficient(0);\r\n\t\t\tif (sigmaTildeAtZero == 0) {\r\n\t\t\t\tthrow \"ReedSolomonException sigmaTilde(0) was zero\";\r\n\t\t\t}\r\n\r\n\t\t\tvar inverse = this.field.inverse(sigmaTildeAtZero);\r\n\t\t\tvar sigma = t.multiply2(inverse);\r\n\t\t\tvar omega = r.multiply2(inverse);\r\n\t\t\treturn new Array(sigma, omega);\r\n\t\t}\r\n\t\tthis.findErrorLocations = function (errorLocator) {\r\n\t\t\t// This is a direct application of Chien's search\r\n\t\t\tvar numErrors = errorLocator.Degree;\r\n\t\t\tif (numErrors == 1) {\r\n\t\t\t\t// shortcut\r\n\t\t\t\treturn new Array(errorLocator.getCoefficient(1));\r\n\t\t\t}\r\n\t\t\tvar result = new Array(numErrors);\r\n\t\t\tvar e = 0;\r\n\t\t\tfor (var i = 1; i < 256 && e < numErrors; i++) {\r\n\t\t\t\tif (errorLocator.evaluateAt(i) == 0) {\r\n\t\t\t\t\tresult[e] = this.field.inverse(i);\r\n\t\t\t\t\te++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (e != numErrors) {\r\n\t\t\t\tthrow \"Error locator degree does not match number of roots\";\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tthis.findErrorMagnitudes = function (errorEvaluator, errorLocations, dataMatrix) {\r\n\t\t\t// This is directly applying Forney's Formula\r\n\t\t\tvar s = errorLocations.length;\r\n\t\t\tvar result = new Array(s);\r\n\t\t\tfor (var i = 0; i < s; i++) {\r\n\t\t\t\tvar xiInverse = this.field.inverse(errorLocations[i]);\r\n\t\t\t\tvar denominator = 1;\r\n\t\t\t\tfor (var j = 0; j < s; j++) {\r\n\t\t\t\t\tif (i != j) {\r\n\t\t\t\t\t\tdenominator = this.field.multiply(denominator, GF256.addOrSubtract(1, this.field.multiply(errorLocations[j], xiInverse)));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tresult[i] = this.field.multiply(errorEvaluator.evaluateAt(xiInverse), this.field.inverse(denominator));\r\n\t\t\t\t// Thanks to sanfordsquires for this fix:\r\n\t\t\t\tif (dataMatrix) {\r\n\t\t\t\t\tresult[i] = this.field.multiply(result[i], xiInverse);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\tfunction GF256Poly(field, coefficients) {\r\n\t\tif (coefficients == null || coefficients.length == 0) {\r\n\t\t\tthrow \"System.ArgumentException\";\r\n\t\t}\r\n\t\tthis.field = field;\r\n\t\tvar coefficientsLength = coefficients.length;\r\n\t\tif (coefficientsLength > 1 && coefficients[0] == 0) {\r\n\t\t\t// Leading term must be non-zero for anything except the constant polynomial \"0\"\r\n\t\t\tvar firstNonZero = 1;\r\n\t\t\twhile (firstNonZero < coefficientsLength && coefficients[firstNonZero] == 0) {\r\n\t\t\t\tfirstNonZero++;\r\n\t\t\t}\r\n\t\t\tif (firstNonZero == coefficientsLength) {\r\n\t\t\t\tthis.coefficients = field.Zero.coefficients;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.coefficients = new Array(coefficientsLength - firstNonZero);\r\n\t\t\t\tfor (var i = 0; i < this.coefficients.length; i++)this.coefficients[i] = 0;\r\n\t\t\t\t//Array.Copy(coefficients, firstNonZero, this.coefficients, 0, this.coefficients.length);\r\n\t\t\t\tfor (var ci = 0; ci < this.coefficients.length; ci++)this.coefficients[ci] = coefficients[firstNonZero + ci];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.coefficients = coefficients;\r\n\t\t}\r\n\r\n\t\tthis.__defineGetter__(\"Zero\", function () {\r\n\t\t\treturn this.coefficients[0] == 0;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Degree\", function () {\r\n\t\t\treturn this.coefficients.length - 1;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Coefficients\", function () {\r\n\t\t\treturn this.coefficients;\r\n\t\t});\r\n\r\n\t\tthis.getCoefficient = function (degree) {\r\n\t\t\treturn this.coefficients[this.coefficients.length - 1 - degree];\r\n\t\t}\r\n\r\n\t\tthis.evaluateAt = function (a) {\r\n\t\t\tif (a == 0) {\r\n\t\t\t\t// Just return the x^0 coefficient\r\n\t\t\t\treturn this.getCoefficient(0);\r\n\t\t\t}\r\n\t\t\tvar size = this.coefficients.length;\r\n\t\t\tif (a == 1) {\r\n\t\t\t\t// Just the sum of the coefficients\r\n\t\t\t\tvar result = 0;\r\n\t\t\t\tfor (var i = 0; i < size; i++) {\r\n\t\t\t\t\tresult = GF256.addOrSubtract(result, this.coefficients[i]);\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tvar result2 = this.coefficients[0];\r\n\t\t\tfor (var i = 1; i < size; i++) {\r\n\t\t\t\tresult2 = GF256.addOrSubtract(this.field.multiply(a, result2), this.coefficients[i]);\r\n\t\t\t}\r\n\t\t\treturn result2;\r\n\t\t}\r\n\r\n\t\tthis.addOrSubtract = function (other) {\r\n\t\t\tif (this.field != other.field) {\r\n\t\t\t\tthrow \"GF256Polys do not have same GF256 field\";\r\n\t\t\t}\r\n\t\t\tif (this.Zero) {\r\n\t\t\t\treturn other;\r\n\t\t\t}\r\n\t\t\tif (other.Zero) {\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\r\n\t\t\tvar smallerCoefficients = this.coefficients;\r\n\t\t\tvar largerCoefficients = other.coefficients;\r\n\t\t\tif (smallerCoefficients.length > largerCoefficients.length) {\r\n\t\t\t\tvar temp = smallerCoefficients;\r\n\t\t\t\tsmallerCoefficients = largerCoefficients;\r\n\t\t\t\tlargerCoefficients = temp;\r\n\t\t\t}\r\n\t\t\tvar sumDiff = new Array(largerCoefficients.length);\r\n\t\t\tvar lengthDiff = largerCoefficients.length - smallerCoefficients.length;\r\n\t\t\t// Copy high-order terms only found in higher-degree polynomial's coefficients\r\n\t\t\t//Array.Copy(largerCoefficients, 0, sumDiff, 0, lengthDiff);\r\n\t\t\tfor (var ci = 0; ci < lengthDiff; ci++)sumDiff[ci] = largerCoefficients[ci];\r\n\r\n\t\t\tfor (var i = lengthDiff; i < largerCoefficients.length; i++) {\r\n\t\t\t\tsumDiff[i] = GF256.addOrSubtract(smallerCoefficients[i - lengthDiff], largerCoefficients[i]);\r\n\t\t\t}\r\n\r\n\t\t\treturn new GF256Poly(field, sumDiff);\r\n\t\t}\r\n\t\tthis.multiply1 = function (other) {\r\n\t\t\tif (this.field != other.field) {\r\n\t\t\t\tthrow \"GF256Polys do not have same GF256 field\";\r\n\t\t\t}\r\n\t\t\tif (this.Zero || other.Zero) {\r\n\t\t\t\treturn this.field.Zero;\r\n\t\t\t}\r\n\t\t\tvar aCoefficients = this.coefficients;\r\n\t\t\tvar aLength = aCoefficients.length;\r\n\t\t\tvar bCoefficients = other.coefficients;\r\n\t\t\tvar bLength = bCoefficients.length;\r\n\t\t\tvar product = new Array(aLength + bLength - 1);\r\n\t\t\tfor (var i = 0; i < aLength; i++) {\r\n\t\t\t\tvar aCoeff = aCoefficients[i];\r\n\t\t\t\tfor (var j = 0; j < bLength; j++) {\r\n\t\t\t\t\tproduct[i + j] = GF256.addOrSubtract(product[i + j], this.field.multiply(aCoeff, bCoefficients[j]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn new GF256Poly(this.field, product);\r\n\t\t}\r\n\t\tthis.multiply2 = function (scalar) {\r\n\t\t\tif (scalar == 0) {\r\n\t\t\t\treturn this.field.Zero;\r\n\t\t\t}\r\n\t\t\tif (scalar == 1) {\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t\tvar size = this.coefficients.length;\r\n\t\t\tvar product = new Array(size);\r\n\t\t\tfor (var i = 0; i < size; i++) {\r\n\t\t\t\tproduct[i] = this.field.multiply(this.coefficients[i], scalar);\r\n\t\t\t}\r\n\t\t\treturn new GF256Poly(this.field, product);\r\n\t\t}\r\n\t\tthis.multiplyByMonomial = function (degree, coefficient) {\r\n\t\t\tif (degree < 0) {\r\n\t\t\t\tthrow \"System.ArgumentException\";\r\n\t\t\t}\r\n\t\t\tif (coefficient == 0) {\r\n\t\t\t\treturn this.field.Zero;\r\n\t\t\t}\r\n\t\t\tvar size = this.coefficients.length;\r\n\t\t\tvar product = new Array(size + degree);\r\n\t\t\tfor (var i = 0; i < product.length; i++)product[i] = 0;\r\n\t\t\tfor (var i = 0; i < size; i++) {\r\n\t\t\t\tproduct[i] = this.field.multiply(this.coefficients[i], coefficient);\r\n\t\t\t}\r\n\t\t\treturn new GF256Poly(this.field, product);\r\n\t\t}\r\n\t\tthis.divide = function (other) {\r\n\t\t\tif (this.field != other.field) {\r\n\t\t\t\tthrow \"GF256Polys do not have same GF256 field\";\r\n\t\t\t}\r\n\t\t\tif (other.Zero) {\r\n\t\t\t\tthrow \"Divide by 0\";\r\n\t\t\t}\r\n\r\n\t\t\tvar quotient = this.field.Zero;\r\n\t\t\tvar remainder = this;\r\n\r\n\t\t\tvar denominatorLeadingTerm = other.getCoefficient(other.Degree);\r\n\t\t\tvar inverseDenominatorLeadingTerm = this.field.inverse(denominatorLeadingTerm);\r\n\r\n\t\t\twhile (remainder.Degree >= other.Degree && !remainder.Zero) {\r\n\t\t\t\tvar degreeDifference = remainder.Degree - other.Degree;\r\n\t\t\t\tvar scale = this.field.multiply(remainder.getCoefficient(remainder.Degree), inverseDenominatorLeadingTerm);\r\n\t\t\t\tvar term = other.multiplyByMonomial(degreeDifference, scale);\r\n\t\t\t\tvar iterationQuotient = this.field.buildMonomial(degreeDifference, scale);\r\n\t\t\t\tquotient = quotient.addOrSubtract(iterationQuotient);\r\n\t\t\t\tremainder = remainder.addOrSubtract(term);\r\n\t\t\t}\r\n\r\n\t\t\treturn new Array(quotient, remainder);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\tfunction GF256(primitive) {\r\n\t\tthis.expTable = new Array(256);\r\n\t\tthis.logTable = new Array(256);\r\n\t\tvar x = 1;\r\n\t\tfor (var i = 0; i < 256; i++) {\r\n\t\t\tthis.expTable[i] = x;\r\n\t\t\tx <<= 1; // x = x * 2; we're assuming the generator alpha is 2\r\n\t\t\tif (x >= 0x100) {\r\n\t\t\t\tx ^= primitive;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < 255; i++) {\r\n\t\t\tthis.logTable[this.expTable[i]] = i;\r\n\t\t}\r\n\t\t// logTable[0] == 0 but this should never be used\r\n\t\tvar at0 = new Array(1); at0[0] = 0;\r\n\t\tthis.zero = new GF256Poly(this, new Array(at0));\r\n\t\tvar at1 = new Array(1); at1[0] = 1;\r\n\t\tthis.one = new GF256Poly(this, new Array(at1));\r\n\r\n\t\tthis.__defineGetter__(\"Zero\", function () {\r\n\t\t\treturn this.zero;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"One\", function () {\r\n\t\t\treturn this.one;\r\n\t\t});\r\n\t\tthis.buildMonomial = function (degree, coefficient) {\r\n\t\t\tif (degree < 0) {\r\n\t\t\t\tthrow \"System.ArgumentException\";\r\n\t\t\t}\r\n\t\t\tif (coefficient == 0) {\r\n\t\t\t\treturn this.zero;\r\n\t\t\t}\r\n\t\t\tvar coefficients = new Array(degree + 1);\r\n\t\t\tfor (var i = 0; i < coefficients.length; i++)coefficients[i] = 0;\r\n\t\t\tcoefficients[0] = coefficient;\r\n\t\t\treturn new GF256Poly(this, coefficients);\r\n\t\t}\r\n\t\tthis.exp = function (a) {\r\n\t\t\treturn this.expTable[a];\r\n\t\t}\r\n\t\tthis.log = function (a) {\r\n\t\t\tif (a == 0) {\r\n\t\t\t\tthrow \"System.ArgumentException\";\r\n\t\t\t}\r\n\t\t\treturn this.logTable[a];\r\n\t\t}\r\n\t\tthis.inverse = function (a) {\r\n\t\t\tif (a == 0) {\r\n\t\t\t\tthrow \"System.ArithmeticException\";\r\n\t\t\t}\r\n\t\t\treturn this.expTable[255 - this.logTable[a]];\r\n\t\t}\r\n\t\tthis.multiply = function (a, b) {\r\n\t\t\tif (a == 0 || b == 0) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tif (a == 1) {\r\n\t\t\t\treturn b;\r\n\t\t\t}\r\n\t\t\tif (b == 1) {\r\n\t\t\t\treturn a;\r\n\t\t\t}\r\n\t\t\treturn this.expTable[(this.logTable[a] + this.logTable[b]) % 255];\r\n\t\t}\r\n\t}\r\n\r\n\tGF256.QR_CODE_FIELD = new GF256(0x011D);\r\n\tGF256.DATA_MATRIX_FIELD = new GF256(0x012D);\r\n\r\n\tGF256.addOrSubtract = function (a, b) {\r\n\t\treturn a ^ b;\r\n\t}\r\n\r\n\r\n\tvar Decoder = {};\r\n\tDecoder.rsDecoder = new ReedSolomonDecoder(GF256.QR_CODE_FIELD);\r\n\r\n\tDecoder.correctErrors = function (codewordBytes, numDataCodewords) {\r\n\t\tvar numCodewords = codewordBytes.length;\r\n\t\t// First read into an array of ints\r\n\t\tvar codewordsInts = new Array(numCodewords);\r\n\t\tfor (var i = 0; i < numCodewords; i++) {\r\n\t\t\tcodewordsInts[i] = codewordBytes[i] & 0xFF;\r\n\t\t}\r\n\t\tvar numECCodewords = codewordBytes.length - numDataCodewords;\r\n\t\ttry {\r\n\t\t\tDecoder.rsDecoder.decode(codewordsInts, numECCodewords);\r\n\t\t\t//var corrector = new ReedSolomon(codewordsInts, numECCodewords);\r\n\t\t\t//corrector.correct();\r\n\t\t}\r\n\t\tcatch (rse) {\r\n\t\t\tthrow rse;\r\n\t\t}\r\n\t\t// Copy back into array of bytes -- only need to worry about the bytes that were data\r\n\t\t// We don't care about errors in the error-correction codewords\r\n\t\tfor (var i = 0; i < numDataCodewords; i++) {\r\n\t\t\tcodewordBytes[i] = codewordsInts[i];\r\n\t\t}\r\n\t}\r\n\r\n\tDecoder.decode = function (bits) {\r\n\t\tvar parser = new BitMatrixParser(bits);\r\n\t\tvar version = parser.readVersion();\r\n\t\tvar ecLevel = parser.readFormatInformation().ErrorCorrectionLevel;\r\n\r\n\t\t// Read codewords\r\n\t\tvar codewords = parser.readCodewords();\r\n\r\n\t\t// Separate into data blocks\r\n\t\tvar dataBlocks = DataBlock.getDataBlocks(codewords, version, ecLevel);\r\n\r\n\t\t// Count total number of data bytes\r\n\t\tvar totalBytes = 0;\r\n\t\tfor (var i = 0; i < dataBlocks.length; i++) {\r\n\t\t\ttotalBytes += dataBlocks[i].NumDataCodewords;\r\n\t\t}\r\n\t\tvar resultBytes = new Array(totalBytes);\r\n\t\tvar resultOffset = 0;\r\n\r\n\t\t// Error-correct and copy data blocks together into a stream of bytes\r\n\t\tfor (var j = 0; j < dataBlocks.length; j++) {\r\n\t\t\tvar dataBlock = dataBlocks[j];\r\n\t\t\tvar codewordBytes = dataBlock.Codewords;\r\n\t\t\tvar numDataCodewords = dataBlock.NumDataCodewords;\r\n\t\t\tDecoder.correctErrors(codewordBytes, numDataCodewords);\r\n\t\t\tfor (var i = 0; i < numDataCodewords; i++) {\r\n\t\t\t\tresultBytes[resultOffset++] = codewordBytes[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Decode the contents of that stream of bytes\r\n\t\tvar reader = new QRCodeDataBlockReader(resultBytes, version.VersionNumber, ecLevel.Bits);\r\n\t\treturn reader;\r\n\t\t//return DecodedBitStreamParser.decode(resultBytes, version, ecLevel);\r\n\t}\r\n\r\n\r\n\tvar qrcode = {};\r\n\tqrcode.imagedata = null;\r\n\tqrcode.width = 0;\r\n\tqrcode.height = 0;\r\n\tqrcode.qrCodeSymbol = null;\r\n\tqrcode.debug = false;\r\n\tqrcode.maxImgSize = 1024 * 1024;\r\n\r\n\tqrcode.sizeOfDataLengthInfo = [[10, 9, 8, 8], [12, 11, 16, 10], [14, 13, 16, 12]];\r\n\r\n\tqrcode.callback = null;\r\n\r\n\tqrcode.vidSuccess = function (stream) {\r\n\t\tqrcode.localstream = stream;\r\n\t\tif (qrcode.webkit)\r\n\t\t\tqrcode.video.src = window.webkitURL.createObjectURL(stream);\r\n\t\telse\r\n\t\t\tif (qrcode.moz) {\r\n\t\t\t\tqrcode.video.mozSrcObject = stream;\r\n\t\t\t\tqrcode.video.play();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tqrcode.video.src = stream;\r\n\r\n\t\tqrcode.gUM = true;\r\n\r\n\t\tqrcode.canvas_qr2 = document.createElement('canvas');\r\n\t\tqrcode.canvas_qr2.id = \"qr-canvas\";\r\n\t\tqrcode.qrcontext2 = qrcode.canvas_qr2.getContext('2d');\r\n\t\tqrcode.canvas_qr2.width = qrcode.video.videoWidth;\r\n\t\tqrcode.canvas_qr2.height = qrcode.video.videoHeight;\r\n\t\tsetTimeout(qrcode.captureToCanvas, 500);\r\n\t}\r\n\r\n\tqrcode.vidError = function (error) {\r\n\t\tqrcode.gUM = false;\r\n\t\treturn;\r\n\t}\r\n\r\n\tqrcode.captureToCanvas = function () {\r\n\t\tif (qrcode.gUM) {\r\n\t\t\ttry {\r\n\t\t\t\tif (qrcode.video.videoWidth == 0) {\r\n\t\t\t\t\tsetTimeout(qrcode.captureToCanvas, 500);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tqrcode.canvas_qr2.width = qrcode.video.videoWidth;\r\n\t\t\t\t\tqrcode.canvas_qr2.height = qrcode.video.videoHeight;\r\n\t\t\t\t}\r\n\t\t\t\tqrcode.qrcontext2.drawImage(qrcode.video, 0, 0);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tqrcode.decode();\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\tsetTimeout(qrcode.captureToCanvas, 500);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tcatch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t\tsetTimeout(qrcode.captureToCanvas, 500);\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tqrcode.setWebcam = function (videoId) {\r\n\t\tvar n = navigator;\r\n\t\tqrcode.video = document.getElementById(videoId);\r\n\r\n\t\tvar options = true;\r\n\t\tif (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\r\n\t\t\ttry {\r\n\t\t\t\tnavigator.mediaDevices.enumerateDevices()\r\n\t\t\t\t\t.then(function (devices) {\r\n\t\t\t\t\t\tdevices.forEach(function (device) {\r\n\t\t\t\t\t\t\tconsole.log(\"deb1\");\r\n\t\t\t\t\t\t\tif (device.kind === 'videoinput') {\r\n\t\t\t\t\t\t\t\tif (device.label.toLowerCase().search(\"back\") > -1)\r\n\t\t\t\t\t\t\t\t\toptions = [{ 'sourceId': device.deviceId }];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(device.kind + \": \" + device.label +\r\n\t\t\t\t\t\t\t\t\" id = \" + device.deviceId);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\r\n\t\t\t}\r\n\t\t\tcatch (e) {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.log(\"no navigator.mediaDevices.enumerateDevices\");\r\n\t\t}\r\n\r\n\t\tif (n.getUserMedia)\r\n\t\t\tn.getUserMedia({ video: options, audio: false }, qrcode.vidSuccess, qrcode.vidError);\r\n\t\telse\r\n\t\t\tif (n.webkitGetUserMedia) {\r\n\t\t\t\tqrcode.webkit = true;\r\n\t\t\t\tn.webkitGetUserMedia({ video: options, audio: false }, qrcode.vidSuccess, qrcode.vidError);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tif (n.mozGetUserMedia) {\r\n\t\t\t\t\tqrcode.moz = true;\r\n\t\t\t\t\tn.mozGetUserMedia({ video: options, audio: false }, qrcode.vidSuccess, qrcode.vidError);\r\n\t\t\t\t}\r\n\t}\r\n\r\n\tqrcode.decode = function (src) {\r\n\r\n\t\tif (arguments.length == 0) {\r\n\t\t\tif (qrcode.canvas_qr2) {\r\n\t\t\t\tvar canvas_qr = qrcode.canvas_qr2;\r\n\t\t\t\tvar context = qrcode.qrcontext2;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tvar canvas_qr = document.getElementById(\"qr-canvas\");\r\n\t\t\t\tvar context = canvas_qr.getContext('2d');\r\n\t\t\t}\r\n\t\t\tqrcode.width = canvas_qr.width;\r\n\t\t\tqrcode.height = canvas_qr.height;\r\n\t\t\tqrcode.imagedata = context.getImageData(0, 0, qrcode.width, qrcode.height);\r\n\t\t\tqrcode.result = qrcode.process(context);\r\n\t\t\tif (qrcode.callback != null)\r\n\t\t\t\tqrcode.callback(qrcode.result);\r\n\t\t\treturn qrcode.result;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tvar image = new Image();\r\n\t\t\timage.crossOrigin = \"Anonymous\";\r\n\t\t\timage.onload = function () {\r\n\t\t\t\t//var canvas_qr = document.getElementById(\"qr-canvas\");\r\n\t\t\t\tvar canvas_out = document.getElementById(\"out-canvas\");\r\n\t\t\t\tif (canvas_out != null) {\r\n\t\t\t\t\tvar outctx = canvas_out.getContext('2d');\r\n\t\t\t\t\toutctx.clearRect(0, 0, 320, 240);\r\n\t\t\t\t\toutctx.drawImage(image, 0, 0, 320, 240);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar canvas_qr = document.createElement('canvas');\r\n\t\t\t\tvar context = canvas_qr.getContext('2d');\r\n\t\t\t\tvar nheight = image.height;\r\n\t\t\t\tvar nwidth = image.width;\r\n\t\t\t\tif (image.width * image.height > qrcode.maxImgSize) {\r\n\t\t\t\t\tvar ir = image.width / image.height;\r\n\t\t\t\t\tnheight = Math.sqrt(qrcode.maxImgSize / ir);\r\n\t\t\t\t\tnwidth = ir * nheight;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcanvas_qr.width = nwidth;\r\n\t\t\t\tcanvas_qr.height = nheight;\r\n\r\n\t\t\t\tcontext.drawImage(image, 0, 0, canvas_qr.width, canvas_qr.height);\r\n\t\t\t\tqrcode.width = canvas_qr.width;\r\n\t\t\t\tqrcode.height = canvas_qr.height;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tqrcode.imagedata = context.getImageData(0, 0, canvas_qr.width, canvas_qr.height);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tqrcode.result = \"Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!\";\r\n\t\t\t\t\tif (qrcode.callback != null)\r\n\t\t\t\t\t\tqrcode.callback(qrcode.result);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tqrcode.result = qrcode.process(context);\r\n\t\t\t\t}\r\n\t\t\t\tcatch (e) {\r\n\t\t\t\t\tconsole.log(e);\r\n\t\t\t\t\tqrcode.result = \"error decoding QR Code\";\r\n\t\t\t\t}\r\n\t\t\t\tif (qrcode.callback != null)\r\n\t\t\t\t\tqrcode.callback(qrcode.result);\r\n\t\t\t}\r\n\t\t\timage.onerror = function () {\r\n\t\t\t\tif (qrcode.callback != null)\r\n\t\t\t\t\tqrcode.callback(\"Failed to load the image\");\r\n\t\t\t}\r\n\t\t\timage.src = src;\r\n\t\t}\r\n\t}\r\n\r\n\tqrcode.isUrl = function (s) {\r\n\t\tvar regexp = /(ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?/;\r\n\t\treturn regexp.test(s);\r\n\t}\r\n\r\n\tqrcode.decode_url = function (s) {\r\n\t\tvar escaped = \"\";\r\n\t\ttry {\r\n\t\t\tescaped = escape(s);\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tconsole.log(e);\r\n\t\t\tescaped = s;\r\n\t\t}\r\n\t\tvar ret = \"\";\r\n\t\ttry {\r\n\t\t\tret = decodeURIComponent(escaped);\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tconsole.log(e);\r\n\t\t\tret = escaped;\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tqrcode.decode_utf8 = function (s) {\r\n\t\tif (qrcode.isUrl(s))\r\n\t\t\treturn qrcode.decode_url(s);\r\n\t\telse\r\n\t\t\treturn s;\r\n\t}\r\n\r\n\tqrcode.process = function (ctx) {\r\n\r\n\t\tvar start = new Date().getTime();\r\n\r\n\t\tvar image = qrcode.grayScaleToBitmap(qrcode.grayscale());\r\n\t\t//var image = qrcode.binarize(128);\r\n\r\n\t\tif (qrcode.debug) {\r\n\t\t\tfor (var y = 0; y < qrcode.height; y++) {\r\n\t\t\t\tfor (var x = 0; x < qrcode.width; x++) {\r\n\t\t\t\t\tvar point = (x * 4) + (y * qrcode.width * 4);\r\n\t\t\t\t\tqrcode.imagedata.data[point] = image[x + y * qrcode.width] ? 0 : 0;\r\n\t\t\t\t\tqrcode.imagedata.data[point + 1] = image[x + y * qrcode.width] ? 0 : 0;\r\n\t\t\t\t\tqrcode.imagedata.data[point + 2] = image[x + y * qrcode.width] ? 255 : 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tctx.putImageData(qrcode.imagedata, 0, 0);\r\n\t\t}\r\n\r\n\t\t//var finderPatternInfo = new FinderPatternFinder().findFinderPattern(image);\r\n\r\n\t\tvar detector = new Detector(image);\r\n\r\n\t\tvar qRCodeMatrix = detector.detect();\r\n\r\n\t\tif (qrcode.debug) {\r\n\t\t\tfor (var y = 0; y < qRCodeMatrix.bits.Height; y++) {\r\n\t\t\t\tfor (var x = 0; x < qRCodeMatrix.bits.Width; x++) {\r\n\t\t\t\t\tvar point = (x * 4 * 2) + (y * 2 * qrcode.width * 4);\r\n\t\t\t\t\tqrcode.imagedata.data[point] = qRCodeMatrix.bits.get_Renamed(x, y) ? 0 : 0;\r\n\t\t\t\t\tqrcode.imagedata.data[point + 1] = qRCodeMatrix.bits.get_Renamed(x, y) ? 0 : 0;\r\n\t\t\t\t\tqrcode.imagedata.data[point + 2] = qRCodeMatrix.bits.get_Renamed(x, y) ? 255 : 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tctx.putImageData(qrcode.imagedata, 0, 0);\r\n\t\t}\r\n\r\n\r\n\t\tvar reader = Decoder.decode(qRCodeMatrix.bits);\r\n\t\tvar data = reader.DataByte;\r\n\t\tvar str = \"\";\r\n\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\tfor (var j = 0; j < data[i].length; j++)\r\n\t\t\t\tstr += String.fromCharCode(data[i][j]);\r\n\t\t}\r\n\r\n\t\tvar end = new Date().getTime();\r\n\t\tvar time = end - start;\r\n\t\tconsole.log(time);\r\n\r\n\t\treturn qrcode.decode_utf8(str);\r\n\t\t//alert(\"Time:\" + time + \" Code: \"+str);\r\n\t}\r\n\r\n\tqrcode.getPixel = function (x, y) {\r\n\t\tif (qrcode.width < x) {\r\n\t\t\tthrow \"point error\";\r\n\t\t}\r\n\t\tif (qrcode.height < y) {\r\n\t\t\tthrow \"point error\";\r\n\t\t}\r\n\t\tvar point = (x * 4) + (y * qrcode.width * 4);\r\n\t\tvar p = (qrcode.imagedata.data[point] * 33 + qrcode.imagedata.data[point + 1] * 34 + qrcode.imagedata.data[point + 2] * 33) / 100;\r\n\t\treturn p;\r\n\t}\r\n\r\n\tqrcode.binarize = function (th) {\r\n\t\tvar ret = new Array(qrcode.width * qrcode.height);\r\n\t\tfor (var y = 0; y < qrcode.height; y++) {\r\n\t\t\tfor (var x = 0; x < qrcode.width; x++) {\r\n\t\t\t\tvar gray = qrcode.getPixel(x, y);\r\n\r\n\t\t\t\tret[x + y * qrcode.width] = gray <= th ? true : false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tqrcode.getMiddleBrightnessPerArea = function (image) {\r\n\t\tvar numSqrtArea = 4;\r\n\t\t//obtain middle brightness((min + max) / 2) per area\r\n\t\tvar areaWidth = Math.floor(qrcode.width / numSqrtArea);\r\n\t\tvar areaHeight = Math.floor(qrcode.height / numSqrtArea);\r\n\t\tvar minmax = new Array(numSqrtArea);\r\n\t\tfor (var i = 0; i < numSqrtArea; i++) {\r\n\t\t\tminmax[i] = new Array(numSqrtArea);\r\n\t\t\tfor (var i2 = 0; i2 < numSqrtArea; i2++) {\r\n\t\t\t\tminmax[i][i2] = new Array(0, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var ay = 0; ay < numSqrtArea; ay++) {\r\n\t\t\tfor (var ax = 0; ax < numSqrtArea; ax++) {\r\n\t\t\t\tminmax[ax][ay][0] = 0xFF;\r\n\t\t\t\tfor (var dy = 0; dy < areaHeight; dy++) {\r\n\t\t\t\t\tfor (var dx = 0; dx < areaWidth; dx++) {\r\n\t\t\t\t\t\tvar target = image[areaWidth * ax + dx + (areaHeight * ay + dy) * qrcode.width];\r\n\t\t\t\t\t\tif (target < minmax[ax][ay][0])\r\n\t\t\t\t\t\t\tminmax[ax][ay][0] = target;\r\n\t\t\t\t\t\tif (target > minmax[ax][ay][1])\r\n\t\t\t\t\t\t\tminmax[ax][ay][1] = target;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//minmax[ax][ay][0] = (minmax[ax][ay][0] + minmax[ax][ay][1]) / 2;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar middle = new Array(numSqrtArea);\r\n\t\tfor (var i3 = 0; i3 < numSqrtArea; i3++) {\r\n\t\t\tmiddle[i3] = new Array(numSqrtArea);\r\n\t\t}\r\n\t\tfor (var ay = 0; ay < numSqrtArea; ay++) {\r\n\t\t\tfor (var ax = 0; ax < numSqrtArea; ax++) {\r\n\t\t\t\tmiddle[ax][ay] = Math.floor((minmax[ax][ay][0] + minmax[ax][ay][1]) / 2);\r\n\t\t\t\t//Console.out.print(middle[ax][ay] + \",\");\r\n\t\t\t}\r\n\t\t\t//Console.out.println(\"\");\r\n\t\t}\r\n\t\t//Console.out.println(\"\");\r\n\r\n\t\treturn middle;\r\n\t}\r\n\r\n\tqrcode.grayScaleToBitmap = function (grayScale) {\r\n\t\tvar middle = qrcode.getMiddleBrightnessPerArea(grayScale);\r\n\t\tvar sqrtNumArea = middle.length;\r\n\t\tvar areaWidth = Math.floor(qrcode.width / sqrtNumArea);\r\n\t\tvar areaHeight = Math.floor(qrcode.height / sqrtNumArea);\r\n\r\n\t\tvar buff = new ArrayBuffer(qrcode.width * qrcode.height);\r\n\t\tvar bitmap = new Uint8Array(buff);\r\n\r\n\t\t//var bitmap = new Array(qrcode.height*qrcode.width);\r\n\r\n\t\tfor (var ay = 0; ay < sqrtNumArea; ay++) {\r\n\t\t\tfor (var ax = 0; ax < sqrtNumArea; ax++) {\r\n\t\t\t\tfor (var dy = 0; dy < areaHeight; dy++) {\r\n\t\t\t\t\tfor (var dx = 0; dx < areaWidth; dx++) {\r\n\t\t\t\t\t\tbitmap[areaWidth * ax + dx + (areaHeight * ay + dy) * qrcode.width] = (grayScale[areaWidth * ax + dx + (areaHeight * ay + dy) * qrcode.width] < middle[ax][ay]) ? true : false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn bitmap;\r\n\t}\r\n\r\n\tqrcode.grayscale = function () {\r\n\t\tvar buff = new ArrayBuffer(qrcode.width * qrcode.height);\r\n\t\tvar ret = new Uint8Array(buff);\r\n\t\t//var ret = new Array(qrcode.width*qrcode.height);\r\n\r\n\t\tfor (var y = 0; y < qrcode.height; y++) {\r\n\t\t\tfor (var x = 0; x < qrcode.width; x++) {\r\n\t\t\t\tvar gray = qrcode.getPixel(x, y);\r\n\r\n\t\t\t\tret[x + y * qrcode.width] = gray;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\r\n\r\n\r\n\tfunction URShift(number, bits) {\r\n\t\tif (number >= 0)\r\n\t\t\treturn number >> bits;\r\n\t\telse\r\n\t\t\treturn (number >> bits) + (2 << ~bits);\r\n\t}\r\n\r\n\r\n\tvar MIN_SKIP = 3;\r\n\tvar MAX_MODULES = 57;\r\n\tvar INTEGER_MATH_SHIFT = 8;\r\n\tvar CENTER_QUORUM = 2;\r\n\r\n\tqrcode.orderBestPatterns = function (patterns) {\r\n\r\n\t\tfunction distance(pattern1, pattern2) {\r\n\t\t\tvar xDiff = pattern1.X - pattern2.X;\r\n\t\t\tvar yDiff = pattern1.Y - pattern2.Y;\r\n\t\t\treturn Math.sqrt((xDiff * xDiff + yDiff * yDiff));\r\n\t\t}\r\n\r\n\t\t/// <summary> Returns the z component of the cross product between vectors BC and BA.</summary>\r\n\t\tfunction crossProductZ(pointA, pointB, pointC) {\r\n\t\t\tvar bX = pointB.x;\r\n\t\t\tvar bY = pointB.y;\r\n\t\t\treturn ((pointC.x - bX) * (pointA.y - bY)) - ((pointC.y - bY) * (pointA.x - bX));\r\n\t\t}\r\n\r\n\r\n\t\t// Find distances between pattern centers\r\n\t\tvar zeroOneDistance = distance(patterns[0], patterns[1]);\r\n\t\tvar oneTwoDistance = distance(patterns[1], patterns[2]);\r\n\t\tvar zeroTwoDistance = distance(patterns[0], patterns[2]);\r\n\r\n\t\tvar pointA, pointB, pointC;\r\n\t\t// Assume one closest to other two is B; A and C will just be guesses at first\r\n\t\tif (oneTwoDistance >= zeroOneDistance && oneTwoDistance >= zeroTwoDistance) {\r\n\t\t\tpointB = patterns[0];\r\n\t\t\tpointA = patterns[1];\r\n\t\t\tpointC = patterns[2];\r\n\t\t}\r\n\t\telse if (zeroTwoDistance >= oneTwoDistance && zeroTwoDistance >= zeroOneDistance) {\r\n\t\t\tpointB = patterns[1];\r\n\t\t\tpointA = patterns[0];\r\n\t\t\tpointC = patterns[2];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpointB = patterns[2];\r\n\t\t\tpointA = patterns[0];\r\n\t\t\tpointC = patterns[1];\r\n\t\t}\r\n\r\n\t\t// Use cross product to figure out whether A and C are correct or flipped.\r\n\t\t// This asks whether BC x BA has a positive z component, which is the arrangement\r\n\t\t// we want for A, B, C. If it's negative, then we've got it flipped around and\r\n\t\t// should swap A and C.\r\n\t\tif (crossProductZ(pointA, pointB, pointC) < 0.0) {\r\n\t\t\tvar temp = pointA;\r\n\t\t\tpointA = pointC;\r\n\t\t\tpointC = temp;\r\n\t\t}\r\n\r\n\t\tpatterns[0] = pointA;\r\n\t\tpatterns[1] = pointB;\r\n\t\tpatterns[2] = pointC;\r\n\t}\r\n\r\n\r\n\tfunction FinderPattern(posX, posY, estimatedModuleSize) {\r\n\t\tthis.x = posX;\r\n\t\tthis.y = posY;\r\n\t\tthis.count = 1;\r\n\t\tthis.estimatedModuleSize = estimatedModuleSize;\r\n\r\n\t\tthis.__defineGetter__(\"EstimatedModuleSize\", function () {\r\n\t\t\treturn this.estimatedModuleSize;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Count\", function () {\r\n\t\t\treturn this.count;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"X\", function () {\r\n\t\t\treturn this.x;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Y\", function () {\r\n\t\t\treturn this.y;\r\n\t\t});\r\n\t\tthis.incrementCount = function () {\r\n\t\t\tthis.count++;\r\n\t\t}\r\n\t\tthis.aboutEquals = function (moduleSize, i, j) {\r\n\t\t\tif (Math.abs(i - this.y) <= moduleSize && Math.abs(j - this.x) <= moduleSize) {\r\n\t\t\t\tvar moduleSizeDiff = Math.abs(moduleSize - this.estimatedModuleSize);\r\n\t\t\t\treturn moduleSizeDiff <= 1.0 || moduleSizeDiff / this.estimatedModuleSize <= 1.0;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction FinderPatternInfo(patternCenters) {\r\n\t\tthis.bottomLeft = patternCenters[0];\r\n\t\tthis.topLeft = patternCenters[1];\r\n\t\tthis.topRight = patternCenters[2];\r\n\t\tthis.__defineGetter__(\"BottomLeft\", function () {\r\n\t\t\treturn this.bottomLeft;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"TopLeft\", function () {\r\n\t\t\treturn this.topLeft;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"TopRight\", function () {\r\n\t\t\treturn this.topRight;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction FinderPatternFinder() {\r\n\t\tthis.image = null;\r\n\t\tthis.possibleCenters = [];\r\n\t\tthis.hasSkipped = false;\r\n\t\tthis.crossCheckStateCount = new Array(0, 0, 0, 0, 0);\r\n\t\tthis.resultPointCallback = null;\r\n\r\n\t\tthis.__defineGetter__(\"CrossCheckStateCount\", function () {\r\n\t\t\tthis.crossCheckStateCount[0] = 0;\r\n\t\t\tthis.crossCheckStateCount[1] = 0;\r\n\t\t\tthis.crossCheckStateCount[2] = 0;\r\n\t\t\tthis.crossCheckStateCount[3] = 0;\r\n\t\t\tthis.crossCheckStateCount[4] = 0;\r\n\t\t\treturn this.crossCheckStateCount;\r\n\t\t});\r\n\r\n\t\tthis.foundPatternCross = function (stateCount) {\r\n\t\t\tvar totalModuleSize = 0;\r\n\t\t\tfor (var i = 0; i < 5; i++) {\r\n\t\t\t\tvar count = stateCount[i];\r\n\t\t\t\tif (count == 0) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\ttotalModuleSize += count;\r\n\t\t\t}\r\n\t\t\tif (totalModuleSize < 7) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tvar moduleSize = Math.floor((totalModuleSize << INTEGER_MATH_SHIFT) / 7);\r\n\t\t\tvar maxVariance = Math.floor(moduleSize / 2);\r\n\t\t\t// Allow less than 50% variance from 1-1-3-1-1 proportions\r\n\t\t\treturn Math.abs(moduleSize - (stateCount[0] << INTEGER_MATH_SHIFT)) < maxVariance && Math.abs(moduleSize - (stateCount[1] << INTEGER_MATH_SHIFT)) < maxVariance && Math.abs(3 * moduleSize - (stateCount[2] << INTEGER_MATH_SHIFT)) < 3 * maxVariance && Math.abs(moduleSize - (stateCount[3] << INTEGER_MATH_SHIFT)) < maxVariance && Math.abs(moduleSize - (stateCount[4] << INTEGER_MATH_SHIFT)) < maxVariance;\r\n\t\t}\r\n\t\tthis.centerFromEnd = function (stateCount, end) {\r\n\t\t\treturn (end - stateCount[4] - stateCount[3]) - stateCount[2] / 2.0;\r\n\t\t}\r\n\t\tthis.crossCheckVertical = function (startI, centerJ, maxCount, originalStateCountTotal) {\r\n\t\t\tvar image = this.image;\r\n\r\n\t\t\tvar maxI = qrcode.height;\r\n\t\t\tvar stateCount = this.CrossCheckStateCount;\r\n\r\n\t\t\t// Start counting up from center\r\n\t\t\tvar i = startI;\r\n\t\t\twhile (i >= 0 && image[centerJ + i * qrcode.width]) {\r\n\t\t\t\tstateCount[2]++;\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t\tif (i < 0) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (i >= 0 && !image[centerJ + i * qrcode.width] && stateCount[1] <= maxCount) {\r\n\t\t\t\tstateCount[1]++;\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t\t// If already too many modules in this state or ran off the edge:\r\n\t\t\tif (i < 0 || stateCount[1] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (i >= 0 && image[centerJ + i * qrcode.width] && stateCount[0] <= maxCount) {\r\n\t\t\t\tstateCount[0]++;\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t\tif (stateCount[0] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\t// Now also count down from center\r\n\t\t\ti = startI + 1;\r\n\t\t\twhile (i < maxI && image[centerJ + i * qrcode.width]) {\r\n\t\t\t\tstateCount[2]++;\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i == maxI) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (i < maxI && !image[centerJ + i * qrcode.width] && stateCount[3] < maxCount) {\r\n\t\t\t\tstateCount[3]++;\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i == maxI || stateCount[3] >= maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (i < maxI && image[centerJ + i * qrcode.width] && stateCount[4] < maxCount) {\r\n\t\t\t\tstateCount[4]++;\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (stateCount[4] >= maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\t// If we found a finder-pattern-like section, but its size is more than 40% different than\r\n\t\t\t// the original, assume it's a false positive\r\n\t\t\tvar stateCountTotal = stateCount[0] + stateCount[1] + stateCount[2] + stateCount[3] + stateCount[4];\r\n\t\t\tif (5 * Math.abs(stateCountTotal - originalStateCountTotal) >= 2 * originalStateCountTotal) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.foundPatternCross(stateCount) ? this.centerFromEnd(stateCount, i) : NaN;\r\n\t\t}\r\n\t\tthis.crossCheckHorizontal = function (startJ, centerI, maxCount, originalStateCountTotal) {\r\n\t\t\tvar image = this.image;\r\n\r\n\t\t\tvar maxJ = qrcode.width;\r\n\t\t\tvar stateCount = this.CrossCheckStateCount;\r\n\r\n\t\t\tvar j = startJ;\r\n\t\t\twhile (j >= 0 && image[j + centerI * qrcode.width]) {\r\n\t\t\t\tstateCount[2]++;\r\n\t\t\t\tj--;\r\n\t\t\t}\r\n\t\t\tif (j < 0) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (j >= 0 && !image[j + centerI * qrcode.width] && stateCount[1] <= maxCount) {\r\n\t\t\t\tstateCount[1]++;\r\n\t\t\t\tj--;\r\n\t\t\t}\r\n\t\t\tif (j < 0 || stateCount[1] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (j >= 0 && image[j + centerI * qrcode.width] && stateCount[0] <= maxCount) {\r\n\t\t\t\tstateCount[0]++;\r\n\t\t\t\tj--;\r\n\t\t\t}\r\n\t\t\tif (stateCount[0] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\tj = startJ + 1;\r\n\t\t\twhile (j < maxJ && image[j + centerI * qrcode.width]) {\r\n\t\t\t\tstateCount[2]++;\r\n\t\t\t\tj++;\r\n\t\t\t}\r\n\t\t\tif (j == maxJ) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (j < maxJ && !image[j + centerI * qrcode.width] && stateCount[3] < maxCount) {\r\n\t\t\t\tstateCount[3]++;\r\n\t\t\t\tj++;\r\n\t\t\t}\r\n\t\t\tif (j == maxJ || stateCount[3] >= maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (j < maxJ && image[j + centerI * qrcode.width] && stateCount[4] < maxCount) {\r\n\t\t\t\tstateCount[4]++;\r\n\t\t\t\tj++;\r\n\t\t\t}\r\n\t\t\tif (stateCount[4] >= maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\t// If we found a finder-pattern-like section, but its size is significantly different than\r\n\t\t\t// the original, assume it's a false positive\r\n\t\t\tvar stateCountTotal = stateCount[0] + stateCount[1] + stateCount[2] + stateCount[3] + stateCount[4];\r\n\t\t\tif (5 * Math.abs(stateCountTotal - originalStateCountTotal) >= originalStateCountTotal) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.foundPatternCross(stateCount) ? this.centerFromEnd(stateCount, j) : NaN;\r\n\t\t}\r\n\t\tthis.handlePossibleCenter = function (stateCount, i, j) {\r\n\t\t\tvar stateCountTotal = stateCount[0] + stateCount[1] + stateCount[2] + stateCount[3] + stateCount[4];\r\n\t\t\tvar centerJ = this.centerFromEnd(stateCount, j); //float\r\n\t\t\tvar centerI = this.crossCheckVertical(i, Math.floor(centerJ), stateCount[2], stateCountTotal); //float\r\n\t\t\tif (!isNaN(centerI)) {\r\n\t\t\t\t// Re-cross check\r\n\t\t\t\tcenterJ = this.crossCheckHorizontal(Math.floor(centerJ), Math.floor(centerI), stateCount[2], stateCountTotal);\r\n\t\t\t\tif (!isNaN(centerJ)) {\r\n\t\t\t\t\tvar estimatedModuleSize = stateCountTotal / 7.0;\r\n\t\t\t\t\tvar found = false;\r\n\t\t\t\t\tvar max = this.possibleCenters.length;\r\n\t\t\t\t\tfor (var index = 0; index < max; index++) {\r\n\t\t\t\t\t\tvar center = this.possibleCenters[index];\r\n\t\t\t\t\t\t// Look for about the same center and module size:\r\n\t\t\t\t\t\tif (center.aboutEquals(estimatedModuleSize, centerI, centerJ)) {\r\n\t\t\t\t\t\t\tcenter.incrementCount();\r\n\t\t\t\t\t\t\tfound = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\tvar point = new FinderPattern(centerJ, centerI, estimatedModuleSize);\r\n\t\t\t\t\t\tthis.possibleCenters.push(point);\r\n\t\t\t\t\t\tif (this.resultPointCallback != null) {\r\n\t\t\t\t\t\t\tthis.resultPointCallback.foundPossibleResultPoint(point);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.selectBestPatterns = function () {\r\n\r\n\t\t\tvar startSize = this.possibleCenters.length;\r\n\t\t\tif (startSize < 3) {\r\n\t\t\t\t// Couldn't find enough finder patterns\r\n\t\t\t\tthrow \"Couldn't find enough finder patterns (found \" + startSize + \")\"\r\n\t\t\t}\r\n\r\n\t\t\t// Filter outlier possibilities whose module size is too different\r\n\t\t\tif (startSize > 3) {\r\n\t\t\t\t// But we can only afford to do so if we have at least 4 possibilities to choose from\r\n\t\t\t\tvar totalModuleSize = 0.0;\r\n\t\t\t\tvar square = 0.0;\r\n\t\t\t\tfor (var i = 0; i < startSize; i++) {\r\n\t\t\t\t\t//totalModuleSize +=  this.possibleCenters[i].EstimatedModuleSize;\r\n\t\t\t\t\tvar centerValue = this.possibleCenters[i].EstimatedModuleSize;\r\n\t\t\t\t\ttotalModuleSize += centerValue;\r\n\t\t\t\t\tsquare += (centerValue * centerValue);\r\n\t\t\t\t}\r\n\t\t\t\tvar average = totalModuleSize / startSize;\r\n\t\t\t\tthis.possibleCenters.sort(function (center1, center2) {\r\n\t\t\t\t\tvar dA = Math.abs(center2.EstimatedModuleSize - average);\r\n\t\t\t\t\tvar dB = Math.abs(center1.EstimatedModuleSize - average);\r\n\t\t\t\t\tif (dA < dB) {\r\n\t\t\t\t\t\treturn (-1);\r\n\t\t\t\t\t} else if (dA == dB) {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar stdDev = Math.sqrt(square / startSize - average * average);\r\n\t\t\t\tvar limit = Math.max(0.2 * average, stdDev);\r\n\t\t\t\t//for (var i = 0; i < this.possibleCenters.length && this.possibleCenters.length > 3; i++)\r\n\t\t\t\tfor (var i = this.possibleCenters.length - 1; i >= 0; i--) {\r\n\t\t\t\t\tvar pattern = this.possibleCenters[i];\r\n\t\t\t\t\t//if (Math.abs(pattern.EstimatedModuleSize - average) > 0.2 * average)\r\n\t\t\t\t\tif (Math.abs(pattern.EstimatedModuleSize - average) > limit) {\r\n\t\t\t\t\t\t//this.possibleCenters.remove(i);\r\n\t\t\t\t\t\tthis.possibleCenters.splice(i, 1);\r\n\t\t\t\t\t\t//i--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this.possibleCenters.length > 3) {\r\n\t\t\t\t// Throw away all but those first size candidate points we found.\r\n\t\t\t\tthis.possibleCenters.sort(function (a, b) {\r\n\t\t\t\t\tif (a.count > b.count) { return -1; }\r\n\t\t\t\t\tif (a.count < b.count) { return 1; }\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn new Array(this.possibleCenters[0], this.possibleCenters[1], this.possibleCenters[2]);\r\n\t\t}\r\n\r\n\t\tthis.findRowSkip = function () {\r\n\t\t\tvar max = this.possibleCenters.length;\r\n\t\t\tif (max <= 1) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tvar firstConfirmedCenter = null;\r\n\t\t\tfor (var i = 0; i < max; i++) {\r\n\t\t\t\tvar center = this.possibleCenters[i];\r\n\t\t\t\tif (center.Count >= CENTER_QUORUM) {\r\n\t\t\t\t\tif (firstConfirmedCenter == null) {\r\n\t\t\t\t\t\tfirstConfirmedCenter = center;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// We have two confirmed centers\r\n\t\t\t\t\t\t// How far down can we skip before resuming looking for the next\r\n\t\t\t\t\t\t// pattern? In the worst case, only the difference between the\r\n\t\t\t\t\t\t// difference in the x / y coordinates of the two centers.\r\n\t\t\t\t\t\t// This is the case where you find top left last.\r\n\t\t\t\t\t\tthis.hasSkipped = true;\r\n\t\t\t\t\t\treturn Math.floor((Math.abs(firstConfirmedCenter.X - center.X) - Math.abs(firstConfirmedCenter.Y - center.Y)) / 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tthis.haveMultiplyConfirmedCenters = function () {\r\n\t\t\tvar confirmedCount = 0;\r\n\t\t\tvar totalModuleSize = 0.0;\r\n\t\t\tvar max = this.possibleCenters.length;\r\n\t\t\tfor (var i = 0; i < max; i++) {\r\n\t\t\t\tvar pattern = this.possibleCenters[i];\r\n\t\t\t\tif (pattern.Count >= CENTER_QUORUM) {\r\n\t\t\t\t\tconfirmedCount++;\r\n\t\t\t\t\ttotalModuleSize += pattern.EstimatedModuleSize;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (confirmedCount < 3) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t// OK, we have at least 3 confirmed centers, but, it's possible that one is a \"false positive\"\r\n\t\t\t// and that we need to keep looking. We detect this by asking if the estimated module sizes\r\n\t\t\t// vary too much. We arbitrarily say that when the total deviation from average exceeds\r\n\t\t\t// 5% of the total module size estimates, it's too much.\r\n\t\t\tvar average = totalModuleSize / max;\r\n\t\t\tvar totalDeviation = 0.0;\r\n\t\t\tfor (var i = 0; i < max; i++) {\r\n\t\t\t\tpattern = this.possibleCenters[i];\r\n\t\t\t\ttotalDeviation += Math.abs(pattern.EstimatedModuleSize - average);\r\n\t\t\t}\r\n\t\t\treturn totalDeviation <= 0.05 * totalModuleSize;\r\n\t\t}\r\n\r\n\t\tthis.findFinderPattern = function (image) {\r\n\t\t\tvar tryHarder = false;\r\n\t\t\tthis.image = image;\r\n\t\t\tvar maxI = qrcode.height;\r\n\t\t\tvar maxJ = qrcode.width;\r\n\t\t\tvar iSkip = Math.floor((3 * maxI) / (4 * MAX_MODULES));\r\n\t\t\tif (iSkip < MIN_SKIP || tryHarder) {\r\n\t\t\t\tiSkip = MIN_SKIP;\r\n\t\t\t}\r\n\r\n\t\t\tvar done = false;\r\n\t\t\tvar stateCount = new Array(5);\r\n\t\t\tfor (var i = iSkip - 1; i < maxI && !done; i += iSkip) {\r\n\t\t\t\t// Get a row of black/white values\r\n\t\t\t\tstateCount[0] = 0;\r\n\t\t\t\tstateCount[1] = 0;\r\n\t\t\t\tstateCount[2] = 0;\r\n\t\t\t\tstateCount[3] = 0;\r\n\t\t\t\tstateCount[4] = 0;\r\n\t\t\t\tvar currentState = 0;\r\n\t\t\t\tfor (var j = 0; j < maxJ; j++) {\r\n\t\t\t\t\tif (image[j + i * qrcode.width]) {\r\n\t\t\t\t\t\t// Black pixel\r\n\t\t\t\t\t\tif ((currentState & 1) == 1) {\r\n\t\t\t\t\t\t\t// Counting white pixels\r\n\t\t\t\t\t\t\tcurrentState++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstateCount[currentState]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// White pixel\r\n\t\t\t\t\t\tif ((currentState & 1) == 0) {\r\n\t\t\t\t\t\t\t// Counting black pixels\r\n\t\t\t\t\t\t\tif (currentState == 4) {\r\n\t\t\t\t\t\t\t\t// A winner?\r\n\t\t\t\t\t\t\t\tif (this.foundPatternCross(stateCount)) {\r\n\t\t\t\t\t\t\t\t\t// Yes\r\n\t\t\t\t\t\t\t\t\tvar confirmed = this.handlePossibleCenter(stateCount, i, j);\r\n\t\t\t\t\t\t\t\t\tif (confirmed) {\r\n\t\t\t\t\t\t\t\t\t\t// Start examining every other line. Checking each line turned out to be too\r\n\t\t\t\t\t\t\t\t\t\t// expensive and didn't improve performance.\r\n\t\t\t\t\t\t\t\t\t\tiSkip = 2;\r\n\t\t\t\t\t\t\t\t\t\tif (this.hasSkipped) {\r\n\t\t\t\t\t\t\t\t\t\t\tdone = this.haveMultiplyConfirmedCenters();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tvar rowSkip = this.findRowSkip();\r\n\t\t\t\t\t\t\t\t\t\t\tif (rowSkip > stateCount[2]) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Skip rows between row of lower confirmed center\r\n\t\t\t\t\t\t\t\t\t\t\t\t// and top of presumed third confirmed center\r\n\t\t\t\t\t\t\t\t\t\t\t\t// but back up a bit to get a full chance of detecting\r\n\t\t\t\t\t\t\t\t\t\t\t\t// it, entire width of center of finder pattern\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t// Skip by rowSkip, but back off by stateCount[2] (size of last center\r\n\t\t\t\t\t\t\t\t\t\t\t\t// of pattern we saw) to be conservative, and also back off by iSkip which\r\n\t\t\t\t\t\t\t\t\t\t\t\t// is about to be re-added\r\n\t\t\t\t\t\t\t\t\t\t\t\ti += rowSkip - stateCount[2] - iSkip;\r\n\t\t\t\t\t\t\t\t\t\t\t\tj = maxJ - 1;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t// Advance to next black pixel\r\n\t\t\t\t\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\twhile (j < maxJ && !image[j + i * qrcode.width]);\r\n\t\t\t\t\t\t\t\t\t\tj--; // back up to that last white pixel\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// Clear state to start looking again\r\n\t\t\t\t\t\t\t\t\tcurrentState = 0;\r\n\t\t\t\t\t\t\t\t\tstateCount[0] = 0;\r\n\t\t\t\t\t\t\t\t\tstateCount[1] = 0;\r\n\t\t\t\t\t\t\t\t\tstateCount[2] = 0;\r\n\t\t\t\t\t\t\t\t\tstateCount[3] = 0;\r\n\t\t\t\t\t\t\t\t\tstateCount[4] = 0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t// No, shift counts back by two\r\n\t\t\t\t\t\t\t\t\tstateCount[0] = stateCount[2];\r\n\t\t\t\t\t\t\t\t\tstateCount[1] = stateCount[3];\r\n\t\t\t\t\t\t\t\t\tstateCount[2] = stateCount[4];\r\n\t\t\t\t\t\t\t\t\tstateCount[3] = 1;\r\n\t\t\t\t\t\t\t\t\tstateCount[4] = 0;\r\n\t\t\t\t\t\t\t\t\tcurrentState = 3;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tstateCount[++currentState]++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t// Counting white pixels\r\n\t\t\t\t\t\t\tstateCount[currentState]++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.foundPatternCross(stateCount)) {\r\n\t\t\t\t\tvar confirmed = this.handlePossibleCenter(stateCount, i, maxJ);\r\n\t\t\t\t\tif (confirmed) {\r\n\t\t\t\t\t\tiSkip = stateCount[0];\r\n\t\t\t\t\t\tif (this.hasSkipped) {\r\n\t\t\t\t\t\t\t// Found a third one\r\n\t\t\t\t\t\t\tdone = this.haveMultiplyConfirmedCenters();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar patternInfo = this.selectBestPatterns();\r\n\t\t\tqrcode.orderBestPatterns(patternInfo);\r\n\r\n\t\t\treturn new FinderPatternInfo(patternInfo);\r\n\t\t};\r\n\t}\r\n\r\n\r\n\tfunction AlignmentPattern(posX, posY, estimatedModuleSize) {\r\n\t\tthis.x = posX;\r\n\t\tthis.y = posY;\r\n\t\tthis.count = 1;\r\n\t\tthis.estimatedModuleSize = estimatedModuleSize;\r\n\r\n\t\tthis.__defineGetter__(\"EstimatedModuleSize\", function () {\r\n\t\t\treturn this.estimatedModuleSize;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Count\", function () {\r\n\t\t\treturn this.count;\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"X\", function () {\r\n\t\t\treturn Math.floor(this.x);\r\n\t\t});\r\n\t\tthis.__defineGetter__(\"Y\", function () {\r\n\t\t\treturn Math.floor(this.y);\r\n\t\t});\r\n\t\tthis.incrementCount = function () {\r\n\t\t\tthis.count++;\r\n\t\t}\r\n\t\tthis.aboutEquals = function (moduleSize, i, j) {\r\n\t\t\tif (Math.abs(i - this.y) <= moduleSize && Math.abs(j - this.x) <= moduleSize) {\r\n\t\t\t\tvar moduleSizeDiff = Math.abs(moduleSize - this.estimatedModuleSize);\r\n\t\t\t\treturn moduleSizeDiff <= 1.0 || moduleSizeDiff / this.estimatedModuleSize <= 1.0;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction AlignmentPatternFinder(image, startX, startY, width, height, moduleSize, resultPointCallback) {\r\n\t\tthis.image = image;\r\n\t\tthis.possibleCenters = new Array();\r\n\t\tthis.startX = startX;\r\n\t\tthis.startY = startY;\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\t\tthis.moduleSize = moduleSize;\r\n\t\tthis.crossCheckStateCount = new Array(0, 0, 0);\r\n\t\tthis.resultPointCallback = resultPointCallback;\r\n\r\n\t\tthis.centerFromEnd = function (stateCount, end) {\r\n\t\t\treturn (end - stateCount[2]) - stateCount[1] / 2.0;\r\n\t\t}\r\n\t\tthis.foundPatternCross = function (stateCount) {\r\n\t\t\tvar moduleSize = this.moduleSize;\r\n\t\t\tvar maxVariance = moduleSize / 2.0;\r\n\t\t\tfor (var i = 0; i < 3; i++) {\r\n\t\t\t\tif (Math.abs(moduleSize - stateCount[i]) >= maxVariance) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tthis.crossCheckVertical = function (startI, centerJ, maxCount, originalStateCountTotal) {\r\n\t\t\tvar image = this.image;\r\n\r\n\t\t\tvar maxI = qrcode.height;\r\n\t\t\tvar stateCount = this.crossCheckStateCount;\r\n\t\t\tstateCount[0] = 0;\r\n\t\t\tstateCount[1] = 0;\r\n\t\t\tstateCount[2] = 0;\r\n\r\n\t\t\t// Start counting up from center\r\n\t\t\tvar i = startI;\r\n\t\t\twhile (i >= 0 && image[centerJ + i * qrcode.width] && stateCount[1] <= maxCount) {\r\n\t\t\t\tstateCount[1]++;\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t\t// If already too many modules in this state or ran off the edge:\r\n\t\t\tif (i < 0 || stateCount[1] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (i >= 0 && !image[centerJ + i * qrcode.width] && stateCount[0] <= maxCount) {\r\n\t\t\t\tstateCount[0]++;\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t\tif (stateCount[0] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\t// Now also count down from center\r\n\t\t\ti = startI + 1;\r\n\t\t\twhile (i < maxI && image[centerJ + i * qrcode.width] && stateCount[1] <= maxCount) {\r\n\t\t\t\tstateCount[1]++;\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (i == maxI || stateCount[1] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\t\t\twhile (i < maxI && !image[centerJ + i * qrcode.width] && stateCount[2] <= maxCount) {\r\n\t\t\t\tstateCount[2]++;\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tif (stateCount[2] > maxCount) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\tvar stateCountTotal = stateCount[0] + stateCount[1] + stateCount[2];\r\n\t\t\tif (5 * Math.abs(stateCountTotal - originalStateCountTotal) >= 2 * originalStateCountTotal) {\r\n\t\t\t\treturn NaN;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.foundPatternCross(stateCount) ? this.centerFromEnd(stateCount, i) : NaN;\r\n\t\t}\r\n\r\n\t\tthis.handlePossibleCenter = function (stateCount, i, j) {\r\n\t\t\tvar stateCountTotal = stateCount[0] + stateCount[1] + stateCount[2];\r\n\t\t\tvar centerJ = this.centerFromEnd(stateCount, j);\r\n\t\t\tvar centerI = this.crossCheckVertical(i, Math.floor(centerJ), 2 * stateCount[1], stateCountTotal);\r\n\t\t\tif (!isNaN(centerI)) {\r\n\t\t\t\tvar estimatedModuleSize = (stateCount[0] + stateCount[1] + stateCount[2]) / 3.0;\r\n\t\t\t\tvar max = this.possibleCenters.length;\r\n\t\t\t\tfor (var index = 0; index < max; index++) {\r\n\t\t\t\t\tvar center = this.possibleCenters[index];\r\n\t\t\t\t\t// Look for about the same center and module size:\r\n\t\t\t\t\tif (center.aboutEquals(estimatedModuleSize, centerI, centerJ)) {\r\n\t\t\t\t\t\treturn new AlignmentPattern(centerJ, centerI, estimatedModuleSize);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Hadn't found this before; save it\r\n\t\t\t\tvar point = new AlignmentPattern(centerJ, centerI, estimatedModuleSize);\r\n\t\t\t\tthis.possibleCenters.push(point);\r\n\t\t\t\tif (this.resultPointCallback != null) {\r\n\t\t\t\t\tthis.resultPointCallback.foundPossibleResultPoint(point);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tthis.find = function () {\r\n\t\t\tvar startX = this.startX;\r\n\t\t\tvar height = this.height;\r\n\t\t\tvar maxJ = startX + width;\r\n\t\t\tvar middleI = startY + (height >> 1);\r\n\t\t\t// We are looking for black/white/black modules in 1:1:1 ratio;\r\n\t\t\t// this tracks the number of black/white/black modules seen so far\r\n\t\t\tvar stateCount = new Array(0, 0, 0);\r\n\t\t\tfor (var iGen = 0; iGen < height; iGen++) {\r\n\t\t\t\t// Search from middle outwards\r\n\t\t\t\tvar i = middleI + ((iGen & 0x01) == 0 ? ((iGen + 1) >> 1) : - ((iGen + 1) >> 1));\r\n\t\t\t\tstateCount[0] = 0;\r\n\t\t\t\tstateCount[1] = 0;\r\n\t\t\t\tstateCount[2] = 0;\r\n\t\t\t\tvar j = startX;\r\n\t\t\t\t// Burn off leading white pixels before anything else; if we start in the middle of\r\n\t\t\t\t// a white run, it doesn't make sense to count its length, since we don't know if the\r\n\t\t\t\t// white run continued to the left of the start point\r\n\t\t\t\twhile (j < maxJ && !image[j + qrcode.width * i]) {\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t\tvar currentState = 0;\r\n\t\t\t\twhile (j < maxJ) {\r\n\t\t\t\t\tif (image[j + i * qrcode.width]) {\r\n\t\t\t\t\t\t// Black pixel\r\n\t\t\t\t\t\tif (currentState == 1) {\r\n\t\t\t\t\t\t\t// Counting black pixels\r\n\t\t\t\t\t\t\tstateCount[currentState]++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t// Counting white pixels\r\n\t\t\t\t\t\t\tif (currentState == 2) {\r\n\t\t\t\t\t\t\t\t// A winner?\r\n\t\t\t\t\t\t\t\tif (this.foundPatternCross(stateCount)) {\r\n\t\t\t\t\t\t\t\t\t// Yes\r\n\t\t\t\t\t\t\t\t\tvar confirmed = this.handlePossibleCenter(stateCount, i, j);\r\n\t\t\t\t\t\t\t\t\tif (confirmed != null) {\r\n\t\t\t\t\t\t\t\t\t\treturn confirmed;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tstateCount[0] = stateCount[2];\r\n\t\t\t\t\t\t\t\tstateCount[1] = 1;\r\n\t\t\t\t\t\t\t\tstateCount[2] = 0;\r\n\t\t\t\t\t\t\t\tcurrentState = 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tstateCount[++currentState]++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// White pixel\r\n\t\t\t\t\t\tif (currentState == 1) {\r\n\t\t\t\t\t\t\t// Counting black pixels\r\n\t\t\t\t\t\t\tcurrentState++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstateCount[currentState]++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.foundPatternCross(stateCount)) {\r\n\t\t\t\t\tvar confirmed = this.handlePossibleCenter(stateCount, i, maxJ);\r\n\t\t\t\t\tif (confirmed != null) {\r\n\t\t\t\t\t\treturn confirmed;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Hmm, nothing we saw was observed and confirmed twice. If we had\r\n\t\t\t// any guess at all, return it.\r\n\t\t\tif (!(this.possibleCenters.length == 0)) {\r\n\t\t\t\treturn this.possibleCenters[0];\r\n\t\t\t}\r\n\r\n\t\t\tthrow \"Couldn't find enough alignment patterns\";\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction QRCodeDataBlockReader(blocks, version, numErrorCorrectionCode) {\r\n\t\tthis.blockPointer = 0;\r\n\t\tthis.bitPointer = 7;\r\n\t\tthis.dataLength = 0;\r\n\t\tthis.blocks = blocks;\r\n\t\tthis.numErrorCorrectionCode = numErrorCorrectionCode;\r\n\t\tif (version <= 9)\r\n\t\t\tthis.dataLengthMode = 0;\r\n\t\telse if (version >= 10 && version <= 26)\r\n\t\t\tthis.dataLengthMode = 1;\r\n\t\telse if (version >= 27 && version <= 40)\r\n\t\t\tthis.dataLengthMode = 2;\r\n\r\n\t\tthis.getNextBits = function (numBits) {\r\n\t\t\tvar bits = 0;\r\n\t\t\tif (numBits < this.bitPointer + 1) {\r\n\t\t\t\t// next word fits into current data block\r\n\t\t\t\tvar mask = 0;\r\n\t\t\t\tfor (var i = 0; i < numBits; i++) {\r\n\t\t\t\t\tmask += (1 << i);\r\n\t\t\t\t}\r\n\t\t\t\tmask <<= (this.bitPointer - numBits + 1);\r\n\r\n\t\t\t\tbits = (this.blocks[this.blockPointer] & mask) >> (this.bitPointer - numBits + 1);\r\n\t\t\t\tthis.bitPointer -= numBits;\r\n\t\t\t\treturn bits;\r\n\t\t\t}\r\n\t\t\telse if (numBits < this.bitPointer + 1 + 8) {\r\n\t\t\t\t// next word crosses 2 data blocks\r\n\t\t\t\tvar mask1 = 0;\r\n\t\t\t\tfor (var i = 0; i < this.bitPointer + 1; i++) {\r\n\t\t\t\t\tmask1 += (1 << i);\r\n\t\t\t\t}\r\n\t\t\t\tbits = (this.blocks[this.blockPointer] & mask1) << (numBits - (this.bitPointer + 1));\r\n\t\t\t\tthis.blockPointer++;\r\n\t\t\t\tbits += ((this.blocks[this.blockPointer]) >> (8 - (numBits - (this.bitPointer + 1))));\r\n\r\n\t\t\t\tthis.bitPointer = this.bitPointer - numBits % 8;\r\n\t\t\t\tif (this.bitPointer < 0) {\r\n\t\t\t\t\tthis.bitPointer = 8 + this.bitPointer;\r\n\t\t\t\t}\r\n\t\t\t\treturn bits;\r\n\t\t\t}\r\n\t\t\telse if (numBits < this.bitPointer + 1 + 16) {\r\n\t\t\t\t// next word crosses 3 data blocks\r\n\t\t\t\tvar mask1 = 0; // mask of first block\r\n\t\t\t\tvar mask3 = 0; // mask of 3rd block\r\n\t\t\t\t//bitPointer + 1 : number of bits of the 1st block\r\n\t\t\t\t//8 : number of the 2nd block (note that use already 8bits because next word uses 3 data blocks)\r\n\t\t\t\t//numBits - (bitPointer + 1 + 8) : number of bits of the 3rd block \r\n\t\t\t\tfor (var i = 0; i < this.bitPointer + 1; i++) {\r\n\t\t\t\t\tmask1 += (1 << i);\r\n\t\t\t\t}\r\n\t\t\t\tvar bitsFirstBlock = (this.blocks[this.blockPointer] & mask1) << (numBits - (this.bitPointer + 1));\r\n\t\t\t\tthis.blockPointer++;\r\n\r\n\t\t\t\tvar bitsSecondBlock = this.blocks[this.blockPointer] << (numBits - (this.bitPointer + 1 + 8));\r\n\t\t\t\tthis.blockPointer++;\r\n\r\n\t\t\t\tfor (var i = 0; i < numBits - (this.bitPointer + 1 + 8); i++) {\r\n\t\t\t\t\tmask3 += (1 << i);\r\n\t\t\t\t}\r\n\t\t\t\tmask3 <<= 8 - (numBits - (this.bitPointer + 1 + 8));\r\n\t\t\t\tvar bitsThirdBlock = (this.blocks[this.blockPointer] & mask3) >> (8 - (numBits - (this.bitPointer + 1 + 8)));\r\n\r\n\t\t\t\tbits = bitsFirstBlock + bitsSecondBlock + bitsThirdBlock;\r\n\t\t\t\tthis.bitPointer = this.bitPointer - (numBits - 8) % 8;\r\n\t\t\t\tif (this.bitPointer < 0) {\r\n\t\t\t\t\tthis.bitPointer = 8 + this.bitPointer;\r\n\t\t\t\t}\r\n\t\t\t\treturn bits;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.NextMode = function () {\r\n\t\t\tif ((this.blockPointer > this.blocks.length - this.numErrorCorrectionCode - 2))\r\n\t\t\t\treturn 0;\r\n\t\t\telse\r\n\t\t\t\treturn this.getNextBits(4);\r\n\t\t}\r\n\t\tthis.getDataLength = function (modeIndicator) {\r\n\t\t\tvar index = 0;\r\n\t\t\twhile (true) {\r\n\t\t\t\tif ((modeIndicator >> index) == 1)\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.getNextBits(qrcode.sizeOfDataLengthInfo[this.dataLengthMode][index]);\r\n\t\t}\r\n\t\tthis.getRomanAndFigureString = function (dataLength) {\r\n\t\t\tvar length = dataLength;\r\n\t\t\tvar intData = 0;\r\n\t\t\tvar strData = \"\";\r\n\t\t\tvar tableRomanAndFigure = new Array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', ' ', '$', '%', '*', '+', '-', '.', '/', ':');\r\n\t\t\tdo {\r\n\t\t\t\tif (length > 1) {\r\n\t\t\t\t\tintData = this.getNextBits(11);\r\n\t\t\t\t\tvar firstLetter = Math.floor(intData / 45);\r\n\t\t\t\t\tvar secondLetter = intData % 45;\r\n\t\t\t\t\tstrData += tableRomanAndFigure[firstLetter];\r\n\t\t\t\t\tstrData += tableRomanAndFigure[secondLetter];\r\n\t\t\t\t\tlength -= 2;\r\n\t\t\t\t}\r\n\t\t\t\telse if (length == 1) {\r\n\t\t\t\t\tintData = this.getNextBits(6);\r\n\t\t\t\t\tstrData += tableRomanAndFigure[intData];\r\n\t\t\t\t\tlength -= 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twhile (length > 0);\r\n\r\n\t\t\treturn strData;\r\n\t\t}\r\n\t\tthis.getFigureString = function (dataLength) {\r\n\t\t\tvar length = dataLength;\r\n\t\t\tvar intData = 0;\r\n\t\t\tvar strData = \"\";\r\n\t\t\tdo {\r\n\t\t\t\tif (length >= 3) {\r\n\t\t\t\t\tintData = this.getNextBits(10);\r\n\t\t\t\t\tif (intData < 100)\r\n\t\t\t\t\t\tstrData += \"0\";\r\n\t\t\t\t\tif (intData < 10)\r\n\t\t\t\t\t\tstrData += \"0\";\r\n\t\t\t\t\tlength -= 3;\r\n\t\t\t\t}\r\n\t\t\t\telse if (length == 2) {\r\n\t\t\t\t\tintData = this.getNextBits(7);\r\n\t\t\t\t\tif (intData < 10)\r\n\t\t\t\t\t\tstrData += \"0\";\r\n\t\t\t\t\tlength -= 2;\r\n\t\t\t\t}\r\n\t\t\t\telse if (length == 1) {\r\n\t\t\t\t\tintData = this.getNextBits(4);\r\n\t\t\t\t\tlength -= 1;\r\n\t\t\t\t}\r\n\t\t\t\tstrData += intData;\r\n\t\t\t}\r\n\t\t\twhile (length > 0);\r\n\r\n\t\t\treturn strData;\r\n\t\t}\r\n\t\tthis.get8bitByteArray = function (dataLength) {\r\n\t\t\tvar length = dataLength;\r\n\t\t\tvar intData = 0;\r\n\t\t\tvar output = new Array();\r\n\r\n\t\t\tdo {\r\n\t\t\t\tintData = this.getNextBits(8);\r\n\t\t\t\toutput.push(intData);\r\n\t\t\t\tlength--;\r\n\t\t\t}\r\n\t\t\twhile (length > 0);\r\n\t\t\treturn output;\r\n\t\t}\r\n\t\tthis.getKanjiString = function (dataLength) {\r\n\t\t\tvar length = dataLength;\r\n\t\t\tvar intData = 0;\r\n\t\t\tvar unicodeString = \"\";\r\n\t\t\tdo {\r\n\t\t\t\tintData = this.getNextBits(13);\r\n\t\t\t\tvar lowerByte = intData % 0xC0;\r\n\t\t\t\tvar higherByte = intData / 0xC0;\r\n\r\n\t\t\t\tvar tempWord = (higherByte << 8) + lowerByte;\r\n\t\t\t\tvar shiftjisWord = 0;\r\n\t\t\t\tif (tempWord + 0x8140 <= 0x9FFC) {\r\n\t\t\t\t\t// between 8140 - 9FFC on Shift_JIS character set\r\n\t\t\t\t\tshiftjisWord = tempWord + 0x8140;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// between E040 - EBBF on Shift_JIS character set\r\n\t\t\t\t\tshiftjisWord = tempWord + 0xC140;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//var tempByte = new Array(0,0);\r\n\t\t\t\t//tempByte[0] = (sbyte) (shiftjisWord >> 8);\r\n\t\t\t\t//tempByte[1] = (sbyte) (shiftjisWord & 0xFF);\r\n\t\t\t\t//unicodeString += new String(SystemUtils.ToCharArray(SystemUtils.ToByteArray(tempByte)));\r\n\t\t\t\tunicodeString += String.fromCharCode(shiftjisWord);\r\n\t\t\t\tlength--;\r\n\t\t\t}\r\n\t\t\twhile (length > 0);\r\n\r\n\r\n\t\t\treturn unicodeString;\r\n\t\t}\r\n\r\n\t\tthis.parseECIValue = function () {\r\n\t\t\tvar intData = 0;\r\n\t\t\tvar firstByte = this.getNextBits(8);\r\n\t\t\tif ((firstByte & 0x80) == 0) {\r\n\t\t\t\tintData = firstByte & 0x7F;\r\n\t\t\t}\r\n\t\t\tif ((firstByte & 0xC0) == 0x80) {\r\n\t\t\t\t// two bytes\r\n\t\t\t\tvar secondByte = this.getNextBits(8);\r\n\t\t\t\tintData = ((firstByte & 0x3F) << 8) | secondByte;\r\n\t\t\t}\r\n\t\t\tif ((firstByte & 0xE0) == 0xC0) {\r\n\t\t\t\t// three bytes\r\n\t\t\t\tvar secondThirdBytes = this.getNextBits(8);;\r\n\t\t\t\tintData = ((firstByte & 0x1F) << 16) | secondThirdBytes;\r\n\t\t\t}\r\n\t\t\treturn intData;\r\n\t\t}\r\n\r\n\t\tthis.__defineGetter__(\"DataByte\", function () {\r\n\t\t\tvar output = new Array();\r\n\t\t\tvar MODE_NUMBER = 1;\r\n\t\t\tvar MODE_ROMAN_AND_NUMBER = 2;\r\n\t\t\tvar MODE_8BIT_BYTE = 4;\r\n\t\t\tvar MODE_ECI = 7;\r\n\t\t\tvar MODE_KANJI = 8;\r\n\t\t\tdo {\r\n\t\t\t\tvar mode = this.NextMode();\r\n\t\t\t\t//canvas.println(\"mode: \" + mode);\r\n\t\t\t\tif (mode == 0) {\r\n\t\t\t\t\tif (output.length > 0)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tthrow \"Empty data block\";\r\n\t\t\t\t}\r\n\t\t\t\tif (mode != MODE_NUMBER && mode != MODE_ROMAN_AND_NUMBER && mode != MODE_8BIT_BYTE && mode != MODE_KANJI && mode != MODE_ECI) {\r\n\t\t\t\t\tthrow \"Invalid mode: \" + mode + \" in (block:\" + this.blockPointer + \" bit:\" + this.bitPointer + \")\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (mode == MODE_ECI) {\r\n\t\t\t\t\tvar temp_sbyteArray3 = this.parseECIValue();\r\n\t\t\t\t\t//output.push(temp_sbyteArray3);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tvar dataLength = this.getDataLength(mode);\r\n\t\t\t\t\tif (dataLength < 1)\r\n\t\t\t\t\t\tthrow \"Invalid data length: \" + dataLength;\r\n\t\t\t\t\tswitch (mode) {\r\n\r\n\t\t\t\t\t\tcase MODE_NUMBER:\r\n\t\t\t\t\t\t\tvar temp_str = this.getFigureString(dataLength);\r\n\t\t\t\t\t\t\tvar ta = new Array(temp_str.length);\r\n\t\t\t\t\t\t\tfor (var j = 0; j < temp_str.length; j++)\r\n\t\t\t\t\t\t\t\tta[j] = temp_str.charCodeAt(j);\r\n\t\t\t\t\t\t\toutput.push(ta);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase MODE_ROMAN_AND_NUMBER:\r\n\t\t\t\t\t\t\tvar temp_str = this.getRomanAndFigureString(dataLength);\r\n\t\t\t\t\t\t\tvar ta = new Array(temp_str.length);\r\n\t\t\t\t\t\t\tfor (var j = 0; j < temp_str.length; j++)\r\n\t\t\t\t\t\t\t\tta[j] = temp_str.charCodeAt(j);\r\n\t\t\t\t\t\t\toutput.push(ta);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase MODE_8BIT_BYTE:\r\n\t\t\t\t\t\t\tvar temp_sbyteArray3 = this.get8bitByteArray(dataLength);\r\n\t\t\t\t\t\t\toutput.push(temp_sbyteArray3);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase MODE_KANJI:\r\n\t\t\t\t\t\t\tvar temp_str = this.getKanjiString(dataLength);\r\n\t\t\t\t\t\t\toutput.push(temp_str);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twhile (true);\r\n\t\t\treturn output;\r\n\t\t});\r\n\t}\r\n\r\n\treturn qrcode;\r\n}","import getLazarSoftScanner from './qrcode';\r\n\r\n/**\r\n * @fileoverview\r\n * HTML5 QR code scanning library.\r\n * - Decode QR Code using web cam or smartphone camera\r\n * \r\n * @author mebjas <minhazav@gmail.com>\r\n * \r\n * The word \"QR Code\" is registered trademark of DENSO WAVE INCORPORATED\r\n * http://www.denso-wave.com/qrcode/faqpatent-e.html\r\n * \r\n * Note: ECMA Script is not supported by all browsers. Use minified/html5-qrcode.min.js for better\r\n * browser support. Alternatively the transpiled code lives in transpiled/html5-qrcode.js\r\n */\r\nexport default class Html5Qrcode {\r\n    //#region static constants\r\n    static DEFAULT_WIDTH = 300;\r\n    static DEFAULT_WIDTH_OFFSET = 2;\r\n    static FILE_SCAN_MIN_HEIGHT = 300;\r\n    static SCAN_DEFAULT_FPS = 2;\r\n    static MIN_QR_BOX_SIZE = 50;\r\n    static SHADED_LEFT = 1;\r\n    static SHADED_RIGHT = 2;\r\n    static SHADED_TOP = 3;\r\n    static SHADED_BOTTOM = 4;\r\n    static SHADED_REGION_CLASSNAME = \"qr-shaded-region\";\r\n    static VERBOSE = false;\r\n    static BORDER_SHADER_DEFAULT_COLOR = \"#ffffff\";\r\n    static BORDER_SHADER_MATCH_COLOR = \"rgb(90, 193, 56)\";\r\n    //#endregion\r\n\r\n    /**\r\n     * Initialize QR Code scanner.\r\n     * \r\n     * @param {String} elementId - Id of the HTML element. \r\n     * @param {Boolean} verbose - Optional argument, if true, all logs\r\n     *                  would be printed to console. \r\n     */\r\n    constructor(elementId, verbose) {\r\n        if (!getLazarSoftScanner) {\r\n            throw 'Use html5qrcode.min.js without edit, getLazarSoftScanner'\r\n            + 'not found.';\r\n        }\r\n\r\n        this.qrcode = getLazarSoftScanner();\r\n        if (!this.qrcode) {\r\n            throw 'qrcode is not defined, use the minified/html5-qrcode.min.js'\r\n            + ' for proper support';\r\n        }\r\n\r\n        this._elementId = elementId;\r\n        this._foreverScanTimeout = null;\r\n        this._localMediaStream = null;\r\n        this._shouldScan = true;\r\n        this._url\r\n            = window.URL || window.webkitURL || window.mozURL || window.msURL;\r\n        this._userMedia\r\n            = navigator.getUserMedia || navigator.webkitGetUserMedia\r\n            || navigator.mozGetUserMedia || navigator.msGetUserMedia;\r\n        this._isScanning = false;\r\n\r\n        Html5Qrcode.VERBOSE = verbose === true;\r\n    }\r\n\r\n    /**\r\n     * Start scanning QR Code for given camera.\r\n     * \r\n     * @param {String or Object} identifier of the camera, it can either be the\r\n     *  cameraId retrieved from {@code Html5Qrcode#getCameras()} method or\r\n     *  object with facingMode constraint.\r\n     *  Example values:\r\n     *      - \"a76afe74e95e3aba9fc1b69c39b8701cde2d3e29aa73065c9cd89438627b3bde\"\r\n     *          ^ This is 'deviceId' from camera retrieved from \r\n     *          {@code Html5Qrcode#getCameras()}\r\n     *      - { facingMode: \"user\" }\r\n     *      - { facingMode: \"environment\" }\r\n     *      - { facingMode: { exact: \"environment\" } }\r\n     *      - { facingMode: { exact: \"user\" } }\r\n     *      - { deviceId: { exact: \"a76afe74e95e3....73065c9cd89438627b3bde\" }\r\n     *      - { deviceId: \"a76afe74e95e3....73065c9cd89438627b3bde\" }\r\n     *  Reference: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia#Syntax\r\n     * @param {Object} config extra configurations to tune QR code scanner.\r\n     *  Supported Fields:\r\n     *      - fps: expected framerate of qr code scanning. example { fps: 2 }\r\n     *          means the scanning would be done every 500 ms.\r\n     *      - qrbox: width of QR scanning box, this should be smaller than\r\n     *          the width and height of the box. This would make the scanner\r\n     *          look like this:\r\n     *          ----------------------\r\n     *          |********************|\r\n     *          |******,,,,,,,,,*****|      <--- shaded region\r\n     *          |******|       |*****|      <--- non shaded region would be\r\n     *          |******|       |*****|          used for QR code scanning.\r\n     *          |******|_______|*****|\r\n     *          |********************|\r\n     *          |********************|\r\n     *          ----------------------\r\n     *      - aspectRatio: Optional, desired aspect ratio for the video feed.\r\n     *          Ideal aspect ratios are 4:3 or 16:9. Passing very wrong aspect\r\n     *          ratio could lead to video feed not showing up.\r\n     *      - disableFlip: Optional, if {@code true} flipped QR Code won't be\r\n     *          scanned. Only use this if you are sure the camera cannot give\r\n     *          mirrored feed if you are facing performance constraints.\r\n     * @param {Function} qrCodeSuccessCallback callback on QR Code found.\r\n     *  Example:\r\n     *      function(qrCodeMessage) {}\r\n     * @param {Function} qrCodeErrorCallback callback on QR Code parse error.\r\n     *  Example:\r\n     *      function(errorMessage) {}\r\n     * \r\n     * @returns Promise for starting the scan. The Promise can fail if the user\r\n     * doesn't grant permission or some API is not supported by the browser.\r\n     */\r\n    start(cameraIdOrConfig,\r\n        configuration,\r\n        qrCodeSuccessCallback,\r\n        qrCodeErrorCallback) {\r\n        if (!cameraIdOrConfig) {\r\n            throw \"cameraIdOrConfig is required\";\r\n        }\r\n\r\n        if (!qrCodeSuccessCallback\r\n            || typeof qrCodeSuccessCallback != \"function\") {\r\n            throw \"qrCodeSuccessCallback is required and should be a function.\"\r\n        }\r\n\r\n        if (!qrCodeErrorCallback) {\r\n            qrCodeErrorCallback = console.log;\r\n        }\r\n\r\n        // Cleanup.\r\n        this._clearElement();\r\n        const $this = this;\r\n\r\n        // Create configuration by merging default and input settings.\r\n        const config = configuration ? configuration : {};\r\n        config.fps = config.fps ? config.fps : Html5Qrcode.SCAN_DEFAULT_FPS;\r\n\r\n        // qr shaded box\r\n        const isShadedBoxEnabled = config.qrbox != undefined;\r\n        const element = document.getElementById(this._elementId);\r\n        const width = element.clientWidth\r\n            ? element.clientWidth : Html5Qrcode.DEFAULT_WIDTH;\r\n        element.style.position = \"relative\";\r\n\r\n        this._shouldScan = true;\r\n        this._element = element;\r\n        this.qrcode.callback = qrCodeSuccessCallback;\r\n\r\n        // Validate before insertion\r\n        if (isShadedBoxEnabled) {\r\n            const qrboxSize = config.qrbox;\r\n            if (qrboxSize < Html5Qrcode.MIN_QR_BOX_SIZE) {\r\n                throw \"minimum size of 'config.qrbox' is\"\r\n                + ` ${Html5Qrcode.MIN_QR_BOX_SIZE}px.`;\r\n            }\r\n\r\n            if (qrboxSize > width) {\r\n                throw \"'config.qrbox' should not be greater than the \"\r\n                + \"width of the HTML element.\";\r\n            }\r\n        }\r\n\r\n        //#region local methods\r\n        /**\r\n         * Setups the UI elements, changes the state of this class.\r\n         * \r\n         * @param width derived width of viewfinder.\r\n         * @param height derived height of viewfinder.\r\n         */\r\n        const setupUi = (width, height) => {\r\n            const qrboxSize = config.qrbox;\r\n            if (qrboxSize > height) {\r\n                console.warn(\"[Html5Qrcode] config.qrboxsize is greater \"\r\n                    + \"than video height. Shading will be ignored\");\r\n            }\r\n\r\n            const shouldShadingBeApplied\r\n                = isShadedBoxEnabled && qrboxSize <= height;\r\n            const defaultQrRegion = {\r\n                x: 0,\r\n                y: 0,\r\n                width: width,\r\n                height: height\r\n            };\r\n            const qrRegion = shouldShadingBeApplied\r\n                ? this._getShadedRegionBounds(width, height, qrboxSize)\r\n                : defaultQrRegion;\r\n\r\n            const canvasElement = this._createCanvasElement(\r\n                qrRegion.width, qrRegion.height);\r\n            const context = canvasElement.getContext('2d');\r\n            context.canvas.width = qrRegion.width;\r\n            context.canvas.height = qrRegion.height;\r\n\r\n            // Insert the canvas\r\n            element.append(canvasElement);\r\n            if (shouldShadingBeApplied) {\r\n                this._possiblyInsertShadingElement(element, height, qrRegion);\r\n            }\r\n\r\n            // Update local states\r\n            $this._qrRegion = qrRegion;\r\n            $this._context = context;\r\n            $this._canvasElement = canvasElement;\r\n        }\r\n\r\n        /**\r\n         * Scans current context using the qrcode library.\r\n         * \r\n         * <p>This method call would result in callback being triggered by the\r\n         * qrcode library. This method also handles the border coloring.\r\n         * \r\n         * @returns true if scan match is found, false otherwise.\r\n         */\r\n        const scanContext = () => {\r\n            try {\r\n                $this.qrcode.decode();\r\n                this._possiblyUpdateShaders(/* qrMatch= */ true);\r\n                return true;\r\n            } catch (exception) {\r\n                this._possiblyUpdateShaders(/* qrMatch= */ false);\r\n                qrCodeErrorCallback(\r\n                    `QR code parse error, error = ${exception}`);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Method that scans forever.\r\n        const foreverScan = () => {\r\n            if (!$this._shouldScan) {\r\n                // Stop scanning.\r\n                return;\r\n            }\r\n            if ($this._localMediaStream) {\r\n\r\n                // There is difference in size of rendered video and one that is\r\n                // considered by the canvas. Need to account for scaling factor.\r\n                const videoElement = $this._videoElement;\r\n                const widthRatio\r\n                    = videoElement.videoWidth / videoElement.clientWidth;\r\n                const heightRatio\r\n                    = videoElement.videoHeight / videoElement.clientHeight;\r\n                const sWidthOffset = $this._qrRegion.width * widthRatio;\r\n                const sHeightOffset = $this._qrRegion.height * heightRatio;\r\n                const sxOffset = $this._qrRegion.x * widthRatio;\r\n                const syOffset = $this._qrRegion.y * heightRatio;\r\n\r\n                // Only decode the relevant area, ignore the shaded area,\r\n                // More reference:\r\n                // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage\r\n                $this._context.drawImage(\r\n                    $this._videoElement,\r\n                    /* sx= */ sxOffset,\r\n                    /* sy= */ syOffset,\r\n                    /* sWidth= */ sWidthOffset,\r\n                    /* sHeight= */ sHeightOffset,\r\n                    /* dx= */ 0,\r\n                    /* dy= */  0,\r\n                    /* dWidth= */ $this._qrRegion.width,\r\n                    /* dHeight= */ $this._qrRegion.height);\r\n\r\n                    // Try scanning normal frame and in case of failure, scan\r\n                    // the inverted context if not explictly disabled.\r\n                    // TODO(mebjas): Move this logic to qrcode.js\r\n                    if (!scanContext() && config.disableFlip !== true) {\r\n                        // scan inverted context.\r\n                        this._context.translate(this._context.canvas.width, 0);\r\n                        this._context.scale(-1, 1);\r\n                        scanContext();\r\n                    }\r\n            }\r\n            $this._foreverScanTimeout = setTimeout(\r\n                foreverScan, Html5Qrcode._getTimeoutFps(config.fps));\r\n        }\r\n\r\n        // success callback when user media (Camera) is attached.\r\n        const onMediaStreamReceived = mediaStream => {\r\n            return new Promise((resolve, reject) => {\r\n                const setupVideo = () => {\r\n                    const videoElement = this._createVideoElement(width);\r\n                    $this._element.append(videoElement);\r\n                    // Attach listeners to video.\r\n                    videoElement.onabort = reject;\r\n                    videoElement.onerror = reject;\r\n                    videoElement.onplaying = () => {\r\n                        const videoWidth = videoElement.clientWidth;\r\n                        const videoHeight = videoElement.clientHeight;\r\n                        setupUi(videoWidth, videoHeight);\r\n\r\n                        // start scanning after video feed has started\r\n                        foreverScan();\r\n                        resolve();\r\n                    }\r\n\r\n                    videoElement.srcObject = mediaStream;\r\n                    videoElement.play();\r\n\r\n                    // Set state\r\n                    $this._videoElement = videoElement;\r\n                }\r\n\r\n                $this._localMediaStream = mediaStream;\r\n                if (!config.aspectRatio) {\r\n                    setupVideo();\r\n                } else {\r\n                    const constraints = {\r\n                        aspectRatio : config.aspectRatio\r\n                    }\r\n                    const track = mediaStream.getVideoTracks()[0];\r\n                    track.applyConstraints(constraints)\r\n                        .then(_ => setupVideo())\r\n                        .catch(error => {\r\n                            console.log(\"[Warning] [Html5Qrcode] Constriants could not be satisfied, ignoring constraints\", error);\r\n                            setupVideo();\r\n                        });\r\n                }\r\n            });\r\n        }\r\n        //#endregion\r\n\r\n        return new Promise((resolve, reject) => {\r\n            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n                const videoConstraints = $this._createVideoConstraints(\r\n                    cameraIdOrConfig);\r\n                navigator.mediaDevices.getUserMedia(\r\n                    {\r\n                        audio: false,\r\n                        video: videoConstraints\r\n                    }).then(stream => {\r\n                        onMediaStreamReceived(stream)\r\n                            .then(_ => {\r\n                                $this._isScanning = true;\r\n                                resolve();\r\n                            })\r\n                            .catch(reject);\r\n                    })\r\n                    .catch(err => {\r\n                        reject(`Error getting userMedia, error = ${err}`);\r\n                    });\r\n            } else if (navigator.getUserMedia) {\r\n                if (typeof cameraIdOrConfig != \"string\") {\r\n                    throw \"The device doesn't support navigator.mediaDevices\"\r\n                        + \", only supported cameraIdOrConfig in this case is\"\r\n                        + \" deviceId parameter (string).\"\r\n                }\r\n                const getCameraConfig = {\r\n                    video: {\r\n                        optional: [{\r\n                            sourceId: cameraIdOrConfig\r\n                        }]\r\n                    }\r\n                };\r\n                navigator.getUserMedia(getCameraConfig,\r\n                    stream => {\r\n                        onMediaStreamReceived(stream)\r\n                            .then(_ => {\r\n                                $this._isScanning = true;\r\n                                resolve();\r\n                            })\r\n                            .catch(reject);\r\n                    }, err => {\r\n                        reject(`Error getting userMedia, error = ${err}`);\r\n                    });\r\n            } else {\r\n                reject(\"Web camera streaming not supported by the browser.\");\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Stops streaming QR Code video and scanning. \r\n     * \r\n     * @returns Promise for safely closing the video stream.\r\n     */\r\n    stop() {\r\n        // TODO(mebjas): fail fast if the start() wasn't called.\r\n        this._shouldScan = false;\r\n        clearTimeout(this._foreverScanTimeout);\r\n\r\n        const $this = this;\r\n        return new Promise((resolve, /* ignore */ reject) => {\r\n            $this.qrcode.callback = null;\r\n            const tracksToClose\r\n                = $this._localMediaStream.getVideoTracks().length;\r\n            var tracksClosed = 0;\r\n\r\n            // Removes the shaded region if exists.\r\n            const removeQrRegion = () => {\r\n                while ($this._element.getElementsByClassName(\r\n                    Html5Qrcode.SHADED_REGION_CLASSNAME).length) {\r\n                    const shadedChild = $this._element.getElementsByClassName(\r\n                        Html5Qrcode.SHADED_REGION_CLASSNAME)[0];\r\n                    $this._element.removeChild(shadedChild);\r\n                }\r\n            }\r\n\r\n            const onAllTracksClosed = () => {\r\n                $this._localMediaStream = null;\r\n                $this._element.removeChild($this._videoElement);\r\n                $this._element.removeChild($this._canvasElement);\r\n                removeQrRegion();\r\n                $this._isScanning = false;\r\n                if ($this._qrRegion) {\r\n                    $this._qrRegion = null;\r\n                }\r\n                if ($this._context) {\r\n                    $this._context = null;\r\n                }\r\n                resolve(true);\r\n            }\r\n\r\n            $this._localMediaStream.getVideoTracks().forEach(videoTrack => {\r\n                videoTrack.stop();\r\n                ++tracksClosed;\r\n\r\n                if (tracksClosed >= tracksToClose) {\r\n                    onAllTracksClosed();\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Scans an Image File for QR Code.\r\n     * \r\n     * This feature is mutually exclusive to camera based scanning, you should\r\n     * call stop() if the camera based scanning was ongoing.\r\n     * \r\n     * @param {File} imageFile a local file with Image content.\r\n     * @param {boolean} showImage if true the Image will be rendered on given\r\n     * element.\r\n     * \r\n     * @returns Promise with decoded QR code string on success and error message\r\n      *             on failure. Failure could happen due to different reasons:\r\n     *            1. QR Code decode failed because enough patterns not found in\r\n      *                 image.\r\n     *            2. Input file was not image or unable to load the image or\r\n      *                 other image load errors.\r\n     */\r\n    scanFile(imageFile, /* default=true */ showImage) {\r\n        const $this = this;\r\n        if (!imageFile || !(imageFile instanceof File)) {\r\n            throw \"imageFile argument is mandatory and should be instance \"\r\n            + \"of File. Use 'event.target.files[0]'\";\r\n        }\r\n\r\n        showImage = showImage === undefined ? true : showImage;\r\n\r\n        if ($this._isScanning) {\r\n            throw \"Close ongoing scan before scanning a file.\";\r\n        }\r\n\r\n        const computeCanvasDrawConfig = (\r\n            imageWidth,\r\n            imageHeight,\r\n            containerWidth,\r\n            containerHeight) => {\r\n\r\n            if (imageWidth <= containerWidth\r\n                && imageHeight <= containerHeight) {\r\n                // no downsampling needed.\r\n                const xoffset = (containerWidth - imageWidth) / 2;\r\n                const yoffset = (containerHeight - imageHeight) / 2;\r\n                return {\r\n                    x: xoffset,\r\n                    y: yoffset,\r\n                    width: imageWidth,\r\n                    height: imageHeight\r\n                };\r\n            } else {\r\n                const formerImageWidth = imageWidth;\r\n                const formerImageHeight = imageHeight;\r\n                if (imageWidth > containerWidth) {\r\n                    imageHeight = (containerWidth / imageWidth) * imageHeight;\r\n                    imageWidth = containerWidth;\r\n                }\r\n\r\n                if (imageHeight > containerHeight) {\r\n                    imageWidth = (containerHeight / imageHeight) * imageWidth;\r\n                    imageHeight = containerHeight;\r\n                }\r\n\r\n                Html5Qrcode._log(\r\n                    \"Image downsampled from \"\r\n                    + `${formerImageWidth}X${formerImageHeight}`\r\n                    + ` to ${imageWidth}X${imageHeight}.`);\r\n\r\n                return computeCanvasDrawConfig(\r\n                    imageWidth, imageHeight, containerWidth, containerHeight);\r\n            }\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            $this._possiblyCloseLastScanImageFile();\r\n            $this._clearElement();\r\n            $this._lastScanImageFile = imageFile;\r\n\r\n            const inputImage = new Image;\r\n            inputImage.onload = () => {\r\n                const imageWidth = inputImage.width;\r\n                const imageHeight = inputImage.height;\r\n                const element = document.getElementById($this._elementId);\r\n                const containerWidth = element.clientWidth\r\n                    ? element.clientWidth : Html5Qrcode.DEFAULT_WIDTH;\r\n                // No default height anymore.\r\n                const containerHeight =  Math.max(\r\n                    element.clientHeight ? element.clientHeight : imageHeight,\r\n                    Html5Qrcode.FILE_SCAN_MIN_HEIGHT);\r\n\r\n                const config = computeCanvasDrawConfig(\r\n                    imageWidth, imageHeight, containerWidth, containerHeight);\r\n                if (showImage) {\r\n                    const visibleCanvas = $this._createCanvasElement(\r\n                        containerWidth, containerHeight, 'qr-canvas-visible');\r\n                    visibleCanvas.style.display = \"inline-block\";\r\n                    element.appendChild(visibleCanvas);\r\n                    const context = visibleCanvas.getContext('2d');\r\n                    context.canvas.width = containerWidth;\r\n                    context.canvas.height = containerHeight;\r\n                    // More reference\r\n                    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage\r\n                    context.drawImage(\r\n                        inputImage,\r\n                        /* sx= */ 0,\r\n                        /* sy= */ 0,\r\n                        /* sWidth= */ imageWidth,\r\n                        /* sHeight= */ imageHeight,\r\n                        /* dx= */ config.x,\r\n                        /* dy= */  config.y,\r\n                        /* dWidth= */ config.width,\r\n                        /* dHeight= */ config.height);\r\n                }\r\n\r\n                const hiddenCanvas = $this._createCanvasElement(config.width, config.height);\r\n                element.appendChild(hiddenCanvas);\r\n                const context = hiddenCanvas.getContext('2d');\r\n                context.canvas.width = config.width;\r\n                context.canvas.height = config.height;\r\n                context.drawImage(\r\n                    inputImage,\r\n                    /* sx= */ 0,\r\n                    /* sy= */ 0,\r\n                    /* sWidth= */ imageWidth,\r\n                    /* sHeight= */ imageHeight,\r\n                    /* dx= */ 0,\r\n                    /* dy= */  0,\r\n                    /* dWidth= */ config.width,\r\n                    /* dHeight= */ config.height);\r\n                try {\r\n                    resolve($this.qrcode.decode());\r\n                } catch (exception) {\r\n                    reject(`QR code parse error, error = ${exception}`);\r\n                }\r\n            }\r\n\r\n            inputImage.onerror = reject;\r\n            inputImage.onabort = reject;\r\n            inputImage.onstalled = reject;\r\n            inputImage.onsuspend = reject;\r\n            inputImage.src = URL.createObjectURL(imageFile);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Clears the existing canvas.\r\n     * \r\n     * Note: in case of ongoing web cam based scan, it needs to be explicitly\r\n     * closed before calling this method, else it will throw exception.\r\n     */\r\n    clear() {\r\n        this._clearElement();\r\n    }\r\n\r\n    /**\r\n     * Returns a Promise with list of all cameras supported by the device.\r\n     * \r\n     * The returned object is a list of result object of type:\r\n     * [{\r\n     *      id: String;     // Id of the camera.\r\n     *      label: String;  // Human readable name of the camera.\r\n     * }]\r\n     */\r\n    static getCameras() {\r\n        return new Promise((resolve, reject) => {\r\n            if (navigator.mediaDevices\r\n                && navigator.mediaDevices.enumerateDevices\r\n                && navigator.mediaDevices.getUserMedia) {\r\n                this._log(\"navigator.mediaDevices used\");\r\n                navigator.mediaDevices.getUserMedia(\r\n                    { audio: false, video: true })\r\n                    .then(stream => {\r\n                        // hacky approach to close any active stream if they are\r\n                        // active.\r\n                        stream.oninactive\r\n                            = _ => this._log(\"All streams closed\");\r\n                        const closeActiveStreams = stream => {\r\n                            const tracks = stream.getVideoTracks();\r\n                            for (var i = 0; i < tracks.length; i++) {\r\n                                const track = tracks[i];\r\n                                track.enabled = false;\r\n                                track.stop();\r\n                                stream.removeTrack(track);\r\n                            }\r\n                        }\r\n\r\n                        navigator.mediaDevices.enumerateDevices()\r\n                            .then(devices => {\r\n                                const results = [];\r\n                                for (var i = 0; i < devices.length; i++) {\r\n                                    const device = devices[i];\r\n                                    if (device.kind == \"videoinput\") {\r\n                                        results.push({\r\n                                            id: device.deviceId,\r\n                                            label: device.label\r\n                                        });\r\n                                    }\r\n                                }\r\n                                this._log(`${results.length} results found`);\r\n                                closeActiveStreams(stream);\r\n                                resolve(results);\r\n                            })\r\n                            .catch(err => {\r\n                                reject(`${err.name} : ${err.message}`);\r\n                            });\r\n                    })\r\n                    .catch(err => {\r\n                        reject(`${err.name} : ${err.message}`);\r\n                    })\r\n            } else if (MediaStreamTrack && MediaStreamTrack.getSources) {\r\n                this._log(\"MediaStreamTrack.getSources used\");\r\n                const callback = sourceInfos => {\r\n                    const results = [];\r\n                    for (var i = 0; i !== sourceInfos.length; ++i) {\r\n                        const sourceInfo = sourceInfos[i];\r\n                        if (sourceInfo.kind === 'video') {\r\n                            results.push({\r\n                                id: sourceInfo.id,\r\n                                label: sourceInfo.label\r\n                            });\r\n                        }\r\n                    }\r\n                    this._log(`${results.length} results found`);\r\n                    resolve(results);\r\n                }\r\n                MediaStreamTrack.getSources(callback);\r\n            } else {\r\n                this._log(\"unable to query supported devices.\");\r\n                reject(\"unable to query supported devices.\");\r\n            }\r\n        });\r\n    }\r\n\r\n    _clearElement() {\r\n        if (this._isScanning) {\r\n            throw 'Cannot clear while scan is ongoing, close it first.';\r\n        }\r\n        const element = document.getElementById(this._elementId);\r\n        element.innerHTML = \"\";\r\n    }\r\n\r\n    _createCanvasElement(width, height, customId) {\r\n        const canvasWidth = width;\r\n        const canvasHeight = height;\r\n        const canvasElement = document.createElement('canvas');\r\n        canvasElement.style.width = `${canvasWidth}px`;\r\n        canvasElement.style.height = `${canvasHeight}px`;\r\n        canvasElement.style.display = \"none\";\r\n        // This id is set by lazarsoft/jsqrcode\r\n        canvasElement.id = customId == undefined ? 'qr-canvas' : customId;\r\n        return canvasElement;\r\n    }\r\n\r\n    _createVideoElement(width) {\r\n        const videoElement = document.createElement('video');\r\n        videoElement.style.width = `${width}px`;\r\n        videoElement.muted = true;\r\n        videoElement.playsInline = true;\r\n        return videoElement;\r\n    }\r\n\r\n    _getShadedRegionBounds(width, height, qrboxSize) {\r\n        if (qrboxSize > width || qrboxSize > height) {\r\n            throw \"'config.qrbox' should not be greater than the \"\r\n            + \"width and height of the HTML element.\";\r\n        }\r\n\r\n        return {\r\n            x: (width - qrboxSize) / 2,\r\n            y: (height - qrboxSize) / 2,\r\n            width: qrboxSize,\r\n            height: qrboxSize\r\n        };\r\n    }\r\n\r\n    _possiblyInsertShadingElement(element, height, qrRegion) {\r\n        if (qrRegion.x == 0 && qrRegion.y == 0) {\r\n            // No shading\r\n            return;\r\n        }\r\n\r\n        const shaders = {};\r\n        shaders[Html5Qrcode.SHADED_LEFT] = this._createShadedElement(\r\n            height, qrRegion, Html5Qrcode.SHADED_LEFT);\r\n        shaders[Html5Qrcode.SHADED_RIGHT] = this._createShadedElement(\r\n            height, qrRegion, Html5Qrcode.SHADED_RIGHT);\r\n        shaders[Html5Qrcode.SHADED_TOP] = this._createShadedElement(\r\n            height, qrRegion, Html5Qrcode.SHADED_TOP);\r\n        shaders[Html5Qrcode.SHADED_BOTTOM] = this._createShadedElement(\r\n            height, qrRegion, Html5Qrcode.SHADED_BOTTOM);\r\n\r\n        Object.keys(shaders).forEach(key => element.append(shaders[key]));\r\n\r\n        if (qrRegion.x < 10 || qrRegion.y < 10) {\r\n            this.hasBorderShaders = false;\r\n        } else {\r\n            Object.keys(shaders).forEach(key =>\r\n                this._insertShaderBorders(shaders[key], qrRegion, key));\r\n            this.hasBorderShaders = true;\r\n        }\r\n\r\n    }\r\n\r\n    _createShadedElement(height, qrRegion, shadingPosition) {\r\n        const elem = document.createElement('div');\r\n        elem.style.position = \"absolute\";\r\n        elem.style.height = `${height}px`;\r\n        elem.className = Html5Qrcode.SHADED_REGION_CLASSNAME;\r\n        elem.id = `${Html5Qrcode.SHADED_REGION_CLASSNAME}_${shadingPosition}`\r\n        // TODO(mebjas): maken this configurable\r\n        elem.style.background = `#0000007a`;\r\n        switch (shadingPosition) {\r\n            case Html5Qrcode.SHADED_LEFT:\r\n                elem.style.top = \"0px\";\r\n                elem.style.left = \"0px\";\r\n                elem.style.width = `${qrRegion.x}px`;\r\n                elem.style.height = `${height}px`;\r\n                break;\r\n            case Html5Qrcode.SHADED_RIGHT:\r\n                elem.style.top = \"0px\";\r\n                elem.style.right = \"0px\";\r\n                elem.style.width = `${qrRegion.x}px`;\r\n                elem.style.height = `${height}px`;\r\n                break;\r\n            case Html5Qrcode.SHADED_TOP:\r\n                elem.style.top = \"0px\";\r\n                elem.style.left = `${qrRegion.x}px`;\r\n                elem.style.width = `${qrRegion.width}px`;\r\n                elem.style.height = `${qrRegion.y}px`;\r\n                break;\r\n            case Html5Qrcode.SHADED_BOTTOM:\r\n                const top = qrRegion.y + qrRegion.height;\r\n                elem.style.top = `${top}px`;\r\n                elem.style.left = `${qrRegion.x}px`;\r\n                elem.style.width = `${qrRegion.width}px`;\r\n                elem.style.height = `${qrRegion.y}px`;\r\n                break;\r\n            default:\r\n                throw \"Unsupported shadingPosition\";\r\n        }\r\n\r\n        return elem;\r\n    }\r\n\r\n    _insertShaderBorders(shaderElem, qrRegion, shadingPosition) {\r\n        shadingPosition = parseInt(shadingPosition);\r\n        const $this = this;\r\n        const borderOffset = 5;\r\n        const smallSize = 5;\r\n        const largeSize = 40;\r\n        const createBorder = () => {\r\n            const elem = document.createElement(\"div\");\r\n            elem.style.position = \"absolute\";\r\n            elem.style.backgroundColor\r\n                = Html5Qrcode.BORDER_SHADER_DEFAULT_COLOR;\r\n            switch (shadingPosition) {\r\n                case Html5Qrcode.SHADED_LEFT:   // intentional\r\n                case Html5Qrcode.SHADED_RIGHT:\r\n                    const height = largeSize + borderOffset;\r\n                    elem.style.width = `${smallSize}px`;\r\n                    elem.style.height = `${height}px`;\r\n                    break;\r\n                case Html5Qrcode.SHADED_TOP:   // intentional\r\n                case Html5Qrcode.SHADED_BOTTOM:\r\n                    const width = largeSize + borderOffset;\r\n                    elem.style.width = `${width}px`;\r\n                    elem.style.height = `${smallSize}px`;\r\n                    break;\r\n                default:\r\n                    throw \"Unsupported shadingPosition\";\r\n            }\r\n            return elem;\r\n        }\r\n\r\n        const insertBorder = (top, left) => {\r\n            if (!(top !== null && left !== null)) {\r\n                throw \"Shaders should have defined positions\"\r\n            }\r\n            const borderElem = createBorder();\r\n            borderElem.style.top = `${top}px`;\r\n            borderElem.style.left = `${left}px`;\r\n            shaderElem.appendChild(borderElem);\r\n\r\n            if (!$this.borderShaders) {\r\n                $this.borderShaders = [];\r\n            }\r\n\r\n            $this.borderShaders.push(borderElem);\r\n        }\r\n\r\n        let firstTop = null;\r\n        let firstLeft = null;\r\n        let secondTop = null;\r\n        let secondLeft = null;\r\n        switch (shadingPosition) {\r\n            case Html5Qrcode.SHADED_LEFT:\r\n                firstTop = qrRegion.y - borderOffset;\r\n                firstLeft = qrRegion.x - smallSize;\r\n                secondTop = qrRegion.y + qrRegion.height - largeSize;\r\n                secondLeft = firstLeft;\r\n                break;\r\n            case Html5Qrcode.SHADED_RIGHT:\r\n                firstTop = qrRegion.y - borderOffset;\r\n                firstLeft = 0;\r\n                secondTop = qrRegion.y + qrRegion.height - largeSize;\r\n                secondLeft = firstLeft;\r\n                break;\r\n            case Html5Qrcode.SHADED_TOP:\r\n                firstTop = qrRegion.y - borderOffset;\r\n                firstLeft = -smallSize;\r\n                secondTop = firstTop;\r\n                secondLeft = qrRegion.width - largeSize;\r\n                break;\r\n            case Html5Qrcode.SHADED_BOTTOM:\r\n                firstTop = 0;\r\n                firstLeft = -smallSize;\r\n                secondTop = firstTop;\r\n                secondLeft = qrRegion.width - largeSize;\r\n                break;\r\n            default:\r\n                throw \"Unsupported shadingPosition\";\r\n        }\r\n\r\n        insertBorder(firstTop, firstLeft);\r\n        insertBorder(secondTop, secondLeft);\r\n    }\r\n\r\n    _possiblyUpdateShaders(qrMatch) {\r\n        if (this.qrMatch === qrMatch) {\r\n            return;\r\n        }\r\n\r\n        if (this.hasBorderShaders\r\n            && this.borderShaders\r\n            && this.borderShaders.length) {\r\n            this.borderShaders.forEach(shader => {\r\n                shader.style.backgroundColor = qrMatch\r\n                    ? Html5Qrcode.BORDER_SHADER_MATCH_COLOR\r\n                    : Html5Qrcode.BORDER_SHADER_DEFAULT_COLOR;\r\n            });\r\n        }\r\n        this.qrMatch = qrMatch;\r\n    }\r\n\r\n    _possiblyCloseLastScanImageFile() {\r\n        if (this._lastScanImageFile) {\r\n            URL.revokeObjectURL(this._lastScanImageFile);\r\n            this._lastScanImageFile = null;\r\n        }\r\n    }\r\n\r\n    //#region private method to create correct camera selection filter.\r\n    _createVideoConstraints(cameraIdOrConfig) {\r\n        if (typeof cameraIdOrConfig == \"string\") {\r\n            // If it's a string it should be camera device Id.\r\n            return { deviceId: { exact: cameraIdOrConfig } };\r\n        } else if (typeof cameraIdOrConfig == \"object\") {\r\n            const facingModeKey = \"facingMode\";\r\n            const deviceIdKey = \"deviceId\";\r\n            const allowedFacingModeValues\r\n                = { \"user\" : true, \"environment\" : true};\r\n            const exactKey = \"exact\";\r\n            const isValidFacingModeValue = value => {\r\n                if (value in allowedFacingModeValues) {\r\n                    // Valid config\r\n                    return true;\r\n                } else {\r\n                    // Invalid config\r\n                    throw \"config has invalid 'facingMode' value = \"\r\n                        + `'${value}'`;\r\n                }\r\n            };\r\n\r\n            const keys = Object.keys(cameraIdOrConfig);\r\n            if (keys.length != 1) {\r\n                throw \"'cameraIdOrConfig' object should have exactly 1 key,\"\r\n                    + ` if passed as an object, found ${keys.length} keys`;\r\n            }\r\n\r\n            const key = Object.keys(cameraIdOrConfig)[0];\r\n            if (key != facingModeKey && key != deviceIdKey) {\r\n                throw `Only '${facingModeKey}' and '${deviceIdKey}' `\r\n                    + \" are supported for 'cameraIdOrConfig'\";\r\n            }\r\n\r\n            if (key == facingModeKey) {\r\n                /**\r\n                 * Supported scenarios:\r\n                 * - { facingMode: \"user\" }\r\n                 * - { facingMode: \"environment\" }\r\n                 * - { facingMode: { exact: \"environment\" } }\r\n                 * - { facingMode: { exact: \"user\" } }\r\n                 */\r\n                const facingMode = cameraIdOrConfig[key];\r\n                if (typeof facingMode == \"string\") {\r\n                    if (isValidFacingModeValue(facingMode)) {\r\n                        return { facingMode: facingMode };\r\n                    }\r\n                } else if (typeof facingMode == \"object\") {\r\n                    if (exactKey in facingMode) {\r\n                        if (isValidFacingModeValue(facingMode[exactKey])) {\r\n                                return {\r\n                                    facingMode: {\r\n                                        exact: facingMode[exactKey]\r\n                                    }\r\n                                };\r\n                        }\r\n                    } else {\r\n                        throw \"'facingMode' should be string or object with\"\r\n                            + ` ${exactKey} as key.`;\r\n                    }\r\n                } else {\r\n                    const type = (typeof facingMode);\r\n                    throw `Invalid type of 'facingMode' = ${type}`;\r\n                }\r\n            } else {\r\n                /**\r\n                 * key == deviceIdKey; Supported scenarios:\r\n                 * - { deviceId: { exact: \"a76afe74e95e3.....38627b3bde\" }\r\n                 * - { deviceId: \"a76afe74e95e3....065c9cd89438627b3bde\" }\r\n                 */\r\n                const deviceId = cameraIdOrConfig[key];\r\n                if (typeof deviceId == \"string\") {\r\n                    return { deviceId: deviceId };\r\n                } else if (typeof deviceId == \"object\") {\r\n                    if (exactKey in deviceId) {\r\n                        return {\r\n                            deviceId : { exact: deviceId[exactKey] }\r\n                        };\r\n                    } else {\r\n                        throw \"'deviceId' should be string or object with\"\r\n                            + ` ${exactKey} as key.`;\r\n                    }\r\n                } else {\r\n                    const type = (typeof deviceId);\r\n                    throw `Invalid type of 'deviceId' = ${type}`;\r\n                }\r\n            }\r\n        } else {\r\n            // invalid type\r\n            const type = (typeof cameraIdOrConfig);\r\n            throw `Invalid type of 'cameraIdOrConfig' = ${type}`;\r\n        }\r\n    }\r\n    //#endregion\r\n\r\n    static _getTimeoutFps(fps) {\r\n        return 1000 / fps;\r\n    }\r\n\r\n    static _log(message) {\r\n        if (Html5Qrcode.VERBOSE) {\r\n            console.log(message);\r\n        }\r\n    }\r\n}","/**\r\n * @fileoverview\r\n * Complete Scanner build on top of {@link Html5Qrcode}.\r\n * - Decode QR Code using web cam or smartphone camera\r\n * \r\n * @author mebjas <minhazav@gmail.com>\r\n * \r\n * The word \"QR Code\" is registered trademark of DENSO WAVE INCORPORATED\r\n * http://www.denso-wave.com/qrcode/faqpatent-e.html\r\n * \r\n * Note: ECMA Script is not supported by all browsers. Use minified/html5-qrcode.min.js for better\r\n * browser support. Alternatively the transpiled code lives in transpiled/html5-qrcode.js\r\n */\r\nexport default class Html5QrcodeScanner {\r\n\r\n    static SCAN_TYPE_CAMERA = \"SCAN_TYPE_CAMERA\";\r\n    static SCAN_TYPE_FILE = \"SCAN_TYPE_FILE\";\r\n    static STATUS_SUCCESS = \"STATUS_SUCCESS\";\r\n    static STATUS_WARNING = \"STATUS_WARNING\";\r\n    static STATUS_DEFAULT = \"STATUS_DEFAULT\";\r\n\r\n    static ASSET_FILE_SCAN = \"https://raw.githubusercontent.com/mebjas/html5-qrcode/master/assets/file-scan.gif\";\r\n    static ASSET_CAMERA_SCAN = \"https://raw.githubusercontent.com/mebjas/html5-qrcode/master/assets/camera-scan.gif\";\r\n\r\n    /**\r\n     * Creates instance of this class.\r\n     *\r\n     * @param {String} elementId - Id of the HTML element.\r\n     * @param {Object} config extra configurations to tune QR code scanner.\r\n     *  Supported Fields:\r\n     *      - fps: expected framerate of qr code scanning. example { fps: 2 }\r\n     *          means the scanning would be done every 500 ms.\r\n     *      - qrbox: width of QR scanning box, this should be smaller than\r\n     *          the width and height of the box. This would make the scanner\r\n     *          look like this:\r\n     *          ----------------------\r\n     *          |********************|\r\n     *          |******,,,,,,,,,*****|      <--- shaded region\r\n     *          |******|       |*****|      <--- non shaded region would be\r\n     *          |******|       |*****|          used for QR code scanning.\r\n     *          |******|_______|*****|\r\n     *          |********************|\r\n     *          |********************|\r\n     *          ----------------------\r\n     *      - aspectRatio: Optional, desired aspect ratio for the video feed.\r\n     *          Ideal aspect ratios are 4:3 or 16:9. Passing very wrong aspect\r\n     *          ratio could lead to video feed not showing up.\r\n     *      - disableFlip: Optional, if {@code true} flipped QR Code won't be\r\n     *          scanned. Only use this if you are sure the camera cannot give\r\n     *          mirrored feed if you are facing performance constraints.\r\n     * @param {Boolean} verbose - Optional argument, if true, all logs\r\n     *                  would be printed to console. \r\n     */\r\n    constructor(elementId, config, verbose) {\r\n        this.elementId = elementId;\r\n        this.config = config;\r\n        this.verbose = verbose === true;\r\n\r\n        if (!document.getElementById(elementId)) {\r\n            throw `HTML Element with id=${elementId} not found`;\r\n        }\r\n\r\n        this.currentScanType = Html5QrcodeScanner.SCAN_TYPE_CAMERA;\r\n        this.sectionSwapAllowed = true;\r\n\r\n        this.section = undefined;\r\n        this.html5Qrcode = undefined;\r\n        this.qrCodeSuccessCallback = undefined;\r\n        this.qrCodeErrorCallback = undefined;\r\n    }\r\n\r\n    /**\r\n     * Renders the User Interface\r\n     * \r\n     * @param {Function} qrCodeSuccessCallback - callback on QR Code found.\r\n     *  Example:\r\n     *      function(qrCodeMessage) {}\r\n     * @param {Function} qrCodeErrorCallback - callback on QR Code parse error.\r\n     *  Example:\r\n     *      function(errorMessage) {}\r\n     * \r\n     */\r\n    render(qrCodeSuccessCallback, qrCodeErrorCallback) {\r\n        const $this = this;\r\n\r\n        this.lastMatchFound = undefined;\r\n        // Add wrapper to success callback.\r\n        this.qrCodeSuccessCallback = message => {\r\n            $this.__setStatus(\"MATCH\", Html5QrcodeScanner.STATUS_SUCCESS);\r\n            if (qrCodeSuccessCallback) {\r\n                qrCodeSuccessCallback(message);\r\n            } else {\r\n                if ($this.lastMatchFound == message) {\r\n                    return;\r\n                }\r\n                $this.lastMatchFound = message;\r\n                $this.__setHeaderMessage(\r\n                    `Last Match: ${message}`, Html5QrcodeScanner.STATUS_SUCCESS);\r\n            }\r\n        }\r\n\r\n        // Add wrapper to failure callback\r\n        this.qrCodeErrorCallback = error => {\r\n            $this.__setStatus(\"Scanning\");\r\n            if (qrCodeErrorCallback) {\r\n                qrCodeErrorCallback(error);\r\n            }\r\n        }\r\n\r\n        const container = document.getElementById(this.elementId);\r\n        container.innerHTML = \"\";\r\n        this.__createBasicLayout(container);\r\n\r\n        this.html5Qrcode = new Html5Qrcode(\r\n            this.__getScanRegionId(), this.verbose);\r\n    }\r\n\r\n    /**\r\n     * Removes the QR Code scanner.\r\n     * \r\n     * @returns Promise which succeeds if the cleanup is complete successfully,\r\n     *  fails otherwise.\r\n     */\r\n    clear() {\r\n        const $this = this;\r\n        const emptyHtmlContainer = () => {\r\n            const mainContainer = document.getElementById(this.elementId);\r\n            if (mainContainer) {\r\n                mainContainer.innerHTML = \"\";\r\n                this.__resetBasicLayout(mainContainer);\r\n            }\r\n        }\r\n\r\n        if (this.html5Qrcode) {\r\n            return new Promise((resolve, reject) => {\r\n                if ($this.html5Qrcode._isScanning) {\r\n                    $this.html5Qrcode.stop().then(_ => {\r\n                        $this.html5Qrcode.clear();\r\n                        emptyHtmlContainer();\r\n                        resolve();\r\n                    }).catch(error => {\r\n                        if ($this.verbose) {\r\n                            console.error(\"Unable to stop qrcode scanner\", error);\r\n                        }\r\n                        reject(error);\r\n                    })\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    //#region private control methods\r\n    __createBasicLayout(parent) {\r\n        parent.style.position = \"relative\";\r\n        parent.style.padding = \"0px\";\r\n        parent.style.border = \"1px solid silver\";\r\n        this.__createHeader(parent);\r\n\r\n        const qrCodeScanRegion = document.createElement(\"div\");\r\n        const scanRegionId = this.__getScanRegionId();\r\n        qrCodeScanRegion.id = scanRegionId;\r\n        qrCodeScanRegion.style.width = \"100%\";\r\n        qrCodeScanRegion.style.minHeight = \"100px\";\r\n        qrCodeScanRegion.style.textAlign = \"center\";\r\n        parent.appendChild(qrCodeScanRegion);\r\n        this.__insertCameraScanImageToScanRegion();\r\n\r\n        const qrCodeDashboard = document.createElement(\"div\");\r\n        const dashboardId = this.__getDashboardId();\r\n        qrCodeDashboard.id = dashboardId;\r\n        qrCodeDashboard.style.width = \"100%\";\r\n        parent.appendChild(qrCodeDashboard);\r\n\r\n        this.__setupInitialDashboard(qrCodeDashboard);\r\n\t}\r\n\t\r\n\t__resetBasicLayout(parent) {\r\n        parent.style.border = \"none\";\r\n\t}\r\n\r\n    __setupInitialDashboard(dashboard) {\r\n        this.__createSection(dashboard);\r\n        this.__createSectionControlPanel();\r\n        this.__createSectionSwap();\r\n    }\r\n\r\n    __createHeader(dashboard) {\r\n        const header = document.createElement(\"div\");\r\n        header.style.textAlign = \"left\";\r\n        header.style.margin = \"0px\";\r\n        header.style.padding = \"5px\";\r\n        header.style.fontSize = \"20px\";\r\n        header.style.borderBottom = \"1px solid rgba(192, 192, 192, 0.18)\";\r\n        dashboard.appendChild(header);\r\n\r\n        const titleSpan = document.createElement(\"span\");\r\n        titleSpan.innerHTML = \"QR Code Scanner\";\r\n        header.appendChild(titleSpan);\r\n\r\n        const statusSpan = document.createElement(\"span\");\r\n        statusSpan.id = this.__getStatusSpanId();\r\n        statusSpan.style.float = \"right\";\r\n        statusSpan.style.padding = \"5px 7px\";\r\n        statusSpan.style.fontSize = \"14px\";\r\n        statusSpan.style.background = \"#dedede6b\";\r\n        statusSpan.style.border = \"1px solid #00000000\";\r\n        statusSpan.style.color = \"rgb(17, 17, 17)\";\r\n        header.appendChild(statusSpan);\r\n        this.__setStatus(\"IDLE\");\r\n\r\n        const headerMessageContainer = document.createElement(\"div\");\r\n        headerMessageContainer.id = this.__getHeaderMessageContainerId();\r\n        headerMessageContainer.style.display = \"none\";\r\n        headerMessageContainer.style.fontSize = \"14px\";\r\n        headerMessageContainer.style.padding = \"2px 10px\";\r\n        headerMessageContainer.style.marginTop = \"4px\";\r\n        headerMessageContainer.style.borderTop = \"1px solid #f6f6f6\";\r\n        header.appendChild(headerMessageContainer);\r\n    }\r\n\r\n    __createSection(dashboard) {\r\n        const section = document.createElement(\"div\");\r\n        section.id = this.__getDashboardSectionId();\r\n        section.style.width = \"100%\";\r\n        section.style.padding = \"10px\";\r\n        section.style.textAlign = \"left\";\r\n        dashboard.appendChild(section);\r\n    }\r\n\r\n    __createSectionControlPanel() {\r\n        const $this = this;\r\n        const section = document.getElementById(this.__getDashboardSectionId());\r\n        const sectionControlPanel = document.createElement(\"div\");\r\n        section.appendChild(sectionControlPanel);\r\n        const scpCameraScanRegion = document.createElement(\"div\");\r\n        scpCameraScanRegion.id = this.__getDashboardSectionCameraScanRegionId();\r\n        scpCameraScanRegion.style.display\r\n            = this.currentScanType == Html5QrcodeScanner.SCAN_TYPE_CAMERA\r\n                ? \"block\" : \"none\";\r\n        sectionControlPanel.appendChild(scpCameraScanRegion);\r\n\r\n        // Assuming when the object is created permission is needed.\r\n        const requestPermissionContainer = document.createElement(\"div\");\r\n        requestPermissionContainer.style.textAlign = \"center\";\r\n\r\n        const requestPermissionButton = document.createElement(\"button\");\r\n        requestPermissionButton.innerHTML = \"Request Camera Permissions\";\r\n        requestPermissionButton.addEventListener(\"click\", function () {\r\n            requestPermissionButton.disabled = true;\r\n            $this.__setStatus(\"PERMISSION\");\r\n            $this.__setHeaderMessage(\"Requesting camera permissions...\");\r\n\r\n            Html5Qrcode.getCameras().then(cameras => {\r\n                $this.__setStatus(\"IDLE\");\r\n                $this.__resetHeaderMessage();\r\n                if (!cameras || cameras.length == 0) {\r\n                    $this.__setStatus(\r\n                        \"No Cameras\", Html5QrcodeScanner.STATUS_WARNING);\r\n                } else {\r\n                    scpCameraScanRegion.removeChild(requestPermissionContainer);\r\n                    $this.__renderCameraSelection(cameras);\r\n                }\r\n            }).catch(error => {\r\n                requestPermissionButton.disabled = false;\r\n                $this.__setStatus(\"IDLE\");\r\n                $this.__setHeaderMessage(error, Html5QrcodeScanner.STATUS_WARNING);\r\n            });\r\n        });\r\n        requestPermissionContainer.appendChild(requestPermissionButton);\r\n        scpCameraScanRegion.appendChild(requestPermissionContainer);\r\n\r\n        const fileBasedScanRegion = document.createElement(\"div\");\r\n        fileBasedScanRegion.id = this.__getDashboardSectionFileScanRegionId();\r\n        fileBasedScanRegion.style.textAlign = \"center\";\r\n        fileBasedScanRegion.style.display\r\n            = this.currentScanType == Html5QrcodeScanner.SCAN_TYPE_CAMERA\r\n                ? \"none\" : \"block\";\r\n        sectionControlPanel.appendChild(fileBasedScanRegion);\r\n\r\n        const fileScanInput = document.createElement(\"input\");\r\n        fileScanInput.id = this.__getFileScanInputId();\r\n        fileScanInput.accept = \"image/*\";\r\n        fileScanInput.type = \"file\";\r\n        fileScanInput.style.width = \"200px\";\r\n        fileScanInput.disabled\r\n            = this.currentScanType == Html5QrcodeScanner.SCAN_TYPE_CAMERA;\r\n        const fileScanLabel = document.createElement(\"span\");\r\n        fileScanLabel.innerHTML = \"&nbsp; Select Image\";\r\n        fileBasedScanRegion.appendChild(fileScanInput);\r\n        fileBasedScanRegion.appendChild(fileScanLabel);\r\n        fileScanInput.addEventListener('change', e => {\r\n            if ($this.currentScanType !== Html5QrcodeScanner.SCAN_TYPE_FILE) {\r\n                return;\r\n            }\r\n            if (e.target.files.length == 0) {\r\n                return;\r\n            }\r\n            const file = e.target.files[0];\r\n            $this.html5Qrcode.scanFile(file, true)\r\n                .then(qrCode => {\r\n                    $this.__resetHeaderMessage();\r\n                    $this.qrCodeSuccessCallback(qrCode);\r\n                })\r\n                .catch(error => {\r\n                    $this.__setStatus(\"ERROR\", Html5QrcodeScanner.STATUS_WARNING);\r\n                    $this.__setHeaderMessage(error, Html5QrcodeScanner.STATUS_WARNING);\r\n                    $this.qrCodeErrorCallback(error);\r\n                });\r\n        });\r\n    }\r\n\r\n    __renderCameraSelection(cameras) {\r\n        const $this = this;\r\n        const scpCameraScanRegion = document.getElementById(\r\n            this.__getDashboardSectionCameraScanRegionId());\r\n        scpCameraScanRegion.style.textAlign = \"center\";\r\n\r\n        const cameraSelectionContainer = document.createElement(\"span\");\r\n        cameraSelectionContainer.innerHTML\r\n            = `Select Camera (${cameras.length}) &nbsp;`;\r\n        cameraSelectionContainer.style.marginRight = \"10px\";\r\n\r\n        const cameraSelectionSelect = document.createElement(\"select\");\r\n        cameraSelectionSelect.id = this.__getCameraSelectionId();\r\n        for (var i = 0; i < cameras.length; i++) {\r\n            const camera = cameras[i];\r\n            const value = camera.id;\r\n            const name = camera.label == null ? value : camera.label;\r\n            const option = document.createElement('option');\r\n            option.value = value;\r\n            option.innerHTML = name;\r\n            cameraSelectionSelect.appendChild(option);\r\n        }\r\n        cameraSelectionContainer.appendChild(cameraSelectionSelect);\r\n        scpCameraScanRegion.appendChild(cameraSelectionContainer);\r\n\r\n        const cameraActionContainer = document.createElement(\"span\");\r\n        const cameraActionStartButton = document.createElement(\"button\");\r\n        cameraActionStartButton.innerHTML = \"Start Scanning\";\r\n        cameraActionContainer.appendChild(cameraActionStartButton);\r\n\r\n        const cameraActionStopButton = document.createElement(\"button\");\r\n        cameraActionStopButton.innerHTML = \"Stop Scanning\";\r\n        cameraActionStopButton.style.display = \"none\";\r\n        cameraActionStopButton.disabled = true;\r\n        cameraActionContainer.appendChild(cameraActionStopButton);\r\n\r\n        scpCameraScanRegion.appendChild(cameraActionContainer);\r\n\r\n        cameraActionStartButton.addEventListener('click', _ => {\r\n            cameraSelectionSelect.disabled = true;\r\n            cameraActionStartButton.disabled = true;\r\n            $this._showHideScanTypeSwapLink(false);\r\n\r\n            const config = $this.config ?\r\n                $this.config : { fps: 10, qrbox: 250 };\r\n\r\n            const cameraId = cameraSelectionSelect.value;\r\n            $this.html5Qrcode.start(\r\n                cameraId,\r\n                config,\r\n                $this.qrCodeSuccessCallback,\r\n                $this.qrCodeErrorCallback)\r\n                .then(_ => {\r\n                    cameraActionStopButton.disabled = false;\r\n                    cameraActionStopButton.style.display = \"inline-block\";\r\n                    cameraActionStartButton.style.display = \"none\";\r\n                    $this.__setStatus(\"Scanning\");\r\n                })\r\n                .catch(error => {\r\n                    $this._showHideScanTypeSwapLink(true);\r\n                    cameraSelectionSelect.disabled = false;\r\n                    cameraActionStartButton.disabled = false;\r\n                    $this.__setStatus(\"IDLE\");\r\n                    $this.__setHeaderMessage(\r\n                        error, Html5QrcodeScanner.STATUS_WARNING);\r\n                });\r\n        });\r\n\r\n        cameraActionStopButton.addEventListener('click', _ => {\r\n            cameraActionStopButton.disabled = true;\r\n            $this.html5Qrcode.stop()\r\n                .then(_ => {\r\n                    $this._showHideScanTypeSwapLink(true);\r\n                    cameraSelectionSelect.disabled = false;\r\n                    cameraActionStartButton.disabled = false;\r\n                    cameraActionStopButton.style.display = \"none\";\r\n                    cameraActionStartButton.style.display = \"inline-block\";\r\n                    $this.__setStatus(\"IDLE\");\r\n                    $this.__insertCameraScanImageToScanRegion();\r\n                }).catch(error => {\r\n                    cameraActionStopButton.disabled = false;\r\n                    $this.__setStatus(\"ERROR\", Html5QrcodeScanner.STATUS_WARNING);\r\n                    $this.__setHeaderMessage(\r\n                        error, Html5QrcodeScanner.STATUS_WARNING);\r\n                });\r\n        });\r\n    }\r\n\r\n    __createSectionSwap() {\r\n        const $this = this;\r\n        const TEXT_IF_CAMERA_SCAN_SELECTED\r\n            = \"Scan an Image File\";\r\n        const TEXT_IF_FILE_SCAN_SELECTED\r\n            = \"Scan using camera directly\";\r\n\r\n        const section = document.getElementById(this.__getDashboardSectionId());\r\n        const switchContainer = document.createElement(\"div\");\r\n        switchContainer.style.textAlign = \"center\";\r\n        const swithToFileBasedLink = document.createElement(\"a\");\r\n        swithToFileBasedLink.style.textDecoration = \"underline\";\r\n        swithToFileBasedLink.id = this.__getDashboardSectionSwapLinkId();\r\n        swithToFileBasedLink.innerHTML\r\n            = this.currentScanType == Html5QrcodeScanner.SCAN_TYPE_CAMERA\r\n                ? TEXT_IF_CAMERA_SCAN_SELECTED : TEXT_IF_FILE_SCAN_SELECTED;\r\n        swithToFileBasedLink.href = \"#scan-using-file\";\r\n        swithToFileBasedLink.addEventListener('click', function () {\r\n            if (!$this.sectionSwapAllowed) {\r\n                if ($this.verbose) {\r\n                    console.error(\"Section swap called when not allowed\");\r\n                }\r\n                return;\r\n            }\r\n\r\n            // Cleanup states\r\n            $this.__setStatus(\"IDLE\");\r\n            $this.__resetHeaderMessage();\r\n            $this.__getFileScanInput().value = \"\";\r\n\r\n            $this.sectionSwapAllowed = false;\r\n            if ($this.currentScanType == Html5QrcodeScanner.SCAN_TYPE_CAMERA) {\r\n                // swap to file\r\n                $this.__clearScanRegion();\r\n                $this.__getFileScanInput().disabled = false;\r\n                $this.__getCameraScanRegion().style.display = \"none\";\r\n                $this.__getFileScanRegion().style.display = \"block\";\r\n                swithToFileBasedLink.innerHTML = TEXT_IF_FILE_SCAN_SELECTED;\r\n                $this.currentScanType = Html5QrcodeScanner.SCAN_TYPE_FILE;\r\n                $this.__insertFileScanImageToScanRegion();\r\n            } else {\r\n                // swap to camera based scanning\r\n                $this.__clearScanRegion();\r\n                $this.__getFileScanInput().disabled = true;\r\n                $this.__getCameraScanRegion().style.display = \"block\";\r\n                $this.__getFileScanRegion().style.display = \"none\";\r\n                swithToFileBasedLink.innerHTML = TEXT_IF_CAMERA_SCAN_SELECTED;\r\n                $this.currentScanType = Html5QrcodeScanner.SCAN_TYPE_CAMERA;\r\n                $this.__insertCameraScanImageToScanRegion();\r\n            }\r\n\r\n            $this.sectionSwapAllowed = true;\r\n        });\r\n        switchContainer.appendChild(swithToFileBasedLink);\r\n        section.appendChild(switchContainer);\r\n    }\r\n\r\n    __setStatus(statusText, statusClass) {\r\n        if (!statusClass) {\r\n            statusClass = Html5QrcodeScanner.STATUS_DEFAULT;\r\n        }\r\n        const statusSpan = document.getElementById(this.__getStatusSpanId());\r\n        statusSpan.innerHTML = statusText;\r\n\r\n        switch (statusClass) {\r\n            case Html5QrcodeScanner.STATUS_SUCCESS:\r\n                statusSpan.style.background = \"#6aaf5042\";\r\n                statusSpan.style.color = \"#477735\";\r\n                break;\r\n            case Html5QrcodeScanner.STATUS_WARNING:\r\n                statusSpan.style.background = \"#cb243124\";\r\n                statusSpan.style.color = \"#cb2431\";\r\n                break;\r\n            case Html5QrcodeScanner.STATUS_DEFAULT:\r\n            default:\r\n                statusSpan.style.background = \"#eef\";\r\n                statusSpan.style.color = \"rgb(17, 17, 17)\";\r\n                break;\r\n        }\r\n    }\r\n\r\n    __resetHeaderMessage() {\r\n        const messageDiv = document.getElementById(\r\n            this.__getHeaderMessageContainerId());\r\n        messageDiv.style.display = \"none\";\r\n    }\r\n\r\n    __setHeaderMessage(messageText, statusClass) {\r\n        if (!statusClass) {\r\n            statusClass = Html5QrcodeScanner.STATUS_DEFAULT;\r\n        }\r\n        const messageDiv = document.getElementById(\r\n            this.__getHeaderMessageContainerId());\r\n        messageDiv.innerHTML = messageText;\r\n        messageDiv.style.display = \"block\";\r\n\r\n        switch (statusClass) {\r\n            case Html5QrcodeScanner.STATUS_SUCCESS:\r\n                messageDiv.style.background = \"#6aaf5042\";\r\n                messageDiv.style.color = \"#477735\";\r\n                break;\r\n            case Html5QrcodeScanner.STATUS_WARNING:\r\n                messageDiv.style.background = \"#cb243124\";\r\n                messageDiv.style.color = \"#cb2431\";\r\n                break;\r\n            case Html5QrcodeScanner.STATUS_DEFAULT:\r\n            default:\r\n                messageDiv.style.background = \"#00000000\";\r\n                messageDiv.style.color = \"rgb(17, 17, 17)\";\r\n                break;\r\n        }\r\n    }\r\n\r\n    _showHideScanTypeSwapLink(shouldDisplay) {\r\n        if (shouldDisplay !== true) {\r\n            shouldDisplay = false;\r\n        }\r\n\r\n        this.sectionSwapAllowed = shouldDisplay;\r\n        this.__getDashboardSectionSwapLink().style.display\r\n            = shouldDisplay ? \"inline-block\" : \"none\";\r\n    }\r\n\r\n    __insertCameraScanImageToScanRegion() {\r\n        const $this = this;\r\n        const qrCodeScanRegion = document.getElementById(\r\n            this.__getScanRegionId());\r\n\r\n        if (this.cameraScanImage) {\r\n            qrCodeScanRegion.innerHTML = \"<br>\";\r\n            qrCodeScanRegion.appendChild(this.cameraScanImage);\r\n            return;\r\n        }\r\n\r\n        this.cameraScanImage = new Image;\r\n        this.cameraScanImage.onload = _ => {\r\n            qrCodeScanRegion.innerHTML = \"<br>\";\r\n            qrCodeScanRegion.appendChild($this.cameraScanImage);\r\n        }\r\n        this.cameraScanImage.width = 64;\r\n        this.cameraScanImage.style.opacity = 0.3;\r\n        this.cameraScanImage.src = Html5QrcodeScanner.ASSET_CAMERA_SCAN;\r\n    }\r\n\r\n    __insertFileScanImageToScanRegion() {\r\n        const $this = this;\r\n        const qrCodeScanRegion = document.getElementById(\r\n            this.__getScanRegionId());\r\n\r\n        if (this.fileScanImage) {\r\n            qrCodeScanRegion.innerHTML = \"<br>\";\r\n            qrCodeScanRegion.appendChild(this.fileScanImage);\r\n            return;\r\n        }\r\n\r\n        this.fileScanImage = new Image;\r\n        this.fileScanImage.onload = _ => {\r\n            qrCodeScanRegion.innerHTML = \"<br>\";\r\n            qrCodeScanRegion.appendChild($this.fileScanImage);\r\n        }\r\n        this.fileScanImage.width = 64;\r\n        this.fileScanImage.style.opacity = 0.3;\r\n        this.fileScanImage.src = Html5QrcodeScanner.ASSET_FILE_SCAN;\r\n    }\r\n\r\n    __clearScanRegion() {\r\n        const qrCodeScanRegion = document.getElementById(\r\n            this.__getScanRegionId());\r\n        qrCodeScanRegion.innerHTML = \"\";\r\n    }\r\n    //#endregion\r\n\r\n    //#region state getters\r\n    __getDashboardSectionId() {\r\n        return `${this.elementId}__dashboard_section`;\r\n    }\r\n\r\n    __getDashboardSectionCameraScanRegionId() {\r\n        return `${this.elementId}__dashboard_section_csr`;\r\n    }\r\n\r\n    __getDashboardSectionFileScanRegionId() {\r\n        return `${this.elementId}__dashboard_section_fsr`;\r\n    }\r\n\r\n    __getDashboardSectionSwapLinkId() {\r\n        return `${this.elementId}__dashboard_section_swaplink`;\r\n    }\r\n\r\n    __getScanRegionId() {\r\n        return `${this.elementId}__scan_region`;\r\n    }\r\n\r\n    __getDashboardId() {\r\n        return `${this.elementId}__dashboard`;\r\n    }\r\n\r\n    __getFileScanInputId() {\r\n        return `${this.elementId}__filescan_input`;\r\n    }\r\n\r\n    __getStatusSpanId() {\r\n        return `${this.elementId}__status_span`;\r\n    }\r\n\r\n    __getHeaderMessageContainerId() {\r\n        return `${this.elementId}__header_message`;\r\n    }\r\n\r\n    __getCameraSelectionId() {\r\n        return `${this.elementId}__camera_selection`;\r\n    }\r\n\r\n    __getCameraScanRegion() {\r\n        return document.getElementById(\r\n            this.__getDashboardSectionCameraScanRegionId());\r\n    }\r\n\r\n    __getFileScanRegion() {\r\n        return document.getElementById(\r\n            this.__getDashboardSectionFileScanRegionId());\r\n    }\r\n\r\n    __getFileScanInput() {\r\n        return document.getElementById(this.__getFileScanInputId());\r\n    }\r\n\r\n    __getDashboardSectionSwapLink() {\r\n        return document.getElementById(this.__getDashboardSectionSwapLinkId());\r\n    }\r\n    //#endregion\r\n}","'use strict';\r\n\r\nlet deferredInstallPrompt = null;\r\nconst installButton = document.getElementById('butInstall');\r\ninstallButton.addEventListener('click', installPWA);\r\n\r\n// Add event listener for beforeinstallprompt event\r\nwindow.addEventListener('beforeinstallprompt', saveBeforeInstallPromptEvent);\r\n\r\n/**\r\n * Event handler for beforeinstallprompt event.\r\n *   Saves the event & shows install button.\r\n *\r\n * @param {Event} evt\r\n */\r\nfunction saveBeforeInstallPromptEvent(evt) {\r\n  // Add code to save event & show the install button.\r\n  deferredInstallPrompt = evt;\r\n  installButton.removeAttribute('hidden');\r\n}\r\n\r\n\r\n/**\r\n * Event handler for butInstall - Does the PWA installation.\r\n *\r\n * @param {Event} evt\r\n */\r\nfunction installPWA(evt) {\r\n  // Add code show install prompt & hide the install button.\r\n  deferredInstallPrompt.prompt();\r\n  // Hide the install button, it can't be called twice.\r\n  evt.srcElement.setAttribute('hidden', true);\r\n  // Log user response to prompt.\r\n  deferredInstallPrompt.userChoice\r\n      .then((choice) => {\r\n        if (choice.outcome === 'accepted') {\r\n          console.log('User accepted the A2HS prompt', choice);\r\n        } else {\r\n          console.log('User dismissed the A2HS prompt', choice);\r\n        }\r\n        deferredInstallPrompt = null;\r\n      });\r\n}\r\n\r\n// Add event listener for appinstalled event\r\nwindow.addEventListener('appinstalled', logAppInstalled);\r\n\r\n/**\r\n * Event handler for appinstalled event.\r\n *   Log the installation to analytics or save the event somehow.\r\n *\r\n * @param {Event} evt\r\n */\r\nfunction logAppInstalled(evt) {\r\n  // Add code to log the event\r\n  console.log('Svelte App was installed.', evt);\r\n}\r\n","import '../scss/master.scss';\r\n\r\nimport Html5Qrcode from './html5-qrcode/html5-qrcode';\r\nimport Html5QrcodeScanner from './html5-qrcode/html5-qrcode-scanner';\r\nimport './install';\r\n\r\nclass App{\r\n\r\n    constructor(){\r\n        this.html5QrCode = new Html5Qrcode(\"reader\");\r\n\r\n        this.options = {\r\n            $scanBtn: document.querySelector('.js-scan'),\r\n            $stopBtn: document.querySelector('.js-scan-stop'),\r\n            $select: document.querySelector('.js-cameras'),\r\n            $output: document.querySelector('.js-output'),\r\n            cameraSettings: { \r\n                facingMode: \"environment\" \r\n            },\r\n            cameraConfig: { \r\n                fps: 10, \r\n                qrbox: 250 \r\n            }\r\n        }\r\n\r\n        console.log(this.options);\r\n\r\n        this.init();\r\n    }\r\n\r\n    init(){\r\n        this.getCameras();\r\n        this.initEvents();\r\n    }\r\n\r\n    /**\r\n     * This method will trigger user permissions\r\n     * \r\n     * devices would be an array of objects of type:\r\n     * { id: \"id\", label: \"label\" }\r\n     */\r\n    getCameras(){\r\n        Html5Qrcode.getCameras().then(devices => {\r\n            console.log(devices);\r\n            if (devices && devices.length) {\r\n                devices.forEach(device => {\r\n                    let option = document.createElement(\"option\");\r\n                    option.text = device.label;\r\n                    option.value = device.id;\r\n                    this.options.$select.appendChild(option);\r\n                });\r\n            }\r\n        }).catch(err => {\r\n            console.log(err);\r\n        });\r\n    }\r\n\r\n    initEvents(){\r\n        this.options.$scanBtn.addEventListener('click', (e) => {\r\n            console.log('click');\r\n            this.html5QrCode.start(this.options.cameraSettings, this.options.cameraConfig, \r\n                (messsage) => this.qrCodeSuccessCallback(messsage), \r\n                this.qrCodeErrorCallback\r\n            );\r\n        })\r\n\r\n        this.options.$stopBtn.addEventListener('click', (e) => this.stop(e) );\r\n    }\r\n\r\n    qrCodeSuccessCallback(message) { \r\n        let output = `<p>We found your code ${message}</p>`;\r\n        this.options.$output.innerHTML = output;\r\n        this.makeRequest(message);\r\n    }\r\n\r\n    qrCodeErrorCallback(message) { \r\n      //  console.log(message);\r\n    }\r\n\r\n    stop(e){\r\n        this.html5QrCode.stop().then(ignore => {\r\n            alert('Scanning stopped')\r\n        }).catch(err => {\r\n            alert('Error when stopping')\r\n        });\r\n    }\r\n\r\n    makeRequest(url){\r\n        fetch(url, {\r\n            method: 'post',\r\n        }).then((response) => {\r\n            return response.json();\r\n        }).then((data) => {\r\n            console.log(data.msg);\r\n            this.options.$output.innerHTML = this.options.$output.innerHTML + '<p>Response data: '+ data.msg +'</p>';\r\n        });\r\n    }\r\n}\r\n\r\nconst app = new App();\r\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}